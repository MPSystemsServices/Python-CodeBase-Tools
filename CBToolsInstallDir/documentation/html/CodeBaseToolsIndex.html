

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>CodeBaseTools Documentation &mdash; CodeBaseTools 2.06 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> CodeBaseTools
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">CodeBaseTools Documentation</a><ul>
<li><a class="reference internal" href="#codebasetools-database-management-made-easy">CodeBaseTools Database Management Made Easy</a><ul>
<li><a class="reference internal" href="#python-version-information">Python Version information:</a><ul>
<li><a class="reference internal" href="#string-handling-for-python-2-3-compatibility">String handling for Python 2/3 compatibility</a></li>
<li><a class="reference internal" href="#foxpro-and-visual-foxpro-compatibility-and-field-type-definitions-used">FoxPro and Visual FoxPro Compatibility and Field Type definitions used.</a></li>
<li><a class="reference internal" href="#string-handling-and-internationalization-depends-on-python-version">String handling and internationalization… Depends on Python Version</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-fields">Data Fields:</a><ul>
<li><a class="reference internal" href="#python-2-7-earlier-versions-may-work-but-are-not-officially-supported">Python 2.7 (earlier versions may work but are not officially supported)</a></li>
<li><a class="reference internal" href="#python-3-x-3-6-and-higher-earlier-3-x-versions-not-supported">Python 3.x (3.6 and higher.  Earlier 3.x versions not supported.)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#all-python-versions">All Python versions</a></li>
<li><a class="reference internal" href="#table-size-and-other-limitations-when-using-codebase-breaking-the-xbase-2gb-barrier">Table size and other limitations when using CodeBase.  Breaking the xBase 2GB barrier.</a><ul>
<li><a class="reference internal" href="#CodeBaseTools.DELETEFILE">DELETEFILE</a></li>
<li><a class="reference internal" href="#CodeBaseTools.JUSTSTEM">JUSTSTEM</a></li>
<li><a class="reference internal" href="#CodeBaseTools.cbTools">cbTools</a></li>
<li><a class="reference internal" href="#CodeBaseTools.cbToolsX">cbToolsX</a></li>
<li><a class="reference internal" href="#CodeBaseTools.isstr">isstr</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#dbfxlstools2-module-convert-dbf-to-excel-and-excel-to-dbf-tables">DBFXLStools2 Module - Convert .DBF to Excel and Excel to .DBF tables</a></li>
<li><a class="reference internal" href="#exceltools-module-high-performance-access-to-xls-and-xlsx-spreadsheets">ExcelTools Module - High Performance Access to XLS and XLSX Spreadsheets</a></li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a><ul>
<li><a class="reference internal" href="#CodeBaseTools._cbTools">_cbTools</a><ul>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.TableObj">TableObj</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.afielddict">afielddict</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.afields">afields</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.afieldtypes">afieldtypes</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.alias">alias</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.appendblank">appendblank</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.appendfrom">appendfrom</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.ataginfo">ataginfo</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.calcfor">calcfor</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.cb_shutdown">cb_shutdown</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.closedatabases">closedatabases</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.closetable">closetable</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.closetempindex">closetempindex</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.convert_vfp_type">convert_vfp_type</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.copyindexto">copyindexto</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.copyto">copyto</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.copytoarray">copytoarray</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.countfor">countfor</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.createtable">createtable</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.cursortoxml">cursortoxml</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.curval">curval</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.curvaldate">curvaldate</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.curvaldatetime">curvaldatetime</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.curvaldecimal">curvaldecimal</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.curvalfloat">curvalfloat</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.curvallogical">curvallogical</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.curvallong">curvallong</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.curvalstr">curvalstr</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.curvalstrEX">curvalstrEX</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.dbf">dbf</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.delete">delete</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.deleted">deleted</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.deletetag">deletetag</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.deletetagall">deletetagall</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.dispstru">dispstru</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.dt2seek">dt2seek</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.dtd2expression">dtd2expression</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.dtt2expression">dtt2expression</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.dtt2seek">dtt2seek</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.eof">eof</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.fcount">fcount</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.fielddicttolist">fielddicttolist</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.fieldinfo">fieldinfo</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.flock">flock</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.flush">flush</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.flushall">flushall</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.gatherdict">gatherdict</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.gatherfromarray">gatherfromarray</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.getNewKey">getNewKey</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.getValueFromXMLString">getValueFromXMLString</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.getdatasession">getdatasession</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.getdateformat">getdateformat</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.getfieldinfo">getfieldinfo</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.goto">goto</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.indexon">indexon</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.insertdict">insertdict</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.insertintotable">insertintotable</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.isexclusive">isexclusive</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.islargemode">islargemode</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.isreadonly">isreadonly</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.locate">locate</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.locateclear">locateclear</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.locatecontinue">locatecontinue</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.makeXMLValueString">makeXMLValueString</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.maketempindex">maketempindex</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.newfield">newfield</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.openTableList">openTableList</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.order">order</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.pack">pack</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.recall">recall</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.recallall">recallall</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.reccount">reccount</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.recno">recno</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.refreshbuffers">refreshbuffers</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.refreshrecord">refreshrecord</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.reindex">reindex</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.replace">replace</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.replacedatetimeN">replacedatetimeN</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.replacelong">replacelong</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.rlock">rlock</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.scan">scan</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.scatter">scatter</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.scatterblank">scatterblank</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.scatterraw">scatterraw</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.scattertoarray">scattertoarray</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.scattertolist">scattertolist</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.scattertorecord">scattertorecord</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.seek">seek</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.select">select</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.selecttempindex">selecttempindex</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.setcustomencoding">setcustomencoding</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.setdatasession">setdatasession</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.setdateformat">setdateformat</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.setdeleted">setdeleted</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.setorderto">setorderto</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.setstrictaliasmode">setstrictaliasmode</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.skip">skip</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.tagcount">tagcount</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.unlock">unlock</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.updatestructure">updatestructure</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.use">use</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.used">used</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.xmltocursor">xmltocursor</a></li>
<li><a class="reference internal" href="#CodeBaseTools._cbTools.zap">zap</a></li>
</ul>
</li>
<li><a class="reference internal" href="#CodeBaseTools.TableObj">TableObj</a><ul>
<li><a class="reference internal" href="#CodeBaseTools.TableObj.close">close</a></li>
<li><a class="reference internal" href="#CodeBaseTools.TableObj.newId">newId</a></li>
<li><a class="reference internal" href="#CodeBaseTools.TableObj.next">next</a></li>
<li><a class="reference internal" href="#CodeBaseTools.TableObj.reset">reset</a></li>
</ul>
</li>
<li><a class="reference internal" href="#CodeBaseTools.VFPFIELD">VFPFIELD</a><ul>
<li><a class="reference internal" href="#CodeBaseTools.VFPFIELD.cName">cName</a></li>
<li><a class="reference internal" href="#CodeBaseTools.VFPFIELD.cType">cType</a></li>
<li><a class="reference internal" href="#CodeBaseTools.VFPFIELD.nWidth">nWidth</a></li>
<li><a class="reference internal" href="#CodeBaseTools.VFPFIELD.nDecimals">nDecimals</a></li>
<li><a class="reference internal" href="#CodeBaseTools.VFPFIELD.bNulls">bNulls</a></li>
</ul>
</li>
<li><a class="reference internal" href="#CodeBaseTools.VFPINDEXTAG">VFPINDEXTAG</a><ul>
<li><a class="reference internal" href="#CodeBaseTools.VFPINDEXTAG.cTagName">cTagName</a></li>
<li><a class="reference internal" href="#CodeBaseTools.VFPINDEXTAG.cTagExpr">cTagExpr</a></li>
<li><a class="reference internal" href="#CodeBaseTools.VFPINDEXTAG.cTagFilt">cTagFilt</a></li>
<li><a class="reference internal" href="#CodeBaseTools.VFPINDEXTAG.nDirection">nDirection</a></li>
<li><a class="reference internal" href="#CodeBaseTools.VFPINDEXTAG.nUnique">nUnique</a></li>
</ul>
</li>
<li><a class="reference internal" href="#DBFXLStools2.DbfXlsEngine">DbfXlsEngine</a><ul>
<li><a class="reference internal" href="#DBFXLStools2.DbfXlsEngine.bizobj2excel">bizobj2excel</a></li>
<li><a class="reference internal" href="#DBFXLStools2.DbfXlsEngine.dbf2excel">dbf2excel</a></li>
<li><a class="reference internal" href="#DBFXLStools2.DbfXlsEngine.excel2dbf">excel2dbf</a></li>
<li><a class="reference internal" href="#DBFXLStools2.DbfXlsEngine.makeBodyDecimalFormat">makeBodyDecimalFormat</a></li>
<li><a class="reference internal" href="#DBFXLStools2.DbfXlsEngine.makeBodyDecimalFormatXLSX">makeBodyDecimalFormatXLSX</a></li>
<li><a class="reference internal" href="#DBFXLStools2.DbfXlsEngine.makeBodyFormat">makeBodyFormat</a></li>
<li><a class="reference internal" href="#DBFXLStools2.DbfXlsEngine.makeBodyFormatXLSX">makeBodyFormatXLSX</a></li>
<li><a class="reference internal" href="#DBFXLStools2.DbfXlsEngine.makeBodyHiddenFormat">makeBodyHiddenFormat</a></li>
<li><a class="reference internal" href="#DBFXLStools2.DbfXlsEngine.makeHeaderFormat">makeHeaderFormat</a></li>
<li><a class="reference internal" href="#DBFXLStools2.DbfXlsEngine.makeHeaderFormatXLSX">makeHeaderFormatXLSX</a></li>
<li><a class="reference internal" href="#DBFXLStools2.DbfXlsEngine.makeTitleFormat">makeTitleFormat</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ExcelTools.xlWrap">xlWrap</a><ul>
<li><a class="reference internal" href="#ExcelTools.xlWrap.AddFormat">AddFormat</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.AddSheet">AddSheet</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.CloseWorkbook">CloseWorkbook</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.CreateWorkbook">CreateWorkbook</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.DeleteCols">DeleteCols</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.DeleteRows">DeleteRows</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.FormatCells">FormatCells</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.GetCellValue">GetCellValue</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.GetErrorMessage">GetErrorMessage</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.GetErrorNumber">GetErrorNumber</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.GetRowValues">GetRowValues</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.GetSheetFromName">GetSheetFromName</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.GetSheetStats">GetSheetStats</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.GroupCols">GroupCols</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.GroupRows">GroupRows</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.ImportSheetFrom">ImportSheetFrom</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.InsertCols">InsertCols</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.InsertRows">InsertRows</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.IsColHidden">IsColHidden</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.IsRowHidden">IsRowHidden</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.MergeCells">MergeCells</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.OpenWorkbook">OpenWorkbook</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.ReadRowValues">ReadRowValues</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.SetCellColor">SetCellColor</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.SetCellDelimiter">SetCellDelimiter</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.SetColGroupRight">SetColGroupRight</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.SetColHidden">SetColHidden</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.SetColWidths">SetColWidths</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.SetColorByName">SetColorByName</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.SetPageMargins">SetPageMargins</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.SetPaperSize">SetPaperSize</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.SetPrintArea">SetPrintArea</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.SetPrintAspect">SetPrintAspect</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.SetPrintPageCountFit">SetPrintPageCountFit</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.SetRowFormats">SetRowFormats</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.SetRowGroupBottom">SetRowGroupBottom</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.SetRowHeight">SetRowHeight</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.SetRowHidden">SetRowHidden</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.SplitSheet">SplitSheet</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.TransformExcelValue">TransformExcelValue</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.WriteCellValue">WriteCellValue</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.WriteRowValues">WriteRowValues</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.makeStringPointer">makeStringPointer</a></li>
<li><a class="reference internal" href="#ExcelTools.xlWrap.procStringResult">procStringResult</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ExcelTools.XLFORMAT">XLFORMAT</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">CodeBaseTools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>CodeBaseTools Documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/CodeBaseToolsIndex.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-CodeBaseTools">
<span id="codebasetools-documentation"></span><h1>CodeBaseTools Documentation<a class="headerlink" href="#module-CodeBaseTools" title="Permalink to this headline">¶</a></h1>
<div class="section" id="codebasetools-database-management-made-easy">
<h2>CodeBaseTools Database Management Made Easy<a class="headerlink" href="#codebasetools-database-management-made-easy" title="Permalink to this headline">¶</a></h2>
<p>The CodeBaseTools module is a wrapper and Pythonizer for the CodeBasePYWrapperXX.pyd shared library, which in
turn is built on the codebase ‘C’ DLL library.  This provides data management and persistence capability using
.DBF style data tables and sophisticated data management features including record locking, powerful indexing,
and a full suite of data retrieval capabiliies.</p>
<p>The Python .pyd module,written in ‘C’ using the Python ‘C’ API, which provides relatively easy and Pythonic access
to Visual FoxPro DBF tables.  The underlying engine is the CodeBase library, which, as of September 28, 2018, is
released by its owner Sequiter, Inc., into Open Source, and is available for free use under the GNU Lesser GPL
V3.0 license.</p>
<p>Basic documentation for each function is provided in the docstrings below.</p>
<p>NOTE FOR THIS VERSION 2.03 – June 2020:
This version is a wrapper for a compiled core python module named CodeBasePYWrapperXX.pyd which is a revised and
improved version of the original CodeBaseWrapper.dll.  The core module is now built with the Python C-API which
allows much faster transfer of data from disk to memory.  The original dll was accessed using the cTypes modules
and the Win32 extensions.  cTypes is not required for this enhanced version.  Each version of Python requires
its own unique compilation of the underlying c API code.  These are identified by the last two digits of the file
name.  The Python source in this file detects the currently running version of Python and loads the appropriate
version of the .pyd file.</p>
<div class="section" id="python-version-information">
<h3>Python Version information:<a class="headerlink" href="#python-version-information" title="Permalink to this headline">¶</a></h3>
<p>This module has been developed and tested with 2.7.17, 3.6, 3.7, 3.8, and 3.9.1.</p>
<p>Versions prior to 2.7 may or may not work and are not supported.  Note that some sub-versions of Python 3.8 have
problems in the implementation of the C API which may result in unstable behavior.  Version 3.9.1 is recommended.</p>
<p>Since each version of Python has its own version of the API, there is a separate, but functionally identical
version of CodeBasePYWrapperXX.pyd for each Python version supported.  This module imports the version
appropriate to the Python version running.</p>
<p>Currently, this module supports Python versions: 2.7, 3.6, 3.7, 3.8, and 3.9.</p>
<div class="section" id="string-handling-for-python-2-3-compatibility">
<h4>String handling for Python 2/3 compatibility<a class="headerlink" href="#string-handling-for-python-2-3-compatibility" title="Permalink to this headline">¶</a></h4>
<p>Effective with the April, 2018 changes for Python 2 and 3 compatibility, all text values passed to the
Codebase Tools engine will be coerced to str types.  That means plain strings for 2.x and Unicode
strings for 3.x.  The engine will test for these types and throw an error if the type is wrong.
This applies to path names (no “pathlike” objects), alias names, field names, tag names, and logical expressions
for selecting and filtering.</p>
<p>Field return values will be converted per the table below, if conversion is requested.  Unconverted field
contents will be returned as type bytes in all versions, if stored in the tables as text.  Field setting values may
be supplied as any valid type (including text representations of values like numbers and dates) and will be converted
by the engine.</p>
</div>
<div class="section" id="foxpro-and-visual-foxpro-compatibility-and-field-type-definitions-used">
<h4>FoxPro and Visual FoxPro Compatibility and Field Type definitions used.<a class="headerlink" href="#foxpro-and-visual-foxpro-compatibility-and-field-type-definitions-used" title="Permalink to this headline">¶</a></h4>
<p>All field types used in FoxPro 2.6 DOS and Windows are supported natively by this tool.  Also the indexes
generated are compatible with .CDX compound indexes with one or more index tags.</p>
<p>Visual FoxPro 5.0 through 9.0 SP2 tables are supported with the following exceptions:</p>
<ol class="arabic simple">
<li><p>Tables contained in a database container can be read, written to and reindexed, but only the short field names
will be usable.  Field names that are 10 characters long or less can be accessed by their normal names.</p></li>
<li><p>Tables contained in a database container cannot have their structure changed, nor have indexes removed, added,
or changed, as those changes will not be recorded in the database container.</p></li>
<li><p>VFP supports multiple Windows Code Pages, including 1252, Western Europe.  This module only supports
tables marked for Code Page 1252, however, NO translations between code pages are performed by this module.</p></li>
<li><p>VFP may or may not support Unicode strings, including multibyte languages like Cantonese, in its C and M type
fields.  See the docs below on string and Unicode handling in this module.</p></li>
<li><p>Most, but not all field types are supported, and some type codes are different as given in the following table:</p></li>
</ol>
<table class="docutils align-default">
<colgroup>
<col style="width: 7%" />
<col style="width: 24%" />
<col style="width: 26%" />
<col style="width: 22%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>VFP
Type</p></th>
<th class="head"><p>Type Name</p></th>
<th class="head"><p>CodeBase Type</p></th>
<th class="head"><p>Python 2.x
Type</p></th>
<th class="head"><p>Python 3.x
Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>B</p></td>
<td><p>Double</p></td>
<td><p>B</p></td>
<td><p>float</p></td>
<td><p>float</p></td>
</tr>
<tr class="row-odd"><td><p>C</p></td>
<td><p>Character</p></td>
<td><p>C</p></td>
<td><p>str</p></td>
<td><p>str (Unicode)</p></td>
</tr>
<tr class="row-even"><td><p>C</p></td>
<td><p>Character(bin)</p></td>
<td><p>Z</p></td>
<td><p>bytearray (3)</p></td>
<td><p>bytes or str</p></td>
</tr>
<tr class="row-odd"><td><p>D</p></td>
<td><p>Date</p></td>
<td><p>D</p></td>
<td><p>datetime.date</p></td>
<td><p>datetime.date</p></td>
</tr>
<tr class="row-even"><td><p>F</p></td>
<td><p>Float</p></td>
<td><p>F (same as Numeric)</p></td>
<td><p>float</p></td>
<td><p>float</p></td>
</tr>
<tr class="row-odd"><td><p>G</p></td>
<td><p>General</p></td>
<td><p>G (see note 2 below)</p></td>
<td><p>bytes</p></td>
<td><p>bytes</p></td>
</tr>
<tr class="row-even"><td><p>I</p></td>
<td><p>Integer</p></td>
<td><p>I</p></td>
<td><p>int</p></td>
<td><p>int</p></td>
</tr>
<tr class="row-odd"><td><p>I</p></td>
<td><p>Integer(auto incr)</p></td>
<td><p>N/A see note)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>L</p></td>
<td><p>Logical</p></td>
<td><p>L</p></td>
<td><p>bool</p></td>
<td><p>bool</p></td>
</tr>
<tr class="row-odd"><td><p>M</p></td>
<td><p>Memo</p></td>
<td><p>M</p></td>
<td><p>str</p></td>
<td><p>str (Unicode)</p></td>
</tr>
<tr class="row-even"><td><p>M</p></td>
<td><p>Memo(binary)</p></td>
<td><p>X</p></td>
<td><p>bytes</p></td>
<td><p>bytes</p></td>
</tr>
<tr class="row-odd"><td><p>N</p></td>
<td><p>Number</p></td>
<td><p>N</p></td>
<td><p>float</p></td>
<td><p>float</p></td>
</tr>
<tr class="row-even"><td><p>Q</p></td>
<td><p>Varbinary</p></td>
<td><p>[not supported]</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>T</p></td>
<td><p>Datetime</p></td>
<td><p>T</p></td>
<td><p>datetime</p></td>
<td><p>datetime</p></td>
</tr>
<tr class="row-even"><td><p>V</p></td>
<td><p>Varchar</p></td>
<td><p>[not supported]</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>V</p></td>
<td><p>Varchar(binary)</p></td>
<td><p>[not supported]</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>W</p></td>
<td><p>Blob</p></td>
<td><p>[not supported]</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Y</p></td>
<td><p>Currency</p></td>
<td><p>Y</p></td>
<td><p>Decimal</p></td>
<td><p>Decimal</p></td>
</tr>
</tbody>
</table>
<p>Note 1 – The last Codebase version added support for an auto incrementing integer field, but these fields are NOT
recognized by Visual FoxPro, and VFP auto incrementing integer fields are not recognized by Codebase and can
cause Codebase to crash.  This module therefore does not support auto incrementing integer fields directly, but a
utility function getNewKey() is provided as a source for consecutive integer values.</p>
<p>Note 2 – CodeBase and this module support G (General) type fields for reading and writing, but unlike in Visual
Foxpro, their contents cannot be filled with some kind of APPEND GENERAL sort of function.  VFP tables which have
had a G field populated by the APPEND GENERAL command from an OLE document can be copied to other tables by this
module, however, as these fields are read as simple strings of generic binary data (possibly containing null bytes),
exactly as X Memo(binary) fields, there is no interpretation done with them.</p>
<p>Note 3 – All “strings” in Python 3.x are Unicode.  Sequences of bytes that are not intended to represent text of any
kind are stored in “bytes” variables, not “strings”.  Accordingly, for Py 3.x the default Python type target for a
standard char or memo field is a string, and that of char or memo binary fields is bytes.  But you may want to store
Unicode data in binary fields to ensure no CodePage conversions are attempted by FoxPro.  As a result options are
provided to write to and read from binary fields in several different Unicode codings.</p>
</div>
<div class="section" id="string-handling-and-internationalization-depends-on-python-version">
<h4>String handling and internationalization… Depends on Python Version<a class="headerlink" href="#string-handling-and-internationalization-depends-on-python-version" title="Permalink to this headline">¶</a></h4>
<dl class="simple">
<dt>Field Names:</dt><dd><p>ASCII is default, but extended ASCII with Code Page 1252 is supported for displaying table structure,
but fields having names with characters above ASCII 127 cannot be accessed for reading and writing.</p>
</dd>
<dt>Tag Names:</dt><dd><p>ASCII is default, but extended ASCII tag names work properly</p>
</dd>
<dt>Alias Names:</dt><dd><p>Must be standard ASCII strings.  If specified with cp1252 high order bit characters, the Alias Name will be
coerced to 7-bit ASCII.</p>
</dd>
<dt>Table Names:</dt><dd><p>Names supported by the operating system will work (but see note above for Alias Names, as auto-assigned
Alias Names are also forced to 7-bit ASCII strings.)</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="data-fields">
<h3>Data Fields:<a class="headerlink" href="#data-fields" title="Permalink to this headline">¶</a></h3>
<div class="section" id="python-2-7-earlier-versions-may-work-but-are-not-officially-supported">
<h4>Python 2.7 (earlier versions may work but are not officially supported)<a class="headerlink" href="#python-2-7-earlier-versions-may-work-but-are-not-officially-supported" title="Permalink to this headline">¶</a></h4>
<dl>
<dt>Char and Memo:</dt><dd><p>Default data storage is 8-bit strings as found in Python str objects.  Embedded nulls will be treated as end of
string markers and will not be stored.  Unicode strings will be coerced to Code Page 1252 before saving.
Applies to scatter, gather, insert, replace, and curval type functions.</p>
<p>If bytearray types (with or without embedded nulls) are supplied for these fields, they will be copied into
the target field as pure binary data.  In the case of char fields, any unused space to the right of the data
will be padded with blanks.  Memo fields will contain only the data content.  If you write binary data from
bytearray objects into these standard text fields, be sure that you handle the content accordingly when
reading it back.  Also beware of FoxPro Code Page translations to which these fields are subject by default.</p>
<p>The following special coding will be allowed optionally in these functions for string and unicode object
data sources.:
- ‘ ‘, ‘X’, or None = The default storage and retrieval
- ‘W’ = Windows Double Byte Unicode encoding for the specified Code Page (default Code Page in the U.S.A. is
usually cp1252) on the local machine.  Source data may be string or bytearray, and conversion will be
performed.  Unicode will be coerced to the default Code Page.
- ‘8’ = UTF-8 encoding. Source may be string, bytearray, or Unicode.</p>
</dd>
<dt>Char(binary) and Memo(binary):</dt><dd><p>Default data storage is a non-text sequence of 8-bit bytes with no textual meaning.  The raw contents of strings
will be stored, but with strings terminated when a NULL is encountered.  Bytearrays will be copied character
for character, regardless of the presence of null bytes.</p>
<p>The following special coding will be allowed optionally in these functions with string or unicode type
data source objects:
- ‘ ‘, ‘X’, or None = The default storage and retrieval
- ‘D’ = Windows Double Byte Unicode encoding for the specified Code Page (default Code Page in the U.S.A. is
usually cp1252) on the local machine.
- ‘U’ = UTF-8 encoding.
- ‘C’ = Custom Code Page code.  See Python codecs documentation for allowable values.  Examples include:
“cp1252” - Western Europe, “cp1251” - Cyrillic (Russian, etc.), “gb2312” - Simplified Chinese.</p>
</dd>
</dl>
</div>
<div class="section" id="python-3-x-3-6-and-higher-earlier-3-x-versions-not-supported">
<h4>Python 3.x (3.6 and higher.  Earlier 3.x versions not supported.)<a class="headerlink" href="#python-3-x-3-6-and-higher-earlier-3-x-versions-not-supported" title="Permalink to this headline">¶</a></h4>
<dl>
<dt>Char and Memo:</dt><dd><p>All 3.x Python strings are Unicode.  This module will attempt to code Python strings for storage in the
field type specified.  If the Unicode string value cannot be converted into a form suitable for the field type,
an error will be triggered. Applies to scatter, gather, insert, replace, and curval type functions.
By default conversion of the strings to and from 8-bit Code Page 1252 will be attempted.  This will handle
most special characters for Western European languages.</p>
<p>Version 3.x also has a bytes and bytearray type (differences are very subtle, but the both contain
sequences of bytes that don’t necessarily have avy textual meaning.  Both of these binary data types may be
stored in both plain and binary char/memo fields, but you will need to be careful with their data
retrieval.  In all such cases, the contents of the bytes and bytearray objects will be stored byte for
byte into the target field.</p>
<p>The following special coding will be allowed optionally in these functions:
- ‘ ‘, ‘X’, or None = The default storage and retrieval (cp1252, 8-bit coding or plain ASCII)
- ‘W’ = Windows Double Byte Unicode encoding for the specified Code Page (default Code Page in the U.S.A. is
usually cp1252) on the local machine.
- ‘8’ = UTF-8 encoding.</p>
</dd>
<dt>Char(binary) and Memo(binary):</dt><dd><p>Default data storage is a non-text sequence of 8-bit bytes with no textual meaning.
The following special coding will be allowed optionally in these functions:
- ‘ ‘, ‘X’, or None = The default storage and retrieval.  For Bytes and ByteArray data, this will be a simple
copy of the binary data.  Char fields will be filled out with nulls.  String (Unicode) data will be stored
as Code Page 1252 and padded out with blanks. (For pure binary data, memo (binary) should be preferred.)
- ‘D’ = Windows Double Byte Unicode encoding for the specified Code Page (default Code Page in the U.S.A. is
usually cp1252) on the local machine.
- ‘U’ = UTF-8 encoding.
- ‘C’ = Custom Code Page code.  See Python codecs documentation for allowable values.  Examples include:
“cp1252” - Western Europe, “cp1251” - Cyrillic (Russian, etc.), “gb2312” - Simplified Chinese.  There
are many others.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="all-python-versions">
<h3>All Python versions<a class="headerlink" href="#all-python-versions" title="Permalink to this headline">¶</a></h3>
<p>Note that with all the non-default codings, you are expected to know what codings are contained the fields
you are reading and writing.  Data which cannot be transformed by the Python codecs manager will trigger
a Python error and will need to be trapped by a try… except… block.</p>
<p>Note that if you specify a custom coding and are sharing the data with Visual FoxPro, you are responsible for
ensuring the codings match on both sides.  VFP will dynamically change field data in Char and Memo
fields (but not their binary versiona) if the table and local machine Code Pages do not match.  This could
result in badly corrupted data, as this module does no automatic Code Page conversions.</p>
<p>Also, be careful with functions that read or write data from and to multiple fields.  In such cases, the custom
coding spcifiers shown above will be applied to every field of the appropriate type.  If that is not what you
want, process fields individually using replace() or curvalstrex().</p>
</div>
<div class="section" id="table-size-and-other-limitations-when-using-codebase-breaking-the-xbase-2gb-barrier">
<h3>Table size and other limitations when using CodeBase.  Breaking the xBase 2GB barrier.<a class="headerlink" href="#table-size-and-other-limitations-when-using-codebase-breaking-the-xbase-2gb-barrier" title="Permalink to this headline">¶</a></h3>
<p>Visual FoxPro and other commercial xBase applications were limited by their 32-bit architecture to
tables no larger than 2GB in size and a maximum of 1GB records.  Typically, as tables approached this
limit, performance began to degrade considerably.  Other limits of VFP were as follows:
- Maximum size of a char field: 254 bytes
- Maximum size of a table record (total size of all fields): 64K
- Maximum size of a field name: 10 ASCII characters
- Maximum number of fields per record: 255
- Maximum size of an index key value: 240 bytes
- Maximum size of an entry in a memo field: 1GB</p>
<p>The default limitations of CodeBaseTools tracks these limits in order to maintain compatibility with tables
accessed concurrently by VFP applications.  HOWEVER, the Large Table Option in CodeBaseTools allows you
to build tables far exceeding these limitations.  In the process, however, you give up some compatibility
with VFP applications.  (Even without the Large Table Option, CodeBase supports somewhat higher limits than
VFP.  See the CodeBase documentation for details.  But tables which exceed the VFP limits cannot be safely
shared with VFP applications or their derivatives.)</p>
<p>An instance of CodeBaseTools may be either Large Table OR standard table.  Both cannot be in effect at the
same time.  To launch CodeBaseTools with Large Table mode turned ON, set the parameter for Large Mode to
true thus:
‘oCBT = CodeBaseTools.cbTools(True)’</p>
<p>With Large Table mode set to True, the following limits apply:
- Maximum size of one table: Over 4000TB
- Maximum memo file size: 130TB
- Maximum size of one entry in a memo field: 4GB
- Maximum size of a char field: 64K bytes
- Maximum size of a single record (all fields): 2GB
- Maximum number fields per record: 2046
- Maximum size of a field name: 10 ASCII characters</p>
<p>According to the CodeBase documentation, tables smaller than 2GB and otherwise within the VFP limits can be shared
with VFP using the Large Table Mode, but once a table grows beyond the VFP limits, VFP will be unable to access the
table, and in the process of trying may corrupt it.  Beware.</p>
<hr class="docutils" />
<dl class="py function">
<dt id="CodeBaseTools.DELETEFILE">
<code class="sig-prename descclassname">CodeBaseTools.</code><code class="sig-name descname">DELETEFILE</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lpcFileName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools.DELETEFILE" title="Permalink to this definition">¶</a></dt>
<dd><p>UTILITY FUNCTION
Clean removal of a single file named by the fully qualified name.
Returns True if removal was successful, else False.  Does NOT generate an
error like the native Python stuff does, as often you just don’t care if it fails.
Works more like VFP DELETE FILE command.</p>
<p>08/22/2015 - Add ability to delete multiple files based on a wild-card type skeleton using glob().</p>
</dd></dl>

<dl class="py function">
<dt id="CodeBaseTools.JUSTSTEM">
<code class="sig-prename descclassname">CodeBaseTools.</code><code class="sig-name descname">JUSTSTEM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lpcFile</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools.JUSTSTEM" title="Permalink to this definition">¶</a></dt>
<dd><p>UTILITY FUNCTION
Pass any fully or partially qualified file name and this returns just the base name.  So for example, if
you pass “c:        empmyfile.txt”, this will return the text string ‘myfile’.  If, there is not a valid file name
(doesn’t have to exist, just be in a valid format), then returns the empty string.
:param lpcFile: Any file name.
:return: string.  See above.</p>
</dd></dl>

<dl class="py function">
<dt id="CodeBaseTools.cbTools">
<code class="sig-prename descclassname">CodeBaseTools.</code><code class="sig-name descname">cbTools</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bIsLarge</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools.cbTools" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory function that delivers an object reference to the _cbTools() type object.    Note that by default this module serves up only ONE actual copy of the _cbTools() object.    Subsequent calls return an object reference to the same original instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bIsLarge</strong> – Default is False, which produces an object which can co-exist with Visual FoxPro in accessing        tables simultaneously, but limits tables to VFP type limits (max size 2GB).  Pass True for a version        that enables Larget Table mode to access tables of almost unlimited size.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Object reference to a _cbTools() class object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="CodeBaseTools.cbToolsX">
<code class="sig-prename descclassname">CodeBaseTools.</code><code class="sig-name descname">cbToolsX</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bIsLarge</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools.cbToolsX" title="Permalink to this definition">¶</a></dt>
<dd><p>This version of the cbTools caller creates a brand new instance every time.  This is preferred for new work    because it provides for a unique session number for the instance to reduce interference between instances    in opening and closing tables.  Should work fine with TableObj type routines as well as legacy methods.
Added Dec. 2, 2014. JSH.
:param bIsLarge: See cbTools() for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The object reference to a new instance of cbTools()</p>
</dd>
</dl>
<p>NOTE: While Codebase does assign each instance a unique data session number, the opening and closing of    tables is not really isolated, despite what their docs claim. Oct. 7, 2015. JSH.</p>
<p>NOTE: This version is experimental.  The unique instances do not appear to be as individually isolated    as the CodeBase docs suggest they should be.</p>
</dd></dl>

<dl class="py function">
<dt id="CodeBaseTools.isstr">
<code class="sig-prename descclassname">CodeBaseTools.</code><code class="sig-name descname">isstr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cTestStr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools.isstr" title="Permalink to this definition">¶</a></dt>
<dd><p>UTILITY FUNCTION
For Py2.x and Py3.x compatibility
:param cTestStr: any value that may or may not be a string
:return: True or False</p>
</dd></dl>

</div>
</div>
<dl class="py class">
<dt id="CodeBaseTools._cbTools">
<em class="property">class </em><code class="sig-prename descclassname">CodeBaseTools.</code><code class="sig-name descname">_cbTools</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bLargeMode</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools" title="Permalink to this definition">¶</a></dt>
<dd><p>The _cbTools class is the heart of the CodeBaseTools module.  It provides a very wide range of tools for creating,
analyzing, sorting, manipulating, and otherwise processing data stored in convenient, easily transported and shared
.DBF data tables.  Normally, you will not create instances of _cbTools() directly, but will use the cbTools() and/or
cbToolsX() functions in this module to produce instances of this object class.</p>
<dl class="py method">
<dt id="CodeBaseTools._cbTools.TableObj">
<code class="sig-name descname">TableObj</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.TableObj" title="Permalink to this definition">¶</a></dt>
<dd><p>Create data table object from cbTools connection object.</p>
<p>This provides for an alternative interface to tables that some may consider to be more Pythonic        than the declarative VFP approach which is used by default.  In the default VFP mode, you create an instance        of CodeBaseTools and open the table and obtain a dict() of the first (TOP) record, as below:</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">CodeBaseTools</span>
<span class="n">oCBT</span> <span class="o">=</span> <span class="n">CodeBaseTools</span><span class="o">.</span><span class="n">cbTools</span><span class="p">()</span>
<span class="n">bResult</span> <span class="o">=</span> <span class="n">oCBT</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;c:\somepath\sometable.dbf&quot;</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="s2">&quot;SOMETABLE&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">bResult</span><span class="p">:</span>
   <span class="n">oCBT</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;SOMETABLE&quot;</span><span class="p">)</span>
   <span class="c1"># select() is optional, unless you have opened other tables in the code since the use()</span>
   <span class="n">oCBT</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&quot;TOP&quot;</span><span class="p">)</span>
   <span class="n">xRec</span> <span class="o">=</span> <span class="n">oCBT</span><span class="o">.</span><span class="n">scatter</span><span class="p">()</span>
   <span class="c1"># To access one field&#39;</span>
   <span class="nb">print</span><span class="p">(</span><span class="n">xRec</span><span class="p">[</span><span class="s2">&quot;MYFIELDNAM&quot;</span><span class="p">])</span>
<span class="n">oCBT</span><span class="o">.</span><span class="n">closetable</span><span class="p">(</span><span class="s2">&quot;SOMETABLE&quot;</span><span class="p">)</span>
<span class="c1"># the Alias parameter is not strictly required, but is good practice.</span>
</pre></div>
</div>
<p>In this default mode above, you operate on tables by selecting the appropriate work area (a.k.a. Alias name)
and then call functions to manipulate the data in the table(s) you currently have open.</p>
<p>Alternatively you can create table objects and call methods of those objects.  You access the values
of the fields for the “current record” using properties with the same name as the fields.  The above example
would be coded like this:</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">CodeBaseTools</span>
<span class="n">oCBT</span> <span class="o">=</span> <span class="n">CodeBaseTools</span><span class="o">.</span><span class="n">cbTools</span><span class="p">()</span>
<span class="n">oMyTable</span> <span class="o">=</span> <span class="n">oCBT</span><span class="o">.</span><span class="n">TableObj</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;c:\somepath\sometable.dbf&quot;</span><span class="p">)</span>
<span class="n">oMyTable</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&quot;TOP&quot;</span><span class="p">)</span>
<span class="n">xRec</span> <span class="o">=</span> <span class="n">oMyTable</span><span class="o">.</span><span class="n">scatter</span><span class="p">()</span>
<span class="c1"># to access one field</span>
<span class="nb">print</span><span class="p">(</span><span class="n">oMyTable</span><span class="o">.</span><span class="n">myfieldnam</span><span class="p">)</span>
<span class="n">oMyTable</span><span class="o">.</span><span class="n">closetable</span><span class="p">()</span><span class="s1">&#39;</span>
</pre></div>
</div>
<dl>
<dt>Some things to consider:</dt><dd><ul>
<li><p>In the table object mode, set deleted status is set to True at creation.  You should              test the performance of the deleted() assignment if you decide to change that in your use              of this approach.</p></li>
<li><p>The property names used to obtain the field values for the current record are NOT case sensitive.              If there is no current record, the value of all properties will be None.  Since None may be a valid              value for a field, you should check the value of the cErrorMessage property to determine if there              really is no record there.</p></li>
<li><p>In the table object mode, as with the default mode, you can open a table multiple times              with different alias values.  Each table behaves separately relative to current record              and index settings.  However, you MUST specify a unique alias value in the TableObj() function              call.
Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">oMyTable</span> <span class="o">=</span> <span class="n">oCBT</span><span class="o">.</span><span class="n">TableObj</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;c:\somepath\sometable.dbf&quot;</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="s2">&quot;MYNEWALIAS&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Some cbTools() functions like flush() and locate() may not work as expected. Test, Test, Test.</p></li>
<li><p>Deleting the variable containing the table object name or setting its value to None does NOT              close the table.  You MUST remember to issue a close() or closetable() method to force the              table closed before destroying the object.  This must be done for each of any multiple instances              of the table object you have created.  The isexclusive() method may report incorrect results              if called on one of these objects.</p></li>
<li><p>Users of this module are invited to explore extensions and enhancements to the TableObj()              mode, as the maintainer is not actively working on it.</p></li>
<li><p>There is currently no way to open a table exclusive with the TableObj() method.  This can              make applying indexes problematic if multiple users might have access to a table.  Unlike              Visual FoxPro, CodeBase will allow table indexing and re-indexing even if not opened exclusively.              CodeBaseTools likewise allows it.  But be sure to test for error messages when reindexing,              as error conditions may be reported if another process has the index file open.</p></li>
<li><p>Calling any method on the table object will set the currently selected table to the table              you are referencing.  If you are using a mix of the table object approach and the default              approach be aware that the “currently selected” table may not be what you expect after any              of the table objects are accessed.</p></li>
<li><p>You can mix the object and default versions (but do so carefully and test carefully).  For example,
you can do this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">oCBT</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;SOMETABLE&quot;</span><span class="p">)</span>
<span class="c1"># optional, unless you have opened other tables in the code since the use()</span>
<span class="n">oCBT</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&quot;TOP&quot;</span><span class="p">)</span>
<span class="n">xRec</span> <span class="o">=</span> <span class="n">oCBT</span><span class="o">.</span><span class="n">scatter</span><span class="p">()</span>
<span class="c1"># To access one field</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xRec</span><span class="p">[</span><span class="s2">&quot;MYFIELDNAM&quot;</span><span class="p">])</span>
<span class="n">oSomeTable</span> <span class="o">=</span> <span class="n">oCBT</span><span class="o">.</span><span class="n">TableObject</span><span class="p">(</span><span class="s2">&quot;SOMETABLE&quot;</span><span class="p">)</span>
<span class="c1"># Note use of the alias as the parameter.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">oSomeTable</span><span class="o">.</span><span class="n">myfieldnam</span><span class="p">)</span>
<span class="n">oSomeTable</span><span class="o">.</span><span class="n">dispstru</span><span class="p">()</span>  <span class="c1"># Writes the structure text to stdout</span>
<span class="n">oCBT</span><span class="o">.</span><span class="n">closetable</span><span class="p">(</span><span class="s2">&quot;SOMETABLE&quot;</span><span class="p">)</span>
<span class="c1"># the Alias parameter is not strictly required, but is good practice.</span>
</pre></div>
</div>
</li>
<li><p>Finally, test your applications thoroughly if you are using the TableObj() mode, to make              sure that all functions you are using work correctly in this mode.  We make no guarantees.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tablename</strong> – should include full path name of table to open OR an alias of a table already open.</p></li>
<li><p><strong>others</strong> – you can optionally pass named parameters like ‘readOnly’ found in the use() method.</p></li>
<li><p><strong>reset</strong> – will cause file to be re-opened if already open.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A table object for use in subsequent access to the table and its records.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.afielddict">
<code class="sig-name descname">afielddict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lpcAlias</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.afielddict" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to afields in that it retrieves field data, but it returns a dict() keyed by the field name (always
upper case), containing the object pointer for the field info structure.  Makes it easy to get specs
on individual fields without looping through the list returned by afields()
:param lpcAlias:
:return: see above. Returns None on error</p>
<p>See also fieldinfo() method for just one field’s characteristics.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.afields">
<code class="sig-name descname">afields</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lpcAlias</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.afields" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves field structure information for the currently selected table or the specified table designated
by alias name.</p>
<p>Returns a list of VFPFIELD objects, each containing information on one field, the list is in order as the
fields physically appear in the table.  See the doc for createtable() for how the output of this method
can be used to create a duplicate of the table.</p>
<p>The properties of the VFPFIELD object are detailed in the createtable() documentation.</p>
<p>If there is no currently selected table, or the alias isn’t recognized, or some other error occurs, returns None.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.afieldtypes">
<code class="sig-name descname">afieldtypes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.afieldtypes" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function which returns a dictionary containing field type information for the currently selected table.</p>
<p>The keys to the dictionary are the field names.  This provides an easy way to tailor any data preparation for
storage in a specific field, based on the target field type.</p>
<p>Returns the dictionary on success, None on failure.  Much faster than getting all afields() info, but NOTE:
the ordering of the dict() is unrelated to the sequence of fields in the table.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.alias">
<code class="sig-name descname">alias</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.alias" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that returns the alias name of the currently selected table. If there is no
currently selected table, returns an empty string “”. Call this immediately after a table
use() or createtable() if you need to capture the alias, especially if you may have opened
or created a table with a temporary or externally defined name, and don’t want to make
assumptions about what default name might have been assigned to the table and have not set
the alias name yourself.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.appendblank">
<code class="sig-name descname">appendblank</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.appendblank" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new, completely blank record at the end of the currently selected table.  Once the record is added
you can call gatherfromarray() or replace() to fill data into the fields of the new record.</p>
<p>Returns True on success, False on error, in which case check cErrorMessage and nErrorNumber for more information.</p>
<p>Be careful when using this method on tables with a unique index which doesn’t allow duplicate values for
an index field into the table.  In that case, calling this more than once before replacing the indexed field
with a unique value will result in an error condition as two records with a value of 0 in the indexed
field would not be permitted.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.appendfrom">
<code class="sig-name descname">appendfrom</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cAlias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cSource</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cExpr</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cType</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cDialect</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cDelimiter</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cQuoteChar</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cFieldList</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">bFieldsFromRow1</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.appendfrom" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies records from an external source (.DBF or other type of file) into the specified open table.</p>
<p>Works much like the APPEND FROM command in Visual FoxPro.  You specify a currently open alias as        the target, or pass “” or None, if you want to use the currently selected table as the target.  The        engine will attempt to append the data from the file cSource into that table.  It will select for the        append process only records which meet the cExpr logical expression if it is not “” or None.  NOTE: as        of this version, the cExpr filter is ONLY applied for DBF type source files.</p>
<p>Four types of files can be the source: DBF tables, System Data Format (fixed position fields in a        text file using CR/LF separators for the records, CSV (comma separated values), and TAB/TXT (tab character        delimited values).  CSV and TAB/TXT file reading makes use of the Python csv library, which means that it        may be slightly slower to execute than ‘C’ native imports of DBF or SDF type files, but also means that there        is a great deal of flexibility in configuring the csv module to handle variations in CSV formatting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cAlias</strong> – Alias of open .DBF table to receive the new records.  Leave blank to use the currently selected            table.</p></li>
<li><p><strong>cSource</strong> – Full path name of the data source for records to be appended.  See note below for how</p></li>
<li><p><strong>types are guessed from the file name extension</strong> (<em>source</em>) – </p></li>
<li><p><strong>can be overridden.</strong> (<em>but</em>) – </p></li>
<li><p><strong>cExpr</strong> – A logical expression involving one or more fields being imported that must evaluate to True            for the record to be appended.  Only considered if source file is a .DBF type file.</p></li>
<li><p><strong>cType</strong> – Required field.  Must be one of the following: DBF, TXT, TAB, CSV, SDF.  See copyto() for             definitions.</p></li>
<li><p><strong>cDialect</strong> – supports the dialect options supported by csv.  Typically these are “excel” and “excel-tab”, and            provide for reading csv or tab delimited (.TXT) files created by Excel.  Leave empty for native appendfrom()            processing or to override with the remaining parms.</p></li>
<li><p><strong>cDelimiter</strong> – define a character which separates fields in the input text string.  This defaults to “,” (comma)            for native appendfrom() operations and ‘excel’ dialect.  For tab-delimited files, use “t” (tab char), which            is also the default for ‘excel-tab’ dialect.</p></li>
<li><p><strong>cQuoteChar</strong> – the character used in the file to set off text strings, if any.  For native appendfrom() behavior,            this defaults to the double quote charcter: ‘”’.  Typically tab-delimited files don’t use quote characters,            but some custom formats may.  By default, the csv handling of double quote characters embedded within text            fields is applied (it recognizes “” embedded in the string as a quote character).  For custom handling of            such situations, see customizing csv for your needs below.</p></li>
<li><p><strong>cfieldList</strong> – if the source data doesn’t include field name information (see bFieldsFromRow1 or .DBF)            then you must supply a comma-delimited list of fields in the order they are found in the incoming</p></li>
<li><p><strong>records.</strong> – </p></li>
<li><p><strong>bFieldsFromRow1</strong> – Indicates whether the reader should look for field names in the first line of the input            file.  VFP does NOT support this feature, but csv DOES, and the default for appendfrom() behavior with            CSV or TAB/TXT input is for this to be True.  If you do NOT use this feature, then you have two options:            1) Supply cFieldList with a comma delimited text string containing one field name for each field in the            input table or 2) Be ABSOLUTELY CERTAIN that the target DBF table has exactly the fields you want in the            exact order as found in the input.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Customizing csv for your needs:</dt><dd><p>When this object class is created, the self.oCSV property is initialized            to an instance of csv.  That instance, configured to provide default behavior will be used for the            appendfrom() function.  However, if you configure your own csv instance and set custom dialect information            for it, you can use that by setting the oCSV attribute to a reference to your custom instance of csv.  See            the Python documentation for its csv.Dialect class for how to customize the format.  Alternatively, if            you know you’ll always be wanting a particular Dialect configuration, then specify the properties of            Dialect on the self.oCSV object:</p>
<blockquote>
<div><ul class="simple">
<li><p>delimiter</p></li>
<li><p>doublequote</p></li>
<li><p>escapechar</p></li>
<li><p>lineterminator</p></li>
<li><p>quotechar</p></li>
<li><p>quoting</p></li>
<li><p>skipinitialspace</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
<p>If you set any one of these values to a non-None value, you’ll need to set them all to meet your specific        needs, and no default Dialect information will be applied, and the parameters cDialect, cDelimiter,        cQuoteChar will ALL be ignored.</p>
<p>NOTE: The default behavior of appendfrom() with CSV and TAB/TXT type files will correctly append files        created by the copyto() method of this class.</p>
<p>Will use the file name extension of the source file to determine the type.  If that value is not “DBF” for        DBF table, SDF or DAT for System Data Format, or CSV for Comma Separated Values type, then you will need        to specify the type in the cType parameter as one of these 4 possible strings.  Since TAB is typically        not used as an extension for a tab-delimited file, you should expect to use the string ‘TAB’ for the        cType parameter and use .TXT or other appropriate extension for the file name.
For SDF appends, the expected field widths for type C and type N fields are determined by the        table field sizes themselves.  However other field types like D, T, and B have special rules.  See        the documentation for the copyto() method for size rules for output to SDF from these fields.  This        appendfrom() method uses the same width assumptions for append from an SDF type file.  If these special rules        are not consistent with an SDF file supplied from another source, create a DBF table with all type C        fields and set the width of each to the corresponding width of each field in the source file.  After appending        from the SDF file, you can then copy from the resulting DBF table to one with the desired field types, making        conversions as necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The number of records appended or -1 on error.  Zero records is a potentially valid return if            for some reason the source table/file is empty or if cExpr matches no records..</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.ataginfo">
<code class="sig-name descname">ataginfo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.ataginfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves index tag information for the currently selected table.  If there are no index tags, returns
an empty list.  Otherwise returns a list consisting of one VFPINDEXTAG object for each list element.</p>
<dl class="simple">
<dt>The VFPINDEXTAG objects each have five properties defining the characteristics of the index tag:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>cTagName - The name of the sort order tag name.  Use this string value to set the current order</dt><dd><p>to this index using the setorderto() method.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>cTagExpr - The expression defining the tag.  At minimum this will be the name of one field or a function</dt><dd><p>like DELETED() that relates to the contents of each record.  It can be a much more complex
expression like “UPPER(first_name)+UPPER(last_name)+STR(salary)”.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>cTagFilt - If the index tag is to only have visibility to a subset of records, this filter expression can</dt><dd><p>contain a logical expression containing references to one or more fields.  In that case, if you
set order to the tag and execute skip() or copytoarray(), only records for which this expression
evaluates to True will be recognized.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>nDirection - 0 if ordering is standard ascending order.  10 if ordering is descending with largest values</dt><dd><p>at the top.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>nUnique - value of 0 if duplicate index key values are allowed.  Value of 20 if an attempt to add a record</dt><dd><p>that has a key identical to an existing key value will trigger an error.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p>If there is no currently selected table or some other error occurs, returns None.</p>
<p>Sets the value of the property tally to the number of tags.  0 is a valid value (no index tags defined), and -1
indicates an error.</p>
<p>Return a list() object or None on error.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.calcfor">
<code class="sig-name descname">calcfor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stat</span><span class="o">=</span><span class="default_value">'SUM'</span></em>, <em class="sig-param"><span class="n">fldexpr</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">forexpr</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.calcfor" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a statistic from a numeric expression in fldexpr based on the records in the currently selected table
that satisfy the logical expression contained in forexpr.  Returns a float value result of the calculation.
Returns None on any kind of error (for example an invalid expression string).  See locate() for examples of
valid contents for the forexpr parameter.  This obeys the setting of DELETED.</p>
<p>Other considerations:</p>
<ul class="simple">
<li><p>Must NEVER be used in the midst of a locate/continue/locateclear sequence. If it is,
it will return None error.</p></li>
<li><p>Does not alter the current record pointer position, so can be called on the current table in the middle
of a scan().</p></li>
<li><p>Since this executes entirely in the ‘C’ engine, it will be much faster than scanning through a table
with Python code calling lower level CBTools functions.</p></li>
<li><p>If the fldexpr contains only the name of an Integer type field, the result will always be 0.0 UNLESS
you append a “+0” to the expression (due to an oddity in the way CodeBase handles Integer fields).  So,
if S_NUM is an Integer, and you need the sum of these values, pass “S_NUM+0” as the value of fldexpr.  This
does not apply to Number type fields.  It has not been tested with Double, Float, or Currency type fields.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stat</strong> – <p>Specifies the type of calculation to be performed on the table.  Allowed values are:</p>
<ul>
<li><p>”SUM” - totals the values in the fldexpr</p></li>
<li><p>”AVG” - produces a simple average</p></li>
<li><p>”MAX” - what it says</p></li>
<li><p>”MIN” - what it says.</p></li>
</ul>
</p></li>
<li><p><strong>fldexpr</strong> – An expression including at least one field name of an appropriate type (I, N, F, etc.) which will            be evaluated for each record which matches the forexpr if provided.</p></li>
<li><p><strong>forexpr</strong> – A logical expression involving at least one field in the target table.  An empty string will            result in the calculation being performed for ALL records.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The results of the calculation as a float.  0.0 may be a valid returned value.  Check the value of self.nErrorNumber
if you receive 0.0 and expected something else.  Invalid expressions will result in a return value of None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.cb_shutdown">
<code class="sig-name descname">cb_shutdown</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.cb_shutdown" title="Permalink to this definition">¶</a></dt>
<dd><p>Manually does what the __del__() does above.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.closedatabases">
<code class="sig-name descname">closedatabases</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.closedatabases" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes all open tables, flushes all pending writes to the disk, but keeps the CodeBase engine running.  Call this
method when you are done with a bunch of work, but need to keep the object alive for additional work.  Any calls
that require a currently selected table or an open table will fail after this has been called and until new calls
to use().</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.closetable">
<code class="sig-name descname">closetable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alias</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.closetable" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes the currently open table or the table with the alias specified by the optional alias parameter.  Flushes
all unsaved data to the disk and releases all the file handles.</p>
<p>The table cannot be accessed again without another use() method, and references to this alias will fail.</p>
<p>Returns True on success (table was open and is now closed) or False on failure (didn’t find anything to close).</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.closetempindex">
<code class="sig-name descname">closetempindex</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnCode</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.closetempindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Temporary indexes are automatically destroyed when the table they relate to is closed.  If you want
to close the temporary index before the table, pass the index code to this method.  You may wish to do
this if you are going to be adding a large number of records to the table, and don’t want the possibly
useless overhead of updating the temporary table(s) on every append.  Returns True on OK, False on failure.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.convert_vfp_type">
<code class="sig-name descname">convert_vfp_type</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcSourceValue</span></em>, <em class="sig-param"><span class="n">lcSourceType</span></em>, <em class="sig-param"><span class="n">lbStripBlanks</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.convert_vfp_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a raw text string content of one field in a .DBF table to its appropriate Python type variable.</p>
<p><em>Since the development of the CodeBaseTools Python API module that quickly and easily returns native Python        objects for field values, there is limited use for this feature.  However, scatter and other functions        do offer a “no data conversion” for slightly enhanced speed, and those unconverted values can be        translated by this function when you are ready to use them in your program.</em></p>
<p>Note that for char (binary) and memo (binary) and any text fields containing Unicode data, you MUST        allow the CodeBaseTools module to do the conversions internally rather than using this function.</p>
<p>Converts the field value information returned from the CodeBase engine into the appropriate native Python value.</p>
<p>If you elect to have converttypes=False in copytoarray() or scatter(), you may want to use this method at some
point to convert the raw values returned to native Python values.  But, to do so you’ll need to determine the
source field value type.  That can be extracted using the afields() method and inspecting the cType property
of the appropriate field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lcSourceValue</strong> – Typically a string containing the physical representation of the field contents.  In            a few instances other types of values may be supplied, but the method figures that out.</p></li>
<li><p><strong>lcSourceType</strong> – One of the single-letter codes defining the field type, like ‘C’ for Character.</p></li>
<li><p><strong>lbStripBlanks</strong> – If True is passed (default is False), then a type ‘C’ field has the trailing spaced removed.</p></li>
</ul>
</dd>
</dl>
<p>Returns: the Python value (int, string, datetime, date, bool, etc.) or None on error.  Will also return None on
empty DATE and DATETIME field values.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.copyindexto">
<code class="sig-name descname">copyindexto</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cSourceAlias</span></em>, <em class="sig-param"><span class="n">cTargetAlias</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.copyindexto" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes two open tables and copies the indexes from the source table to the target table.  Removes the indexes
from the target table at the start.</p>
<p>It is recommended that the target alias table be opened in Exclusive mode unless you are sure that there
cannot be any conflicts in opening the table.
:param cSourceAlias:
:param cTargetAlias:
:return:  True on success, False on failure of any kind – including if the target table doesn’t have all
the fields found in the source indexes.</p>
<p>NOTE: The target table must be a VFP “FREE” table NOT part of a database container.  Performing this method
on a target table in a database container will result in data corruption.  Source tables, however, may
be part of a VFP database container without problems, however PRIMARY KEY index tags may NOT copy correctly,
but CANDIDATE and UNIQUE indexes will.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.copyto">
<code class="sig-name descname">copyto</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cAlias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cOutput</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cType</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cTestExpr</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">bHeader</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">cFieldList</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">bStripBlanks</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.copyto" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies the contents of the specified table to another file, which may be one of 4 different types.</p>
<p>It is similar to the VFP COPY TO command.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cAlias</strong> – The alias name of the open table with contents to be written out.            If blank, the currently selected table will be used.</p></li>
<li><p><strong>cOutput</strong> – [REQUIRED] The fully qualified path name of the output file.  Be sure to include            the file name extension, as this function makes no assumptions about the output file name.</p></li>
<li><p><strong>cType</strong> – <p>[REQUIRED] One of four string values: “SDF”, “CSV”, “TAB”, “DBF”, indicating:</p>
<ul>
<li><p>SDF = System Data Format – Fixed width fields in records delimited by CR/LF</p></li>
<li><p>CSV = Comma Separated Value – Plain text with fields separated by commas
unless they are text, in which case, they are set off with double quote
signs thus: “joe’s Diner”,”Hambergers To Go”,35094,”Another Name”.
If the text field has an embedded quote, the quote is transformed into a
double-double quote: “Joe’s “”Best”” Hambergers”,”Pete’s Grill”.
Embedded line breaks within character/text fields are NOT supported.
If encountered, they WILL BE REMOVED from the data prior to output.</p></li>
<li><p>TAB = Tab separated values.  Plain text with fields separated by a single
Tab (ASCII Character 9) character.  Character and number data is given
without any quotations other than what might exist in the data.  In
this implementation embedded line breaks in character fields and em-
bedded TAB characters in text fields are NOT supported and WILL BE
REMOVED prior to output of the data.</p></li>
<li><p>DBF = Standard VFP-type DBF table.  Data structure will be identical to the
source unless a cFieldList is supplied.  No indexes will be copied.  Be SURE
to supply the file name extension as none will be assumed.</p></li>
</ul>
</p></li>
<li><p><strong>bHeader</strong> – If True, then CSV and TAB outputs will include a first line consisting            of the names of each field, separated by the appropriate separator,            either Comma or TAB respectively.  Otherwise no field name data will            be included.  Default is False.</p></li>
<li><p><strong>cFieldList</strong> – A list of field names to include in the output.  If omitted, ALL            fields will be included (except as indicated in NOTES).</p></li>
<li><p><strong>cTestExpr</strong> – Text string containing a VFP Logical expression which must be True            for the record to be output.  If empty or null, ALL records are output.</p></li>
<li><p><strong>bStripBlanks</strong> – If True, trailing blanks will be stripped at the end of records.            Defaults to False.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul>
<li><p>For all types except DBF, fields which cannot be represented by simple text
strings without line breaks will be skipped.  These include types MEMO, GENERAL,
CHARACTER(BINARY), and BLOB.</p></li>
<li><p>In text formats Date fields will be output as MM/DD/YYYY or as specified by the current setting
of cbwSETDATEFORMAT().</p></li>
<li><p>In text formats Date-Time fields will be represented as CCYYMMDDhh:mm:ss, which is re-importable
back into CodeBase DBF tables via cbwAPPENDFROM().</p></li>
<li><p>The Deleted status of records will be respected based on the setdeleted() setting.</p></li>
<li><p>Current Order will be respected.</p></li>
<li><p>The TYPE of the file will be determined by the cType parameter regardless of the
name of the output file!!</p></li>
<li><p>The table named in the cOutput parm should NOT be open.  If it exists, it will be overwritten</p></li>
<li><p>Field lengths for the SDF type output are, in general determined by the length
of the data fields themselves.  Rules for length and output are as follows by
type:</p>
<blockquote>
<div><ul class="simple">
<li><p>C - Width of field.</p></li>
<li><p>D - 8 characters in the form YYYYMMDD</p></li>
<li><p>T - 16 characters in the form YYYYMMDDhh:mm:ss</p></li>
<li><p>L - 1 character (‘F’ or ‘T’)</p></li>
<li><p>N - Determined by size and decimals of field.</p></li>
<li><p>F (Float) - like N</p></li>
<li><p>B (Double) - 16 bytes, left-filled</p></li>
<li><p>I (Integer) - 11 bytes, left-filled</p></li>
<li><p>Y (Currency) - 16 bytes, 4 decimals, left filled.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>Returns number of records output or -1 on error.  Zero records returned may be a valid result,
if there are no records in the source table or none match the cTestExpr evaluation.</p>
<p>If the function was successful, the new table will exist as specified but it will NOT be open.  If you
need to work with it, you will need to open it normally with the use() method after this method terminates.</p>
</p>
</dd>
</dl>
<p>WARNING: If the output type is DBF and the base file name of the target table is the same as the source
table, then the alias of the source table MUST be a non-default string (not the same as the base table name).
The CreateTable() function, which is at the core of this function when outputting a DBF, creates the table
and opens it with the default alias name.  If that alias name is already in use, the original table is closed,
and the results will likely NOT be what you expect.</p>
<p>KNOWN ISSUE: If you do a copyto() on a currently open table, and wish to repeat the process on that table
with a different target result, it may be necessary to close the source table and re-open it.  In some
instances, without this close, the repeat copy will create the target table but NOT put any records into it.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.copytoarray">
<code class="sig-name descname">copytoarray</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">maxcount</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">fieldtomatch</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">matchvalue</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">matchtype</span><span class="o">=</span><span class="default_value">'='</span></em>, <em class="sig-param"><span class="n">converttypes</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">stripblanks</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fieldlist</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">coding</span><span class="o">=</span><span class="default_value">'XX'</span></em>, <em class="sig-param"><span class="n">bDesc</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.copytoarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies values of all (or selected) fields and all (or selected) records of the specified table into a list of dictionaries.</p>
<p>If the optional parameter alias is left empty, the method works on the currently selected table.  Otherwise
returns the contents of the open table with the alias name specified.</p>
<p>The list will be in order as set for the requested table.  If no order is set, the ordering will be by record
number.  Each element of the list object returned will be a dictionary consisting of one element for each field
keyed by the field name.  On error will return an empty list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alias</strong> – If passed as an empty string, this function will apply to the currently selected open table, if            any.  Otherwise you may specify the alias name of a currently open table to output from.</p></li>
<li><p><strong>maxcount</strong> – By default, the function will return at most 1000 records (list items).  You can adjust this            maximum with this parameter.  Very large tables could result in out-of-memory conditions, however.  Set            this value to 0 for ALL records.</p></li>
<li><p><strong>fieldtomatch</strong> – You can restrict the output to selected records using three parameters.  This one specifies            the field whose value will be tested to determine if a record will be output.  Pass an empty string or            omit the parameter if you want all records.</p></li>
<li><p><strong>matchvalue</strong> – <p>The value you want to test for the field defined in <cite>fieldtomatch</cite>.  Must be a value compatible            with the type of field specified.  Specifically the value must be of the following types for the specified            field types:</p>
<ul>
<li><p>Field type I (Integer) - int or long</p></li>
<li><p>Field type C (Character) - string</p></li>
<li><p>Field type D (Date) - datetime.date (None for empty date)</p></li>
<li><p>Field type T (Datetime) - datetime.datetime (None for empty datetime)</p></li>
<li><p>Field type N (Number) - int, long, float or decimal.Decimal</p></li>
<li><p>Field type Y (Currency) - decimal.Decimal</p></li>
<li><p>Field type M (Memo) - string</p></li>
<li><p>Field type L (Logical) - bool (True or False)</p></li>
</ul>
</p></li>
<li><p><strong>matchtype</strong> – <p>Defines how the <cite>matchvalue</cite> parm will be tested against the value of the <a href="#id1"><span class="problematic" id="id2">`</span></a>fieldtomatch <a href="#id3"><span class="problematic" id="id4">`</span></a>.  Valid            values  are:</p>
<ul>
<li><p>”=” - Equals.  For string matches the comparison stops with the shorteer of the compared strings.</p></li>
<li><p>”&gt;=”</p></li>
<li><p>”&lt;=”</p></li>
<li><p>”==” - Exactly equals.  Both test value and field contents must match exactly if strings.</p></li>
<li><p>”&lt;&gt;” - Not equal.</p></li>
<li><p>”$” - Contained in.  Equivalent of the Python ‘in’ operator.  The field value string must be                entirely contained in the <cite>matchvalue</cite> string.</p></li>
</ul>
<p>NOTE: The string comparison rules described above are DIFFERENT from those that apply in the
expression for the locate() method.  This is due to differences in Python vs CodeBase handling
of equality expressions.</p>
</p></li>
<li><p><strong>converttypes</strong> – The default for this parm is True, which means that every field in the table will be converted            to its appropriate Python type in the output dictionaries.  You can avoid the processing overhead of this            conversion by setting this parameter to False, but you’ll need to handle the conversion yourself.</p></li>
<li><p><strong>stripblanks</strong> – Applies only to C type fields which are stored with blanks padding them to the full width            of the field.  Defaults to False.  If set to True, then all C type fields will have blanks on the right            stripped off.  Does NOT apply to Memo fields.</p></li>
<li><p><strong>fieldlist</strong> – pass a comma delimited list of field names to this parameter to limit the number of fields            to your selected set.</p></li>
<li><p><strong>coding</strong> – Applies mainly to Python 3.x applications.  See the introductory docs for this class module for            details.</p></li>
<li><p><strong>bDesc</strong> – Pass True for the output to be in the current tag order but in descending, not ascending order.</p></li>
</ul>
</dd>
</dl>
<p>The reason for the filter mechanism is to allow very fast record filtering in the C component before Python
ever sees the record values.  This can potentially eliminate significant numbers of records you just don’t want
to see.  Then you can perform tests on the resulting array to refine your search more precisely.  If you are
using the client-server version of CodeBase, the filter test will be performed on the server before the data
is actually retrieved across the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Returns the list object which will be empty on error (len() of 0), in which case cErrorMessage and nErrorNumber
will be set with explanatory values.  If the list is empty and you included values for fieldtomatch and
matchvalue and if nErrorNumber = 0, your filter criteria didn’t match any records.  With more recent versions
of Python where dict() types are always ordered, the ordering will be in the order the fields appear in
the table structure or in the order in the fieldlist parameter, if provided.</p>
</dd>
</dl>
<p>ValueError will be raised if non-matching value types are passed as matchvalue or if a non-existing field name
is passed.</p>
<p>Sets the value of the tally property to the number of records added to the array.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.countfor">
<code class="sig-name descname">countfor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">expr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.countfor" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the number of records in the currently selected table that satisfy the logical expression contained
in expr.  Returns a value from 0 to the number of records in the table on success.  Returns -1 on any kind
of error (for example an invalid expression string).  See locate() for examples of valid contents for the
expr parameter.  This obeys the setting of DELETED.
Other considerations:</p>
<ul class="simple">
<li><p>Must NEVER be used in the midst of a locate/continue/locateclear sequence. If it is,
it will return -1 error.</p></li>
<li><p>Does not alter the current record pointer position, so can be called on the current table in the middle
of a scan().</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.createtable">
<code class="sig-name descname">createtable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcTableName</span></em>, <em class="sig-param"><span class="n">lxFieldInfo</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.createtable" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that creates a DBF type table, overwriting any pre-existing table of the same name.  Pass        the name of the table and an array of field info structures or a string containing field definitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lcTableName</strong> – Is a string value containing a file name specification.  The name should have a ‘.DBF’            extension for compatibility with other programs that might access it; however, the .DBF extension is not            strictly required so long as you know what the file is – these routines will open it again as a DBF file            if you pass its full name and extension to the use() method.</p></li>
<li><p><strong>lxFieldInfo</strong> – <p>The second parameter to pass takes one of two different types of values:</p>
<ul>
<li><p>String - containing field specification information</p></li>
<li><p>List - with each element containing an instance of a VFPFIELD object having information on one field.</p></li>
</ul>
<p>The string version is the easiest to program.  It is a newline-delimited list of field specification                strings.  Each field specification string is a comma delimited set of field property values.                  The contents are in the form: &lt;field name&gt;,&lt;field type&gt;,&lt;field width&gt;,&lt;field decimals&gt;,&lt;field allows nulls&gt;</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cField1</span> <span class="o">=</span> <span class="s2">&quot;FIRSTFIELD,C,30,0,FALSE&quot;</span>
<span class="n">cField2</span> <span class="o">=</span> <span class="s2">&quot;SECONDFLD,C,25,0,FALSE&quot;</span>
<span class="n">cStructure</span> <span class="o">=</span> <span class="n">cField1</span> <span class="o">+</span> <span class="n">cNewLine</span> <span class="o">+</span> <span class="n">cField2</span>
</pre></div>
</div>
<p>This would create a character field named FIRSTFIELD with a width of 30 bytes and would not allow nulls.                A second character field is defined and the strings are concatenated to form the structure definition.                For a brief list of field types see the doc for copytoarray().  For complete documentation on defining                fields in a DBF, see the CodeBase documentation and the types described in the docstring of this Class.</p>
<p>One field will be created in the table for each specification string, in the order listed.</p>
<p>Alternatively, you may supply a list of VFPFIELD objects each containing one field spec.  The properties of                each object must be set to define the field.  For example, for a VFPFIELD object vfx you might set:</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vfx</span> <span class="o">=</span> <span class="n">VFPFIELD</span><span class="p">()</span>
<span class="n">vfx</span><span class="o">.</span><span class="n">cName</span><span class="o">=</span><span class="s2">&quot;FIRSTFIELD&quot;</span>
<span class="n">vfx</span><span class="o">.</span><span class="n">cType</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
<span class="n">vfx</span><span class="o">.</span><span class="n">nWidth</span><span class="o">=</span><span class="mi">30</span>
<span class="n">vfx</span><span class="o">.</span><span class="n">nDecimals</span><span class="o">=</span><span class="mi">0</span>
<span class="n">vfx</span><span class="o">.</span><span class="n">bNulls</span><span class="o">=</span><span class="kc">False</span>
</pre></div>
</div>
</p></li>
</ul>
</dd>
</dl>
<p>The most common use of this list of VFPFIELD type input is to obtain a list generated by the afields() method
from a currently open table.  This allows you to easily create an exact empty copy of an existing table with just
two lines of code, or by append to or deleting from the afields() result list, you can alter the table structure
to fit your immediate needs.  Note that the elements of the VFPFIELD object class ARE type-specific.  For example
the cName value MUST be a string, the nWidth value MUST be an integer.  You can also create VFPFIELD objects
using the newfield() function.  These can then be appended into a list() for building a table structure.</p>
<p>General rules:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Field names must be 10 characters or less and start with a letter or underscore</p></li>
<li><p>No two field names may be the same</p></li>
<li><p>Maximum number of fields is 254 for VFP Compatibility (See limits documentation above)</p></li>
<li><p>Maximum size (width) of a character field is 255 bytes</p></li>
<li><p>Maximum size of a record is 65,500 bytes</p></li>
<li><p>If you include one or more type ‘M’ fields (memo or large text) fields, a memo file will also            be created with the same base name as the table and an extension of .FPT</p></li>
<li><p>In the Large Table Mode, the maximum values are substantially greater, see the Class docstring            on the Large Table Mode limits.</p></li>
</ol>
</div></blockquote>
<dl class="simple">
<dt>Limitations:</dt><dd><ol class="arabic simple">
<li><p>This version of CodeBase cannot read or update VFP tables with auto-incrementing Integer fields.</p></li>
<li><p>Tables contained in a Visual FoxPro database container can be opened, but features derived from            the database container like long field names, triggers, validations, captions, etc., will not be            available.</p></li>
<li><p>Tables will always be created in the Visual FoxPro FREE mode, meaning that they are not contained            in a database container.</p></li>
</ol>
</dd>
</dl>
<p>After the createtable() method finishes successfully, the newly created table will be empty and will be
the currently selected table, opened in read/write mode, ready for appending records.  The alias of this
table will be the base file name using the default alias naming rules when a specific alias is not provided.
Be sure that there is no table open with that alias already, or that table will be automatically closed and
possibly overwritten!  If you want the new table to have a custom alias, close it immediately using
the alias() value passed to the closetable() method, and re-open it with your custom alias specified explicitly.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Returns True on success, False on failure, in which case inspect properties cErrorMessage and nErrorNumber
for an explanation.  Some errors such as invalid field names or other field characteristics will trigger
a Python ValueError exception.  When a list is supplied, the CodeBasePYWrapper pyd module generates the
Python exceptions, if required.</p>
</dd>
</dl>
<p>NOTE: In some versions of Windows, it is recommended to close the newly created table immediately, and
re-open it to ensure that all elements of the table are written properly to the disk.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.cursortoxml">
<code class="sig-name descname">cursortoxml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cAlias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cForExpr</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cFields</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bStripBlanks</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">cFileName</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cpRecName</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cAltMainTag</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.cursortoxml" title="Permalink to this definition">¶</a></dt>
<dd><p>In VFP the CURSORTOXML() function is a powerful means of copying all or part of a cursor or table into
XML form in several different ways.  This method provides a subset of that functionality, creating a file
that is identical to the default VFP output where each record has a tag, and each field in that record has
its tag and the corresponding value contained in the tag.  The top-level tag name is always &lt;VFPData&gt;.  All
field and cursor record tags are lower case.  Outputs fields in each record in the order in which they
appear in the table or in the order in the cFields list. See also xmltocursor().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cAlias</strong> – Pass the alias name if not the currently selected table.</p></li>
<li><p><strong>cForExpr</strong> – Pass a valid logical expression to select records.  If omitted, all records will be output</p></li>
<li><p><strong>cFields</strong> – Pass a comma delimited list of field names to limit the output to selected fields.</p></li>
<li><p><strong>bStripBlanks</strong> – By default, trailing blanks on text fields are left in place.  Set this true to trim them</p></li>
<li><p><strong>cFileName</strong> – Pass a file name to output the result directly into that text file.  If omitted, then
the method will return the resulting XML as a string</p></li>
<li><p><strong>cpRecName</strong> – Each record output will be set off in a repeating tag name.  If a value is provided for
this parameter, it will be used for that repeating tag name, otherwise the system will generate a
unique 8-character name in all lower case for the record tags.</p></li>
<li><p><strong>cAltMainTag</strong> – By default this function follows the VFP practice and wraps everything in &lt;VFPData&gt; tags.
If you want something different, specify the base name here.  The system will add the brackets.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The XML text as a string unless the cFileName parm is not empty.  If cFileName is “”, if an error
occurs, the function will return “”.  If cFileName is a file name, returns True on success, False on
failure, and sets cErrorMessage.</p>
</dd>
</dl>
<p>NOTE: The XML text is stored in memory until output at the end.  Very large tables may produce memory
issues as a result, especially in 32-bit versions of Python.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.curval">
<code class="sig-name descname">curval</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcFieldName</span></em>, <em class="sig-param"><span class="n">convertType</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">coding</span><span class="o">=</span><span class="default_value">'XX'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.curval" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a generic CURVAL() (see VFP Function CURVAL()) that returns the
value of a specified field found either in the currently selected table
(just pass the field name) or in any open table (prefix the field name
with the table alias and a ‘.’ in the lcFieldName parameter. If
convertType is False or omitted, returns a tuple consisting of the
string representation of the field value followed by the type of the
value. See scattertoarray() for more details on the formatting of date
and datetime values and type codes. If convertType is True, then returns
a single scalar value of the Python type corresponding to the field
value type.  Char and Memo fields will always return type string with
coding as set by the coding parm.  If convertType is False all other field types
will be in plain ASCII stored in string variables, except for binary char and
memo fields, which will be returned as bytearray (ver 2.x) or bytes (ver 3.x).</p>
<p>Returns (None, None) or None on error. May also return None on fields
containing empty dates. If you are expecting a date field and receive
(None, None) or None, check the cErrorNumber for a non-0 value
indicating an error.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.curvaldate">
<code class="sig-name descname">curvaldate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcFieldName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.curvaldate" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the contents of one field specified by the parm lcFieldName.
This field MUST be of type DATETIME or of type DATE.</p>
<p>If you want a value from a table other than the currently selected one,
use the alias.fieldname notation in the name of the string you pass in
the lcFieldName parameter.</p>
<p>Returns a Python datetime.date() value. A value of None is returned if the
field value is empty or on error. If you have any doubt about the None
value returned, then check the error messages. A non-blank error
message or an error number other than 0 may indicate an invalid field
name or a non-existant alias name.</p>
<p>Designed for speed with minimal checking. Works ONLY for DATETIME and DATE
type fields. Does NOT produce useful results from ANYTHING else.  For DATETIME
fields still only returns the date portion of the value.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.curvaldatetime">
<code class="sig-name descname">curvaldatetime</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcFieldName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.curvaldatetime" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the contents of one field specified by the parm lcFieldName.
This field MUST be of type DATETIME or of type DATE.</p>
<p>If you want a value from a table other than the currently selected one,
use the alias.fieldname notation in the name of the string you pass in
the lcFieldName parameter.</p>
<p>Returns a Python datetime.datetime() value. A value of None is returned if the
field value is empty or on error. If you have any doubt about the None
value returned, then check the error messages. A non-blank error
message or an error number other than 0 may indicate an invalid field
name or a non-existant alias name. If the field is of type DATE, the
return will still be a python datetime type but the values for hour,
minute, and second will all be 0.</p>
<p>Designed for speed with minimal checking. Works ONLY DATETIME and DATE
type fields. Does NOT produce useful results from ANYTHING else.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.curvaldecimal">
<code class="sig-name descname">curvaldecimal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcFieldName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.curvaldecimal" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the contents of one field specified by the parm lcFieldName as a Python decimal.Decimal()
type value, which contains an exact representation of any fractional portion.
If you want a value from a table other than the currently selected one,
use the alias.fieldname notation in the name of the string you pass
in the lcFieldName parameter. This method ONLY works with fields that
are of type NUMBER, FLOAT, or CURRENCY.  Note that in Visual FoxPro, a FLOAT type is exactly
the same as NUMBER.  Conversely, a DOUBLE is stored in binary form, and may not be able to
represent fractional data precisely.  An attempt to retrieve a DOUBLE field with this function
will return an ERROR condition (None).</p>
<p>Returns the number as a decimal.Decimal() object or None on error. Error can be triggered by a bad
field name, a non-numeric field, or no table open, etc.</p>
<p>Designed for speed with minimal checking.</p>
<p>NOTE:!!!!!  In DBF tables, decimal places are defined, and their values are
explicit… in a field of type N(10,2) the value 3.33 is stored exactly as 3.33, not
as some rounding of a binary representation of that value.  This method, however,
preserves the decimal exactness you may require.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.curvalfloat">
<code class="sig-name descname">curvalfloat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcFieldName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.curvalfloat" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the contents of one field specified by the parm lcFieldName as a Python float type variable.
If you want a value from a table other than the currently selected one,
use the alias.fieldname notation in the name of the string you pass
in the lcFieldName parameter. This method ONLY works with fields that
are of type NUMBER, FLOAT, DOUBLE or CURRENCY.  (It MAY work with INTEGER, but
will return a float, so may not be terribly useful.)</p>
<p>Returns the number as a float or None on error. Error can be triggered by a bad
field name, a non-numeric field, or no table open, etc.</p>
<p>Designed for speed with minimal checking.</p>
<p>NOTE:!!!!!  In DBF tables, decimal places are defined for NUMBER fields, and their values are
explicit… in a field of type N(10,2) the value 3.33 is stored exactly as 3.33, not
as some rounding of a binary representation of that value.  The same is true of CURRENCY fields.
This method, however, returns the value as a Python float, which IS a binary representation which may NOT
be exactly the value desired.  For CURRENCY field types, especially, this is generally NOT what is desired.
To preserve the decimals exactly, use curvalstr() and convert the result into the required
python type that preserves the decimal exactness you require OR use curvaldecimal().</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.curvallogical">
<code class="sig-name descname">curvallogical</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcFieldName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.curvallogical" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the contents of one field specified by the parm lcFieldName.
This field MUST be of type LOGICAL. If you want a value from a table
other than the currently selected one, use the alias.fieldname notation
in the name of the string you pass in the lcFieldName parameter.</p>
<p>Returns a Python value of true or false. A value of None is returned on
error. If you have any doubt about the None value returned, then check
the error messages. A non-blank error message may indicate an invalid
field name or a non-existant alias name.</p>
<p>Designed for speed with minimal checking. Works ONLY with logical type
fields. Does NOT produce useful results from ANYTHING else.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.curvallong">
<code class="sig-name descname">curvallong</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcFieldName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.curvallong" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the contents of one field specified by the parm lcFieldName.
If you want a value from a table other than the currently selected one,
use the alias.fieldname notation in the name of the string you pass
in the lcFieldName parameter. This method ONLY works with fields that
are of type INTEGER, DATE, or NUMBER. In the case of DATE, you’ll get
the Julian day number back. In the case of NUMBER, you’ll get the whole
number part of the value back as a long.</p>
<p>Returns the number or None on error. Error can be triggered by a bad
field name or no table open, etc.</p>
<p>Designed for speed with minimal checking.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.curvalstr">
<code class="sig-name descname">curvalstr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcFieldName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.curvalstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the contents of one field specified by the parm lcFieldName.
If you want a value from a table other than the currently selected one,
use the alias.fieldname notation in the name of the string you pass in
the lcFieldName parameter.</p>
<p>Designed for speed with minimal checking. Works OK with char, memo,
number, currency, and date type fields. Does not produce useful results from
integer, double, datetime, or float type fields.  Note that the contents of char fields
are padded with blanks to the full size of the fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>Returns a text string representation of the field value. No conversions
are performed. An empty string is a valid return value, but if you
expect something else, check the error messages. An empty string is also
returned if the lcFieldName is not found in the current table or if your
specified alias doesn’t exist.</p>
<ul class="simple">
<li><p>Returns None on error, and sets errormessage and errornumber</p></li>
<li><p>Returns None when field allows null and has a null value, but does NOT set errors.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.curvalstrEX">
<code class="sig-name descname">curvalstrEX</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcFieldName</span></em>, <em class="sig-param"><span class="n">lbStrip</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.curvalstrEX" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the contents of one field specified by the parm lcFieldName.
If you want a value from a table other than the currently selected one,
use the alias.fieldname notation in the name of the string you pass in
the lcFieldName parameter.</p>
<p>Designed for speed with minimal checking. Works OK with char, memo,
number, currency, and date type fields. Does not produce useful results from
integer, double, or float type fields.  May truncate the contents of Unicode
strings contained in char(binary) and memo(binary) fields.</p>
<dl class="simple">
<dt>Enhancements over curvalstr:</dt><dd><ul class="simple">
<li><p>Allows specification of stripping trailing blanks.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Returns a text string representation of the field value. No conversions
are performed. An empty string is a valid return value, but if you
expect something else, check the error messages. An empty string is also
returned if the lcFieldName is not found in the current table or if your
specified alias doesn’t exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.dbf">
<code class="sig-name descname">dbf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alias</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.dbf" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Returns the fully qualified path name of the currently selected table or the table</dt><dd><p>referenced by the optional parameter alias.  Returns the empty string if there is no
currently open table or if the alias doesn’t exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.delete">
<code class="sig-name descname">delete</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks the current record of the currently selected table for deletion.  Does not move the record pointer
even if DELETED is set ON.</p>
<p>Returns True on success, False on failure, in which case cErrorMessage and nErrorNumber will provide more
information.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.deleted">
<code class="sig-name descname">deleted</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.deleted" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the current record of the currently selected table has been marked for deletion.
Returns True if the record has been marked for deletion.  Returns False if it hasn’t.  Returns
None if there has been an error.</p>
<p>Inspect cErrorMessage and nErrorNumber if None is returned for more information.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.deletetag">
<code class="sig-name descname">deletetag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tagname</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.deletetag" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify a tag name in the CDX index of the currently selected table to be removed from the CDX file.  If the
last tag is removed from a CDX index file, the CDX index file is deleted and the DBF file is marked as having
no index files.  DO NOT use this method to remove an index tag from a VFP table contained in a VFP Database
Container.  Doing so will result in data corruption.  This can only be applied to so-called VFP Free Tables.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.deletetagall">
<code class="sig-name descname">deletetagall</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.deletetagall" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes all index tags for the currently selected table. The CDX index file is deleted and the
DBF file is marked as having no index files.  Returns True on success, False on failure.  Returns True
if there are no tags set up for the table, even though there is nothing to do.  DO NOT use this method to
remove index tags from a VFP table contained in a VFP Database Container.  Doing so will result in data
corruption.  This can only be applied to so-called VFP Free Tables.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.dispstru">
<code class="sig-name descname">dispstru</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lbToText</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.dispstru" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes text to the stdout via a series of print commands which contains information about the structure of the
currently selected table.  This is the equivalent of the VFP command DISPLAY STRUCTURE.</p>
<p>Pass a True to lbToText and the function will return a string with this information.</p>
<p>Returns True for OK and False on failure (usually because there is no currently selected table if lbToText is False.
If lbToText is True, then returns the string on Success and an empty string on failure.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.dt2seek">
<code class="sig-name descname">dt2seek</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dateValue</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.dt2seek" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass a date value, and this returns the proper string format required for the seek() method below.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.dtd2expression">
<code class="sig-name descname">dtd2expression</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dateTimeValue</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.dtd2expression" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to dtt2expression() except it uses the STOD() function to match date type fields. NOTE that the
Python values returned from VFP DATE and DATETIME fields are always Python datetime objects, BUT in VFP
they are different entities and can’t be compared directly.  So if a field is a type DATE, you must create
the matching expression with the STOD() function using this method.  Also note that STOD() is NOT a VFP
function but a dBase function recognized by CodeBase in expressions.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.dtt2expression">
<code class="sig-name descname">dtt2expression</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dateTimeValue</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.dtt2expression" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass a date/time value and this will return a text string appropriate for a constant datetime value
in an expression for a location or calculate function.  In VFP a constant date/time value is expressed
with elaborate notation like {^2013-02-15 12:35:00}, but Codebase doesn’t recognize this.  Instead,
it wants a function like “DATETIME(2013, 2, 15, 12, 35, 0)”.  This function produces that latter string value.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.dtt2seek">
<code class="sig-name descname">dtt2seek</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dateTimeValue</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.dtt2seek" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass a datetime value, and this returns the proper string format required for the seek() method.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.eof">
<code class="sig-name descname">eof</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.eof" title="Permalink to this definition">¶</a></dt>
<dd><p>Interrogates the record pointer status of the currently selected table.
Returns True if the record pointer is at the EOF position or on error. Otherwise
returns False. If False, the record pointer is not at the end. Otherwise EOF or
an error has occurred and you should take further action.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.fcount">
<code class="sig-name descname">fcount</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.fcount" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of fields in the currently selected table or -1 on any kind of error.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.fielddicttolist">
<code class="sig-name descname">fielddicttolist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lxDict</span></em>, <em class="sig-param"><span class="n">lcAlias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">bPartial</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">cDelim</span><span class="o">=</span><span class="default_value">'&lt;~!~&gt;'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.fielddicttolist" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a record value dictionary as provided by the scatter() method to a list in the format required
by the insertintotable() method, together with a field name string as required by that method as well.</p>
<p>The first parameter is the dictionary.  The second parameter is the alias name of the target table which
you’ll be updating from the values in the list.  Note this parameter is required.  Returns a tuple consisting
of the list of values as the first element and a delimited string list of field names in the correct
order as the second element.
bPartial:  Indicates the lxDict has only SOME of the fields.  Make sure ALL other fields are set.</p>
<p>Note that the lxDict dictionary must have an entry for every field in the table, but it is NOT limited
just to those values.  This allows you to build a dictionary with other information besides the required
fields for whatever purpose in subsequent processing, and just use the fields required for the table when
processing through this method.</p>
<p>NOTE: This method is useful for supplying a list and a string of field names for the older version of
insertintotable().  In this version of CodeBaseTools for Python, a dictionary of field values keyed by
field name may be passed directly to insertintotable(), which uses the function insertintotableex() to
pass the dictionary directly to the CodeBase engine.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.fieldinfo">
<code class="sig-name descname">fieldinfo</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fieldname</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.fieldinfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the field structure info for just one field without the bother of afields()
:param fieldname: may include the alias
:return: tuple - (type, length, decimals, allow nulls, is binary) or None on error.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.flock">
<code class="sig-name descname">flock</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">retries</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">interval</span><span class="o">=</span><span class="default_value">0.1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.flock" title="Permalink to this definition">¶</a></dt>
<dd><p>Locks the currently selected table.  This allows you to safely update multiple records or collect statistics
about the contents of a table without risk of other processes changing the contents.  Also if you cannot place
the flock() and can afford the time, pause for a few milliseconds and then try again.  You can do this
explicitly by specifying a number of retries in the retries parm and an interval specified in fractions of a
second (default is 0.1 seconds).</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.flush">
<code class="sig-name descname">flush</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Call this function immediately after a gatherfromarray() to force the data changes to be written
immediately to the disk.  This will ensure that other users of the data will see it immediately.  Otherwise
CodeBase will buffer writes and could delay these writes until the buffer is full.</p>
<p>This action applies only to the currently selected data table.</p>
<p>Returns True on success, False on Error, in which case you need to check cErrorMessage and nErrorNumber.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.flushall">
<code class="sig-name descname">flushall</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.flushall" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to flush() but applies to all open tables.</p>
<p>Will attempt to lock each record being updated.  Also checks to make sure that there are no duplicate
values for indexes that require unique keys.  If these tests fail, the flushall() can fail.</p>
<p>Returns True on success, False on Error, in which case you need to check cErrorMessage and nErrorNumber.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.gatherdict">
<code class="sig-name descname">gatherdict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cAlias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">dData</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">coding</span><span class="o">=</span><span class="default_value">'XX'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.gatherdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Fast, modern alternative to gatherfromarray() which updates the current record of the specified table
with the data contained in the dictionary dData.  Will accept the optional alias name of a currently
open table if you wish to store the data to a table that is not currently selected.  BE CAREFUL to make sure
that the target table current record is the one you want to update.  Attempting to update a record
in any table where there is no active record (either no records in the table or the record pointer at EOF)
results in an error condition.</p>
<p>Returns True on success, False on any kind of error.  Consult the error properties for reasons.</p>
<p>Note that some types of errors will trigger Python exceptions.  These include passing illegal values
to a field and passing field names that are too long or not of type string.</p>
<p>Codes specify how string, bytes and bytearray objects are coded into field data.  XX is “default”.  For
details, see the docs for curval().  You can specify a conversion code for normal char and memo fields amd
another code for conversions of char(binary) and memo(binary).  For type ‘C’, you can also set alternative
codecs by setting the value of the default coding using setcustomcoding().</p>
<p>June 22, 2020, changed third parm name from “codes” to “coding” to match other methods.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.gatherfromarray">
<code class="sig-name descname">gatherfromarray</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lxValues</span></em>, <em class="sig-param"><span class="n">lxFields</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lcDelimiter</span><span class="o">=</span><span class="default_value">'&lt;~!~&gt;'</span></em>, <em class="sig-param"><span class="n">lbIgnoreMissing</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">coding</span><span class="o">=</span><span class="default_value">'X'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.gatherfromarray" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>THIS METHOD IS DEPRECATED.  IT HAS ISSUES IN PYTHON 3.x AND HAS BEEN REPLACED BY OTHER METHODS.</strong></p>
<p>NOT Recommended with Python 3x!  Note field types not supported!  Limited to text coded in Extended ASCII
using CodePage 1252. DEPRECATED.</p>
<p>Use <cite>insertdict()</cite> or <cite>gatherdict()</cite> INSTEAD.</p>
<p>This function is retained for backwards compatibility and for its modest speed advantage when used within
its limitations.</p>
<p>Writes values into the current record of the currently selected table.  If the current record is null or the
record pointer is at EOF, returns False.  Also returns False if there is no currently selected table.</p>
<p>VFP’s most powerful way to put values into a table record in the “GATHER FROM” command.  This method emulates
some of its power to be able update a selection of multiple fields all at once without the complication of SQL
syntax.  The function operates in two modes: Field Specific Mode and All Fields Mode.</p>
<p>Field Specific Mode:</p>
<p>In this case you must specify which fields are being updated (by name) and provide a value for each.  This may
be done in one of three ways:</p>
<p>Dictionary Mode:</p>
<p>Supply the first parameter as a dictionary containing the field values keyed by the field names.
The field values may be any Python type compatible with the type of the associated field.</p>
<p>For example, either a 1, True, or “T” are all accepted for the value of a LOGICAL field.  Any other type will
raise an exception of BadFieldValueType.  As another example, for DATETIME or DATE fields you may provide
either a datetime.date type value or a datetime.datetime value.  But be aware that integers and numbers will
be accepted for DATE values. In this case, the number will be truncated to an integer and interpreted as the
Julian Day value (in VFP the number of days since APPROXIMATELY Jan 1, 4800 BCE).  Specifically, the date
(Current Era or A.D.) February 1, 2011, has a VFP Julian Day value of 2455594.  DATE and DATETIME values can
also be supplied by tuples of integer Year, Month, and Day values (for DATE) or integer Year, Month, Day, Hour,
Minute, Second values (for DATETIME).</p>
<p>For character fields, any value type will be accepted and converted to a character representation.  See
comments under the Strings input type for more on type conversions.</p>
<p>Strings are allowed for all field types, but for correct evaluation they must follow the rules specified in the
Strings section below.</p>
<p>Lists: This requires a list of field names as the second parameter and a list of field values as the first
parameter.  The index of the field names and values must correspond.  As with the dictionary input, the field
value types must be compatible with the type of the target field.</p>
<p>Strings: Supply the second parameter as a string consisting of an ordered list of field names delimited by a
non-alpha string.  By default the delimiter is assumed to be &lt;~!~&gt;, but you may specify another string value
in the lcDelimiter parameter.  The first parameter must be another string containing a concantenated and
delimited string representation of all values referenced in the field list.  This value string must be ordered
identically to the field name string.  No type conversions or checking is done in this mode.  For this reason,
processing is fast, but you are responsible for expressing each field value in the correct format.
Formats are as follows for each type of DBF field:</p>
<blockquote>
<div><ul class="simple">
<li><p>CHARACTER - Any string value.  Strings longer than the length of the field will be truncated, shorter              strings will be right padded with blanks.  Extended ASCII wirh CodePage 1252 ONLY unless              data passed as a dict().</p></li>
<li><p>NUMBER - String representation of a floating point value in decimal format, e.g. “394039.395”.              For negative values, prepend the minus sign, e.g. “-25904.99”.  The actual number of decimals stored is              determined by the field format.  Excess digits to the right of the decimal point will be rounded              off.  Excess digits to the left of the decimal point will trigger a NumericOverflow error.              Number type fields store the exact value, e.g. 2.1 is stored as 2.1 if at least one decimal of              precision is specified, not 2.09999999999999999.  Relative to field size, the size of NUMBER              fields is defined by a total field width and the number of decimal places.  The total field width              must be sufficient to handle the largest value intended for the field INCLUDING the decimal point              AND any prepended minus sign.  For example a field defined as N(7, 3) can accommodate a value of              999.349 or -99.349 but NOT -999.349, as the latter value requires a field of size N(8, 3).</p></li>
<li><p>FLOAT - Similar to NUMBER, but the precision of the input number will be preserved in the value stored.              However, float values, like all IEEE float and double numeric values are stored as approximations              of the fractional component, e.g. 2.1 double may be stored as 2.0999999999999999.</p></li>
<li><p>NTEGER - String representation of any 4-byte integer value, e.g. “195023985” or “-234095”.  Values with              embedded decimals will be stored with decimal fraction truncated.</p></li>
<li><p>DATE - String representation of a date as 8 digits in the format YYYYMMDD.</p></li>
<li><p>DATETIME - String representation of a datetime value (thousandths of a second are not supported).  The              string must consist of 14 digits in the format YYYYMMDDHHMMSS.</p></li>
<li><p>LOGICAL - The single character “T” for True and “F” for False.</p></li>
<li><p>MEMO - Any string value.  The maximum length of the string is 2 Gigabytes, but in practice it is much less              since the maximum size of the FPT file which contains all the memo values is itself 2 Gigabytes.  Non              ASCII values may be stored in Visual FoxPro memo fields, but some other versions of DBF tables don’t              support this.</p></li>
<li><p>DOUBLE - Like Number.</p></li>
<li><p>CURRENCY - Like Number in that it stores an exact representation of the value but with a fixed 4 decimal              places.</p></li>
<li><p>GENERAL - Not supported except when data are supplied in a dictionary.</p></li>
<li><p>CHAR BINARY - Not supported except when data are supplied in a dictionary.</p></li>
<li><p>MEMO BINARY - Not supported except when data are supplied in a dictionary.</p></li>
</ul>
<p>NOTE: Empty DATE and DATETIME values —
Visual FoxPro and the DBF format allow the concept of an empty date and empty datetime value.  This is
NOT the same as a NULL value in these fields.  A NULL is an undetermined value.  An empty date is a value
of type date that doesn’t contain an actual date.  Ditto for datetime.  In VFP an expression like
somedate={ / / } (that’s VFP date notation) is completely legal.  Date and datetime fields in blank
records start out with the value of empty date and empty datetime respectively.  You can think of the empty
date and datetime values as analogs of “” and 0 in the string and number worlds.</p>
<p>Since Python doesn’t support empty date or datetime values, this module handles this using the value None.
To supply an empty date or datetime value in this method, supply the value of None.  If you are supplying
a string representation of a date or datetime, supply a string of 8 blanks for the empty date value or
”        000000” (8 blanks followed by 6 zeros) as the empty datetime value.  In methods like scatter()
and copytoarray() empty date and datetime values are converted to the Python value None.  This will be
indistinguishable from the value None which can be returned when the contents of the field is NULL.</p>
</div></blockquote>
<p>All Fields Mode:</p>
<p>If you are confident that you know how many fields are found in the table and want to quickly update all of them
at once very simply, you pass as the first parameter an ordered set of values corresponding to all the
fields in the table.  This single parameter may either be a list[] containing a value for every field in order
or a delimited string of field values as described above for the Strings type under the Field Specific Mode.  If
the number of fields you supply is not exactly equal to the number of fields, a MismatchedFields exception is
raised.  The list form allows non-string values to be passed as above.  Value type checking will be performed
on non-string types.  The string form does not do value or format checking and passes the delimited string
directly to the CodeBase engine for storage.</p>
<p>The lbIgnoreMissing parameter applies if the source (lxValues) is a dictionary.  In that case, set
lbIgnoreMissing to True if you want to store any data where there IS a match on the field name vs the key into
the dictionary, and where there isn’t a match, the problem is ignored.  If this value is left to False, the
default, such a condition will trigger a KeyError exception, which will have to be trapped externally.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Returns True on success, False on any kind of failure, in which case cErrorMessage and nErrorNumber will be
set with explanatory values.</p>
</dd>
</dl>
<p>Note that the dictionary returned by scatter() may be used as the first parameter of this method after you make
any required changes to the field values.
July 21, 2014 - Changed lbIgnoreMissing default to True. JSH.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.getNewKey">
<code class="sig-name descname">getNewKey</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataDir</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">readOnly</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">stayOpen</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">noFlush</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.getNewKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the next sequential unique key number for the passed filename or a negative
value on error.  Using this method provides an alternative to auto-incrementing keys which CodeBase
supports in a manner incompatible with Visual FoxPro.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataDir</strong> – cDataDirectory from configurator.  If NEXTKEY.DBF is not open and this is blank, triggers an            exception.  This is where the NEXTKEY.DBF table should be found if the method has to open it.</p></li>
<li><p><strong>filename</strong> – name of file to get next key.  Defaults to <em>current</em>, but if no current and blank, triggers            an exception.</p></li>
<li><p><strong>readOnly</strong> – if set, return <em>previous</em> key number, write nothing - (for testing) - NOT USED!</p></li>
<li><p><strong>stayOpen</strong> – if set, does not close NextKey.dbf when done.  For looping and testing.  For maximum speed when            using this function to add many records in a loop, open the NEXTKEY.DBF table prior to starting the            loop.  This function will then not try to open it every time it runs.</p></li>
<li><p><strong>noFlush</strong> – By default the method flushes the contents of the NEXTKEY.DBF table to disk using the OS flush            to disk command to make sure that any other users see the updates immediately. However, if that            won’t be needed for operational requirements, this function can be speeded up by more than a            factor of 10 by passing noFlush=True, to bypass this flushing action.  In that case, you may still            wish to issue a flush() function at the end of your looping update process.</p></li>
</ul>
</dd>
</dl>
<p>NOTE: CodeBase claims to support auto-generated key fields, but that functionality doesn’t appear to be
compatible with the corresponding feature in Visual FoxPro.  This function helps get around that limitation
by using a NextKey.dbf table to store the “next key” value of each table in your system.  The NextKey.dbf
table is expected to have two fields at minimum:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 9%" />
<col style="width: 21%" />
<col style="width: 19%" />
<col style="width: 10%" />
<col style="width: 7%" />
<col style="width: 10%" />
<col style="width: 14%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Field Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Width</p></th>
<th class="head"><p>Dec</p></th>
<th class="head"><p>Index</p></th>
<th class="head"><p>Collate</p></th>
<th class="head"><p>Nulls</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>TABLE_NAME</p></td>
<td><p>Character</p></td>
<td><p>20</p></td>
<td><p>0</p></td>
<td><p>Asc</p></td>
<td><p>Machine</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>NEXTKEYVAL</p></td>
<td><p>Integer</p></td>
<td><p>4</p></td>
<td><p>0</p></td>
<td></td>
<td></td>
<td><p>No</p></td>
</tr>
</tbody>
</table>
<p>It will need to have an index called TABLE_NAME on UPPER(TABLE_NAME).  The dataDir parameter tells the function
where to find the NextKey.dbf table.  This function uses record locking to ensure that no keys are duplicated
within the same table.</p>
<p>It is the responsibility of the programmer to know which field is the key field in the table and to do
the replace of the value generated by this function into the appropriate field in the table.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.getValueFromXMLString">
<code class="sig-name descname">getValueFromXMLString</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cValue</span></em>, <em class="sig-param"><span class="n">cType</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.getValueFromXMLString" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function that takes an XML value in standard VFP output format, and returns the Python native type
corresponding to the field type specified in the cType parameter
:param cValue:
:param cType:
:return: Native Python value or None on error.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.getdatasession">
<code class="sig-name descname">getdatasession</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.getdatasession" title="Permalink to this definition">¶</a></dt>
<dd><p>When multiple instances of this class exist, each will be given its own data session.
Other instances may set the “current” session to a different value.  If you find your
table is not reported ‘open’, when you think it should be try storing the session number
of your instance and restore to it with setdatasession().  If you change a current data session
be sure to put it back when exiting the function.
:return: Integer session number</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.getdateformat">
<code class="sig-name descname">getdateformat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.getdateformat" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtains the current setting of date format from the CodeBase engine.  Returns a text string indicting
the type of format. See setdateformat() for format codes.  Will always return a string value.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.getfieldinfo">
<code class="sig-name descname">getfieldinfo</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lpcFieldName</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.getfieldinfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns info on the width, decimals, type, nulls for a field in the currently selected table.</p>
<p>Return value is None, if the field doesn’t exist in the current table or there is no currently selected table.</p>
<p>Returns tuple of (cType, nLength, nDecimals, bNulls) if field is found.</p>
<p>This is retained for backward compatility.  Use fieldinfo() method instead which calls the
‘C’ engine directly for this information.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.goto">
<code class="sig-name descname">goto</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gomode</span></em>, <em class="sig-param"><span class="n">gonum</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.goto" title="Permalink to this definition">¶</a></dt>
<dd><p>Primary method for navigating through the currently selected table. Functionality is
similar to the GOTO command in Visual FoxPro and xBase languages. Unlike SQL-based
databases, VFP tables can be accessed navigationally by moving around amongst the records in
the table using variations of this method. Returns True when navigation is successful,
otherwise False. If False, inspect the cErrorMessage and nErrorNumber properties for more
information. The effect of this method is to move the current record pointer. The current
record will be the source of field information when the scatter() method is executed and the
target of updates when the gathermemvar() method is executed. If an order based on an index
Tag has been set by setorderto(), all gomode values except RECORD honor the index order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gomode</strong> – <p>character string containing one of the following values:</p>
<ul>
<li><p>RECORD - In this case you must supply the second parameter gonum with an integer                  value specifying the record number to move to. If the record number
specified doesn’t exist, the method returns False</p></li>
<li><p>SKIP - Moves the current record point forward or back a specified number of records                  (in index order if one has been set). If gonum is not supplied, then moves                  forward by one record.  If gonum &gt; 1, moves forward by gonum records if                  possible. If EOF() is reached before gonum records, returns False.  If gonum                  &lt; 0, moves backwards by gonum records if possible. If BOF() is reached                  before gonum records, returns False.</p></li>
<li><p>NEXT - Identical to SKIP with gonum = 1.</p></li>
<li><p>PREV - Identical to SKIP with gonum = -1.</p></li>
<li><p>TOP  - Moves to the top record by the current ordering (or record 1 if there is no                  index Tag ordering in effect).  If there are no records in the table, returns                  False.</p></li>
<li><p>BOTTOM - Move to the the last record by the current ordering (or the highest record                  number if there is no index Tag ordering in effect).  If there are no records
in the table, returns False.</p></li>
</ul>
</p></li>
<li><p><strong>gonum</strong> – used for gomode values of ‘RECORD’ for the record number and ‘SKIP’ to indicate the number            of records to move forward or backward in the table.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True on Success, False on Failure for any reason. Inspect the cErrorMessage or nErrorNumber
for reasons.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.indexon">
<code class="sig-name descname">indexon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcTag</span></em>, <em class="sig-param"><span class="n">lcExpr</span></em>, <em class="sig-param"><span class="n">tagFilter</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">descending</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">unique</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.indexon" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that creates an index tag for the currently selected open DBF table.  The indexes are stored
in the associated .CDX file with the same base name as the DBF table.  Each “Tag” represents one
index ordering which can be used for searching and traversing the table.</p>
<p>If no DBF is currently selected, or some other problem occurs, it returns False
otherwise returns True.  This method creates and modifies the VFP type CDX index
files which may contain multiple physical indexes, each identified by a Tag name.
It is expected that there will be one and only one CDX index for the table.  In VFP
and CodeBase, this one-to-one limit is not enforced, but with one CDX file having the
same base file name as the table, you are assured that the index will be updated with
its key values whenever the underlying table field values change.</p>
<p>If no CDX file exists for the table, one is created and the requested tag added to it.</p>
<p>If the tag exists, it is replaced with your new tag without any warning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lcTag</strong> – a character string of up to 10 alphanumeric values starting with a letter.  This is the name            of the index tag.  You use this tag name to specify an ordering of the table with the setorderto()            method.</p></li>
<li><p><strong>lcExpr</strong> – <p>a character string containing an index expression with one or more fields            defining the index ‘key’.  VFP and CodeBase are very flexible relative to index expressions.  You can            mix various types of fields, define their order and use internal functions to transform them:</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cTagExpr</span> <span class="o">=</span> <span class="s2">&quot;UPPER(LAST_NAME) + DTOC(BIRTHDATE, 1) + STR(SALARY)&quot;</span>
<span class="n">oDB</span><span class="o">.</span><span class="n">indexon</span><span class="p">(</span><span class="s2">&quot;COMPLEXTAG&quot;</span><span class="p">,</span> <span class="n">cTagExpression</span><span class="p">)</span>
</pre></div>
</div>
</p></li>
<li><p><strong>tagFilter</strong> – optional character string with an expression limiting the index to records which match            this expression.  If a tag filter is set on an index, traversing the table by the index will only show            the records which are allowed to be visible by the filter expression.</p></li>
<li><p><strong>descending</strong> – indicates the “direction” of the sort order being indexed.  0 indicates the default            ascending order, otherwise pass a non-zero integer for desencding order (starting with the largest            value and “descending” to the smallest.)</p></li>
<li><p><strong>unique</strong> – <p>one of several values determining how duplicate key values will be handled when the table            is indexed or new records are added:</p>
<ul>
<li><p>0 = No special handling, duplicate key values are recorded in the index normally.</p></li>
<li><p>15 = VFP Compatible “Candidate” index.  Duplicate key values will result in an error condition if                  encountered in the table.  Both VFP and CodeBase recognize this index type.</p></li>
<li><p>20 = CodeBase compatible setting.  Duplicate key values will result in an error condition if                  encountered in the table by CodeBase BUT, when VFP accesses or indexes the table it will behave                  like code 25.</p></li>
<li><p>25 = VFP type UNIQUE index.  In this case when the table is indexed, only the first occurrence of a                  duplicate is stored in the index.  If the table is traversed or browsed in this index order,                  it is possible that not all records will be visible or be displayed.  Behavior is the same                  for VFP and CodeBase.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True on success, False on any error (see properties cErrorMessage and nErrorNumber for            more information)</p>
</dd>
</dl>
<dl class="simple">
<dt>NOTE: As of Oct. 26, 2013, see method setstrictaliasmode(), which may be required to support this method</dt><dd><p>if you are using c4DLL.DLL versions earlier than the one provided as Open Source on GitHub.</p>
</dd>
</dl>
<p>IMPORTANT NOTE!!! Do NOT attempt to use this method to add an index to a table contained in a VFP Data Dictionary
Container.  Such tables can ONLY have indexes changed using VFP itself.  However, those indexes CAN be
reindexed successfully by the reindex() method.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.insertdict">
<code class="sig-name descname">insertdict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dDict</span></em>, <em class="sig-param"><span class="n">lcAlias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">coding</span><span class="o">=</span><span class="default_value">'XX'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.insertdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple version of insertintotable() that just takes a dict() of field names and values and inserts
the data into the specified lcAlias table or the current table if it’s empty.  Returns True on OK,
False on any error.  Synonymous with insertintotable() with a dict() parm, but simpler calling
signature and slightly faster performance.</p>
<p>For coding specifies txt string conversion rules for text and binary data.  See class docstring for
details of alloable codes.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.insertintotable">
<code class="sig-name descname">insertintotable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lxValues</span></em>, <em class="sig-param"><span class="n">lcFields</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">lcAlias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">lcDelimiter</span><span class="o">=</span><span class="default_value">'&lt;~!~&gt;'</span></em>, <em class="sig-param"><span class="n">coding</span><span class="o">=</span><span class="default_value">'XX'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.insertintotable" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs in one function the tasks of appending a new record to a table and filling the fields with new data.
This approach requires that values for every field must be supplied in the lxValues parameter.  The rules for
this field are identical to those for gatherfromarray() in the All Fields Mode.</p>
<p>Unlike gatherfromarray() this method allows you to specify an alias name if you don’t want to insert the
data into the currently selected table.  Of course the table specified by alias must first have been opened
by the use() method.</p>
<p>Call this function repeatedly in a tight loop to add lots of records to the table.  Do NOT call flush() or
flushall() until you are done.</p>
<p>The lxValues field is where you pass field data to the method.  There are three forms this value may take.
Depending on which form you supply, you may need to supply the lcFields parameter as well:</p>
<ol class="arabic simple">
<li><p>Dict() should be keyed by field name with native python values for each field as the item value.  Do not
pass any value for lcFields or an empty string.  lcDelimiter is ignored.  This is a fast, native Python
field update.  In this form, you do not need to populate the dict() with every field in the table,
just the ones you need to update.  However, be sure to pre-populate any primary keys that must be
unique!</p></li>
<li><p>String should contain a delimited text representation of the contents of each field.  Either all fields must be
supplied in the correct order as in the table, or supply a list of field names in the appropriate order
in the lcFields parameter.  The lcDelimiter value should be used for both.  See the gatherfromarray()
doc string for details on how strings should be formatted for logical, date and other non-text fields.</p></li>
<li><p>List() containing one element for each field you want to update.  In this case you MUST supply an
element of the list for every field in the table in the correct order.</p></li>
</ol>
<p>Returns True on Success, False on error.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.isexclusive">
<code class="sig-name descname">isexclusive</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.isexclusive" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the exclusive open status on the currently selected table.  Returns True if exclusive, False if
NOT exclusive.  Returns None on error.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.islargemode">
<code class="sig-name descname">islargemode</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.islargemode" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the status of Large Mode operations.  If this instance of the Tools is using large mode
then, this will return True.  Otherwise False.  If True, this tools instance may NOT be used to
open DBF tables that might also be opened concurrently by Visual FoxPro applications.</p>
<p>See the Class DocString for details on the difference between default mode and Large Table Mode
limits on table size and other properties.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.isreadonly">
<code class="sig-name descname">isreadonly</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alias</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.isreadonly" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the specified open data table was opened in read only mode, otherwise false.
:param alias: Specify the target table alias or leave empty for the currently selected table.
:return: True if opened readonly.  If in read-write or exclusive mode, returns False.  Returns None
on error - typically table not opened.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.locate">
<code class="sig-name descname">locate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">expr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.locate" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to find the first record in the table for which the logical expression in the expr parm
evaluates to True.  See also locationcontinue() and locateclear() for how to continue the process as you
work your way through the table.</p>
<p>Comparable to the VFP LOCATE command.  This operates ONLY on the currently selected table.</p>
<p>Args:
expr: A string value containing a logisal expression referencing one or more fields in the table.        This must contain a valid VFP/DBASE type expression and may include .AND., .OR., and other logical         expression elements.  Field names in the currently selected table may be included as well as VFP/DBASE        functions supported by CodeBase.  If any of the logical expressions contained in expr match index        expressions in index tags on the current table, CodeBase will optimize the search to take advantage         of the index.</p>
<p>Returns:
Returns True on success (found a record), False on failure for any reason.  Inspect nErrorNumber if there        is a possibility of an error condition.  It will have the value 0, if it is a simple no-find situation.        The most likely error conditions arise from invalid expressions.</p>
<p>Examples of valid expr values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;UPPER(LAST_NAME) = &quot;JONES&quot; .AND. UPPER(FIRST_NAME) = &quot;PETER&quot; .AND. SSN = &quot;123456789&quot;&#39;</span>
<span class="s1">&#39;STR(RecordKey) + TTOC(dateField, 1) + COMPANY = &quot;   123456720120629053329UNITED COPPER&quot;&#39;</span>
</pre></div>
</div>
<p>In the first example if there is an index on the expression UPPER(LAST_NAME) the search will be partially        optimizable and will be substantially faster than a brute force search through the table.  In the second        example, for it to be optimizable, an index tag would need to exist with the expression exactly the        same as the expression to the left of the = sign.</p>
<p>Note that logical expression operators like .AND. and .OR. are required to have the periods.  VFP is        tolerant of having those operators given simply as AND or OR, but the CodeBase DLL is not.  The allowed value        for True is .T. or .TRUE., for False it is .F. or .FALSE., where the period are required.</p>
<p>For testing the value of DATE or DATETIME type fields directly, you need a text string that contains        the appropriate CodeBase function with the required parameters to test the match. See the two        CodeBaseTools functions below to obtain the appropriate text strings for this match:</p>
<ul class="simple">
<li><p>dtt2expression()</p></li>
<li><p>dtd2expression()</p></li>
</ul>
<p>For example if a table has a field BIRTHDATE, and you want to locate records that have a
birthdate of July 7, 1986 you’d use this code where oCBT is an instance of cbTools():</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cDateMatch</span> <span class="o">=</span> <span class="n">oCBT</span><span class="o">.</span><span class="n">dtd2expression</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">1986</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">cExpr</span> <span class="o">=</span> <span class="s2">&quot;BIRTHDATE = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cDateMatch</span>
<span class="n">oCBT</span><span class="o">.</span><span class="n">locate</span><span class="p">(</span><span class="n">cExpr</span><span class="p">)</span>
</pre></div>
</div>
<p>Special considerations for searching for text strings: First note that the equality sign exists only
in one form: =, not in two as in VFP (= and ==), and that unlike in Python, it is a single equal sign.
When applied to a comparison with a string, the comparison is limited to the number of characters in
the match expression to the right of the equal sign.  So if the LASTNAME field contains “JOHNSON”,
the following expressions will all be true:</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LASTNAME</span> <span class="o">=</span> <span class="s2">&quot;JOHN&quot;</span>
<span class="n">LASTNAME</span> <span class="o">=</span> <span class="s2">&quot;JOHNSON&quot;</span>
</pre></div>
</div>
<p>but the following will be false:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LASTNAME</span> <span class="o">=</span> <span class="s2">&quot;JOHNSEN&quot;</span>
<span class="n">LASTNAME</span> <span class="o">=</span> <span class="s2">&quot;Johnson&quot;</span>
</pre></div>
</div>
<p>In addition, there is a $ operator which signifies “is contained in”.  So with the above value of the
LASTNAME field the following expressions would also be True:</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&quot;JOHN&quot; $ LASTNAME
&quot;OHNSO&quot; $ LASTNAME
</pre></div>
</div>
<p>Finally, relative to character matches, remember that in xBase DBF tables, character fields are
ALWAYS padded to their full width with spaces.  So in a LASTNAME field with a defined size of 20
characters and a value of “JOHNSONNEN”:</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LASTNAME</span> <span class="o">=</span> <span class="s2">&quot;JOHNSON&quot;</span> <span class="c1"># Evaluates to True</span>
<span class="n">LASTNAME</span> <span class="o">=</span> <span class="s2">&quot;JOHNSON &quot;</span> <span class="c1"># Evaluates to False, allowing you to establish an exact match.</span>
<span class="n">LASTNAME</span> <span class="o">=</span> <span class="s2">&quot;JOHNSONNEN &quot;</span> <span class="c1"># Evaluates to True, again testing for the exact match.</span>
</pre></div>
</div>
<p>See also the locateclear() and locatecontinue() methods which may be used on conjunction with locate()</p>
<p>While you are debugging, or where the expr value may be created by a user, the error number should always
be checked when False is returned, as False may be the result of an illegal expression.</p>
<p>WARNING!  The locate(), locatecontinue(), locateclear() sequence may NOT be nested.  Only ONE locate
process may be in effect at any one time!!!</p>
<p>NOTE: calling locate() clears the previously called locate(), so locate() may be called repeatedly if just one
record is needed each time.  At the end of calling a bunch of locates, you should then clear the locate sub-
system with a locateclear() since some other lookup functions may use the locate() logic internally, and will
fail if there is a pending un-cleared locate active.  To be safe, call locateclear() after any locate() if
you won’t be needing its results or locatecontinue() any more.</p>
<p>ALSO NOTE: Locate will not work consistently with the current index set to a descending index.  Use some        form of scan with an expression instead, which can traverse an index in reverse.</p>
<p>See also locatecontinue() and locateclear()</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.locateclear">
<code class="sig-name descname">locateclear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.locateclear" title="Permalink to this definition">¶</a></dt>
<dd><p>This method clears memory allocated for the locate() method and prepares the system for other searches.</p>
<p>It is REQUIRED after any locatecontinue() calls.</p>
<p>Returns True on success, False on failure, but the return value may normally be discarded.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.locatecontinue">
<code class="sig-name descname">locatecontinue</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.locatecontinue" title="Permalink to this definition">¶</a></dt>
<dd><p>After a successful call to locate(), you can call this method repeatedly until it returns False, to find
additional records matching the original logical test expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True on Success. On False, nErrorNumber will be non-zero if an error has occurred.  nErrorNumber will be 0 if there            simply are no more matching records.</p>
</dd>
</dl>
<p>locatecontinue() will traverse the table in the currently set order or in record number order if there
is no set order.  locatecontinue() called without a corresponding initial locate() will produce
either an error condition or an undefined result.</p>
<p>When locatecontinue() is called the currently selected table MUST be the same as was selected at the time
the preceding locate() was called or the results will be undefined.</p>
<p>It is STRONGLY recommended that after the last locatecontinue() method call in the series, the
locateclear() method be called to release memory and allow normal processing, seek(), etc., of the
currently selected table.</p>
<p>See also locate(), locateclear()</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.makeXMLValueString">
<code class="sig-name descname">makeXMLValueString</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xValue</span></em>, <em class="sig-param"><span class="n">cType</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.makeXMLValueString" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function that transforms a field type into a text value string for cursortoxml() output.
:param xValue: Any legal python value
:param cType: The official type of the database table from which it comes.
:return: Text string of the value to put into the XML block</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.maketempindex">
<code class="sig-name descname">maketempindex</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcExpr</span></em>, <em class="sig-param"><span class="n">tagFilter</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">descending</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.maketempindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a temporary, single use index that only lives as long        as the table is open.  This index has only one order embedded in it.  Similar to indexon, which        creates permanent indexes.</p>
<p>This method call applies the        index to the currently selected table and makes the new temp index the current order selection.  You        can traverse the file in the temp index order but seek() is not currently supported.  However, the        locate() method will exploit available temporary indexes if they allow the locate to be optimizable.
You can change to different orders in the regular index file (CDX) by using setorderto() while you keep        this temp index open.  Open temp indexes are updated when records are changed, added or deleted in the        table.</p>
<p>The temp index is associated with one alias – the currently selected one when the index was created.  If        the same table is open with a different alias, it cannot be accessed by that different alias with this        index order.</p>
<p>Multiple temporary indexes can be opened for a table at the same time, and you can switch back and forth        among them as required.  Closing the table with the closetable() method, closes all temporary indexes        associated with the specified alias and deletes the files they were stored in.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lcExpr</strong> – MUST be a valid VFP index expression</p></li>
<li><p><strong>tagFilter</strong> – if non-blank, must be a valid VFP logicalfilter expression. See indexon() for details.</p></li>
<li><p><strong>descending</strong> – Allows the index to travers in reverse order if set to 1 to have the index constructed in            reverse order (highest at the top).  The ‘unique’ option is not available for temp indexes.</p></li>
</ul>
</dd>
</dl>
<p>Returns: a valid index code &gt;= 0 or -1 on error. The method returns a temp index code which you should         store in case you need to set the ordering back to        this temp index with <cite>selecttempindex()</cite>, which uses the index code as its parameter.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.newfield">
<code class="sig-name descname">newfield</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cName</span></em>, <em class="sig-param"><span class="n">cType</span></em>, <em class="sig-param"><span class="n">nWidth</span></em>, <em class="sig-param"><span class="n">nDecimals</span></em>, <em class="sig-param"><span class="n">bNulls</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.newfield" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory method that create a new instance of the VFPFIELD object with properties set by the
parameters.  To create a new table, one option is to create each field object using this function
and append the result into a list().  That resulting list can be passed to createtable() to
build the desired table.
:param cName: Text string up to 10 characters.  May NOT begin with a number or a punctuation character
:param cType: One of the allowed field type codes such as ‘C’ for character, ‘N’ for numeric, etc.
:param nWidth: Width of a char (‘C’) field or ‘N’ field.  Set to 0 when not relevant.
:param nDecimals: Used only for Number fields.  Set to 0 otherwise
:param bNulls: If True, then the field will allow the value of .NULL. or None (in Python terms).
:return: The field object.  NO ERROR CHECING IS PERFORMED!</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.openTableList">
<code class="sig-name descname">openTableList</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">aTables</span></em>, <em class="sig-param"><span class="n">cPath</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.openTableList" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass this a list of values each consisting EITHER of a string containing a comma or space delimited
list of table names OR a list of tuples consisting of (tablename, readonly, alias).  Then the method
will attempt to open all tables, set each to the specified readonly status, and assign the
specified alias.  All three elements of each tuple must be passed, but they may be passed as None
or “”.  In that case the default readonly will be False, and the normal alias will be assigned.  The
same defaults will apply if the aTables value is a string of table names.</p>
<p>If one of the tables is to be opened exclusively, the readonly element of the tuple must be passed as
the text string “EXCL”.</p>
<p>Returns a list of the aliases, in the same order as the tables originally passed.  Returns None on
error, in which case you can inspect the cErrorMessage property for the reason why.  If None is returned,
NONE of the tables will be opened.  Any opened partway through the process will be closed before the return.</p>
<p>If cPath is non-empty, it will be prepended to each of the table names to make the full path name of
the table to be opened.  Otherwise you’ll need to put the fully qualified path name of each table
in the list of tuples.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.order">
<code class="sig-name descname">order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the index tag previously set by setorderto() from the currently selected table.  Returns a
string containing the tag name of the index tag set or an empty string if one isn’t set or there is no
currently active table.  If an error occurred (likely no table selected), the cErrorMessage and
nErrorNumber properties will be set.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.pack">
<code class="sig-name descname">pack</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.pack" title="Permalink to this definition">¶</a></dt>
<dd><p>Pack performs the VFP PACK function which copies all records NOT marked
for deletion to a temporary table, then empties out the table, and
copies the surviving records back into it. This method performs that
task on the currently selected table.</p>
<p>The VFP rule that this can only be performed on a table opened
exclusively is NOT enforced in this module, but if it is expected that
other users might access the table, then a use() with the exclusive
option should be done before applying a pack().</p>
<p>One of the side effects of a pack() is that memo files (the .FPT file)
storing memo field data, are restructured, which usually produces a
smaller file.</p>
<p>Returns True on success, False on failure of any kind. A typical error
would be that there is no currently selected table.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.recall">
<code class="sig-name descname">recall</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.recall" title="Permalink to this definition">¶</a></dt>
<dd><p>The opposite of delete().  This works on the current record of the currently selected table.  If
that record is marked for deletion, then removes the mark.  If not marked for deletion, then does
nothing.</p>
<p>Returns True on success, False on Error, in which case you need to check cErrorMessage and nErrorNumber.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.recallall">
<code class="sig-name descname">recallall</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.recallall" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a recall() operation on every record in the currently selected table currently marked for
deletion.  When this is done successfully, there will be no records in the table marked for deletion.</p>
<p>Returns True on success, False on error, in which case you need to check cErrorMessage and nErrorNumber.</p>
<p>Sets the value of the tally property to the number of records recalled.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.reccount">
<code class="sig-name descname">reccount</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.reccount" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the physical number of records contained in the currently
selected table. This will include records that have been marked for
deletion. Use countrecords() to get the number of undeleted records.</p>
<p>Returns -1 on error, in which case see cErrorMessage and nErrorNumber.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.recno">
<code class="sig-name descname">recno</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.recno" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the record number of the current record of the currently
selected table. Returns the record number on success, -1 on any kind of
failure.</p>
<p>When a table is opened the record pointer is automatically moved to
record 1, if it exists, and there is no selected index tag. If you need
to work on a record, then move to some other records, and later go back
to the original record, it is much faster to save the recno() value and
return to that record using the goto(“RECORD”, nTheRecord) method.</p>
<p>It is possible for the recno() value returned to be one greater than
the number of records as returned by the reccount() method. In that
case, the record pointer is at an EndOfFile condition, and eof() will
return true.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.refreshbuffers">
<code class="sig-name descname">refreshbuffers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.refreshbuffers" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a more drastic update of the information on the currently selected table than refreshrecord().
In this case, the entire cached data for the currently selected table is purged, forcing a re-read from
the disk of any part of the table required for subsequent processing, including the table header.</p>
<p>This function incurs substantial disk overhead the next time the table is accessed, so should be used with
care in loops where performance is a concern.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.refreshrecord">
<code class="sig-name descname">refreshrecord</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.refreshrecord" title="Permalink to this definition">¶</a></dt>
<dd><p>While VFP properly handles the refresh of its internal buffers when another application has changed a table,
CodeBase does NOT.  If you are working with a table that is potentially subject to changes by an external
application, and if you have been keeping this table open to save the time of re-opening prior to each
use, then before accessing the data, you should select the table and then call this method to be sure
the most recent version of the current record data is in the CodeBase internal buffers.</p>
<p>Note that this ONLY operates on the data in the current record.  Other records may remain buffered and
potentially out of date relative to changes made by other processes.</p>
<p>Returns True on success, False on failure.  On failure records the error message.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.reindex">
<code class="sig-name descname">reindex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.reindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Call this method to refresh the indexes on the currently selected table.</p>
<p>Normally indexes in CDX index files (the Visual FoxPro standard) are updated automatically by this module
as they are by VFP when changes are made to the table.  However, after a while the index pointers can become
inefficiently arranged, and a reindex can possibly improve performance on large (over 1mm records) tables.</p>
<p>Returns True on success, False on failure of any kind.</p>
<p>Note: If it is possible that other users will be accessing the table you wish to reindex, it is best to
use() the table with the exclusive=True parameter so as to prevent index corruption and data retrieval
errors by the other users.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.replace">
<code class="sig-name descname">replace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lpcFldName</span></em>, <em class="sig-param"><span class="n">lpxValue</span></em>, <em class="sig-param"><span class="n">coding</span><span class="o">=</span><span class="default_value">'XX'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides a quick and convenient way to replace the value of a field in the current record in any open table
without worrying about selecting the current table.  Further, it takes any native Python type and properly
stores it in the field, assuming that the Python type is compatible with the data field type.  See the
documentation for field and value types for the matchvalue in copytoarray().</p>
<p>To specify a field in any open table, prepend the field name with the table alias separated by a period.  For
example for the last_name field of the employee1 table, set the value of lpcFldName to “employee1.last_name”.</p>
<p>To Replace() a date type field value with the VFP empty date, supply a value of 0, not None.</p>
<p>Returns True on success, False on failure, and stores error info into cErrorMessage and nErrorNumber.</p>
<p>The ‘coding’ parm added April 21, 2018.  See the class docstring for codes that define how string values will
be converted for different text encodings. “XX” is the default coding.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.replacedatetimeN">
<code class="sig-name descname">replacedatetimeN</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lpcFieldName</span></em>, <em class="sig-param"><span class="n">lpnYear</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">lpnMonth</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">lpnDay</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">lpnHour</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">lpnMinute</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">lpnSecond</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.replacedatetimeN" title="Permalink to this definition">¶</a></dt>
<dd><p>Very fast storage into a datetime field using numeric values for the components. Very little error checking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lpcFieldName</strong> – Field name with optional alias specification.</p></li>
<li><p><strong>lpnYear</strong> – The year number (3 or 4 digits).  Recognizes years back to 200 AD, but does not correct            for the conversion from the Gregorian to the Julian calendar.</p></li>
<li><p><strong>lpnMonth</strong> – Month number 1 to 12.</p></li>
<li><p><strong>lpnDay</strong> – Day of month number.</p></li>
<li><p><strong>lpnHour</strong> – Hours part of the time from 0 to 23</p></li>
<li><p><strong>lpnMinute</strong> – Minutes past the hour, from 0 to 59</p></li>
<li><p><strong>lpnSecond</strong> – Seconds past the minute, from 0 to 59</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1 on OK, else 0 or -1 on failure.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.replacelong">
<code class="sig-name descname">replacelong</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lpcFieldName</span></em>, <em class="sig-param"><span class="n">lpnValue</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.replacelong" title="Permalink to this definition">¶</a></dt>
<dd><p>Very fast storage of a long value into a long field. Very little error checking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lpcFieldName</strong> – Field name with optional alias specification.</p></li>
<li><p><strong>lpnValue</strong> – Long value.  NO conversions are performed!!</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1 on OK, else 0 or -1 on failure.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.rlock">
<code class="sig-name descname">rlock</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">retries</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">interval</span><span class="o">=</span><span class="default_value">0.1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.rlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Locks the currently selected record of the currently selected table.  This allows you to safely update
the contents of the record either by a replace() or a gatherfromarray().</p>
<p>This method plus its corresponding one unlock() gives you the added measure of certainty relative to
the record updating process.  If activity in the target table is light, with few other users making updates,
it is not necessary to call rlock() explicitly.  After your field value updates, CodeBase waits until you move off
the record or call flush() to lock the record, write the data to the file, and then automatically unlock the
record.  Typically, this works without a hitch.  But in situations where there is a lot of save activity it
can happen that it is impossible to obtain the lock, and an error is reported from the record move or flush.</p>
<dl class="simple">
<dt>To avoid that possibility, the sequence would be:</dt><dd><ul class="simple">
<li><p>navigate to the record with seek(), skip() or goto()</p></li>
<li><p>scatter() the field values so you can work with them in your program</p></li>
<li><p>when you are ready to save changes back to the record, call rlock()</p></li>
<li><p>if rlock() returns True, you can call replace() or gatherfromarray() to make the changes</p></li>
<li><p>if rlock() and the update was successful, call flush()</p></li>
<li><p>call unlock()</p></li>
</ul>
</dd>
</dl>
<p>Returns True on Locked OK, False if unable to get lock for any reason.</p>
<p>Note: Leave the rlock() in place as short a time as possible.  Also if you cannot place the rlock() and can
afford the time, pause for a few milliseconds and then try again.  You can do this explicitly by specifying
a number of retries in the retries parm and an interval specified in fractions of a second (default is
0.1 seconds).</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.scan">
<code class="sig-name descname">scan</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">indexTag</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">forExpr</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">noData</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fieldList</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">getList</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">stripblanks</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">bNoTop</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">bDescending</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">coding</span><span class="o">=</span><span class="default_value">'XX'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.scan" title="Permalink to this definition">¶</a></dt>
<dd><p>Functions as an iterator that can be used for successively returning rows from the currently selected table
either as dictionaries, similar to scatter() which returns a dictionary for the current record, OR
as a list of values as from scattertoarray() if you pass getList as True.  Note that the items in the
returned list() will be either in the order the fields appear in the table or, if fieldList was passed,
in the order found in the fieldList string.</p>
<dl class="simple">
<dt>Call as:</dt><dd><dl class="simple">
<dt>for xx in xcbTools.scan(indexTag=”MyTag”, forExpr=”FIRSTNAME=’John’”)</dt><dd><p>print xx[“FIRSTNAME”], xx[“LASTNAME”]</p>
</dd>
</dl>
</dd>
</dl>
<p>Returns None on error and when done.  Note that if forExpr is provided (non blank) the iteration
will stop when there are no more records matching the forExpr.  If the indexTag value (or the currently
selected index tag) has an expression exactly matching the left hand side of the forExpr, then the iteration
may stop before an actual EOF() condition is reached.  Otherwise when the iteration is completed, the table
record pointer will be positioned at EOF().</p>
<p>noData parameter:  This returns a record number rather than the scattered contents of the entire record.
Use this if you just want a few fields and don’t want to waste the time for parsing the full record.</p>
<p>Support for temporary indexes:  If you want to scan in order by a temporary index, create the index
and then when scanning pass “” or omit the indexTag parameter.  Your temporary index ordering will apply
to the scan.  Specifying a different tag in the scan will substitute that ordering even if one or more
temporary indexes exist.</p>
<p>The  parameter fieldList is an optional comma-delimited list of field names.  If it is non-blank and if
noData is False, then the returned dict() or list() ONLY has the fields listed in the fieldList.  This allows fast
in-dll retrieval of field values even when you only want a few of the many fields in the table.</p>
<p>By default, this function starts the scan at the beginning of the table, based on the currently set or
specified index tag (or by recno, if no tag is active).  Pass bNoTop=True to override this behavior, and to
start from where the record pointer is currently positioned.  If bDescending is True, then by default goes
to the bottom of the table.  bNoTop is respected by not going to the bottom first in this case.</p>
<p>If bDescending is True, then the scan moves backward through the table in the specified order.</p>
<p>NOTE: Nested scans are NOT supported.  seek() is supported into another table in the middle of the scan.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.scatter">
<code class="sig-name descname">scatter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">converttypes</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">stripblanks</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fieldList</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">coding</span><span class="o">=</span><span class="default_value">'XX'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>The most generally used way to retrieve the contents of a data record
from the current record of the currently selected table or a table whose
alias you specify. Returns information on the contents of all fields in
the table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alias = specify the alias of a currently open table if you want a</strong> (<em>-</em>) – table other than the currently selected table. Does not change the
currently selected table unless there is no currently selected table.</p></li>
<li><p><strong>converttypes = Pass a value of False to get all values as text</strong> (<em>-</em>) – representations of their field values. For example, with convertypes
True, date values are returned as Python dates. With convertypes False,
date values are returned as strings of the form “YYYYMMDD”.
There is a small, but potentially significant improvement in performance
for data retrieval when converttypes is False, but that may be offset by
the requirement for further data conversion in your Python application.</p></li>
<li><p><strong>stripblanks = If set to True</strong> (<em>-</em>) – to strip off all the trailing blanks on all character fields. Note that
in VFP and all DBF tables, character fields are padded with blanks to
the full width of the field.</p></li>
<li><p><strong>fieldList = if not None</strong> (<em>-</em>) – to be included in the dictionary, separated by commas.</p></li>
<li><p><strong>should be a string of upper case field names</strong> (<em>it</em>) – to be included in the dictionary, separated by commas.</p></li>
<li><p><strong>coding = XX</strong> (<em>-</em>) – Recommended that you leave as default in Python 2.x.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>On success returns a dictionary consisting of field name keys and field
values. On failure returns the value of None and the cErrorMessage and
nErrorNumber values will be set for more information. You can modify the
values for individual fields in this dictionary and then store the
changes back to the table by passing the dictionary as the first
parameter to the gatherfromarray() method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.scatterblank">
<code class="sig-name descname">scatterblank</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcAlias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">lbBinaryAsUnicode</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.scatterblank" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary for an empty record in the currently selected table or the table specified by
alias.  Contains one item keyed by the uppercase of the field name and having a value representing an
empty field.  For example, if the field is an INTEGER, the value will be 0.  If the field is a LOGICAL,
the value will be .F. (VFP False).  If the field is CHARACTER, the value will be an empty string.  For
DATE and DATETIME fields, the value will be Python None.</p>
<p>Added 03/20/2012. JSH.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.scatterraw">
<code class="sig-name descname">scatterraw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">converttypes</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">stripblanks</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">lcDelimiter</span><span class="o">=</span><span class="default_value">'&lt;~!~&gt;'</span></em>, <em class="sig-param"><span class="n">coding</span><span class="o">=</span><span class="default_value">'XX'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.scatterraw" title="Permalink to this definition">¶</a></dt>
<dd><p>IMPORTANT: This function is here for backwards compatibility with older versions of this
module.  It is deprecated for future new development.  Use scatter() or other retrieval
mechanisms instead that are now just as fast or faster.</p>
<p>Retrieves the contents of a data record from the current record of the
currently selected table or a table whose alias you specify. Returns
information on the contents of all fields in the table. Applies NO
formatting or translation of the result data. Use for speed when you are
confident you know what is in the table and what order the fields are
found in.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alias = specify the alias of a currently open table if you want a</strong> (<em>-</em>) – table other than the currently selected table. Does not change the
currently selected table unless there is no currently selected table.</p></li>
<li><p><strong>delimiter = string of one</strong><strong> or </strong><strong>more characters</strong> (<em>-</em>) – used as the delimiter between the values in the output string.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>On success returns a simple character string containing a simple text
representation of the value of each table field in order. Returns no
information about field names. Values are delimited in the string by the
delimiter string, which defaults to “&lt;~!~&gt;”, but can be overridden…
Returns None on error.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.scattertoarray">
<code class="sig-name descname">scattertoarray</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">converttypes</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">stripblanks</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fieldList</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">coding</span><span class="o">=</span><span class="default_value">'XX'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.scattertoarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the contents of a data record from the current record of the
currently selected table or a table whose alias you specify. Returns
information on the contents of all fields in the table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alias = specify the alias of a currently open table if you want a</strong> (<em>-</em>) – table other than the currently selected table. Does not change the
currently selected table unless there is no currently selected table.</p></li>
<li><p><strong>converttypes = Pass a value of False to get all values as text</strong> (<em>-</em>) – representations of their field values. For example, with convertypes
True, date values are returned as Python dates. With convertypes False,
date values are returned as strings of the form “YYYYMMDD”.</p></li>
<li><p><strong>stripblanks = If set to True</strong> (<em>-</em>) – to strip off all the trailing blanks on all character fields. Note that
in VFP and all DBF tables, character fields are padded with blanks to
the full width of the field.</p></li>
<li><p><strong>fieldList = Comma delimited list of field names to include in the output.</strong> (<em>-</em>) – </p></li>
<li><p><strong>coding = XX for system text conversion defaults</strong><strong> or </strong><strong>a codec</strong><strong> or </strong><strong>Unicode value from</strong> (<em>-</em>) – docstring of this class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>On success returns a simple list of field values in the order in which the fields are found
in the table OR in the order in which the fields were listed in the fieldList parameter.  Returns
None on error.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.scattertolist">
<code class="sig-name descname">scattertolist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">converttypes</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">stripblanks</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fieldList</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">coding</span><span class="o">=</span><span class="default_value">'XX'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.scattertolist" title="Permalink to this definition">¶</a></dt>
<dd><p>Like scatter except that instead of returning a dict(), it returns a list of tuples which
can be sent via a COM connection to a COM client with the full record.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alias = specify the alias of a currently open table if you want a</strong> (<em>-</em>) – table other than the currently selected table. Does not change the
currently selected table unless there is no currently selected table.</p></li>
<li><p><strong>converttypes = Pass a value of False to get all values as text</strong> (<em>-</em>) – representations of their field values. For example, with convertypes
True, date values are returned as Python dates. With convertypes False,
date values are returned as strings of the form “YYYYMMDD”.</p></li>
<li><p><strong>stripblanks = If set to True</strong> (<em>-</em>) – to strip off all the trailing blanks on all character fields. Note that
in VFP and all DBF tables, character fields are padded with blanks to
the full width of the field.</p></li>
<li><p><strong>fieldList = if not None</strong> (<em>-</em>) – to be included in the dictionary, separated by commas.</p></li>
<li><p><strong>should be a string of upper case field names</strong> (<em>it</em>) – to be included in the dictionary, separated by commas.</p></li>
<li><p><strong>coding = default string text coding</strong><strong> or </strong><strong>values per class docstring.</strong> (<em>-</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>On success returns a list consisting of field names and field
values as a tuple for each field. On failure returns the value of None and the cErrorMessage and
nErrorNumber values will be set for more information. You can modify the
values for individual fields in this dictionary and then store the
changes back to the table by passing the dictionary as the first
parameter to the gatherfromarray() method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.scattertorecord">
<code class="sig-name descname">scattertorecord</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">converttypes</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">stripblanks</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fieldList</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">coding</span><span class="o">=</span><span class="default_value">'XX'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.scattertorecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Works just like scatter() except that it returns a named tuple with each element having a name
equal to the uppercased field name, thus: myResult.MYFIELD01
:return: The named tuple can either be accessed by index number or by the name of the item in the tuple.</p>
<p>Slower than plain scatter(), but may result in more readable code when handling the resulting output.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.seek">
<code class="sig-name descname">seek</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">targmatch</span></em>, <em class="sig-param"><span class="n">alias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">indextag</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.seek" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is closely analogous to the VFP SEEK() function and uses an
index Tag to find a record matching a specified lookup string (the
targmatch value). If a matching record is found, returns True, otherwise
False. False can also be returned for a number of other failure causes,
and the nErrorNumber should be checked for a non-zero value to identify
error situations. Unlike setorderto(), gathermemvar(), alias() and many
other methods, this one doesn’t have to work on the currently selected
data table. This allows you to do a seek() into another table in the
middle of traversing the currently selected table. You can retrieve
field values from the found record in that other table using curval() or scatter()
which allows you to specify the table from which to return the field
value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>targmatch</strong> – <p>A text string containing the value to find by the specified index tag.            For example if there is an index Tag with an expression of “UPPER(xCode            + yCode)” where xCode and yCode are each character fields of length            10, and you wanted to find a record with an xCode value of “abc” and a            yCode value = “yior” you would construct the targmatch as “ABC       YIOR      “.            Note that in DBF files character fields are automatically            padded to their full length with space characters, and a concantentation            of field values will include those spaces. Also note that the targmatch            values are all upper case because the field values in the example tag            expression are wrapped in a UPPER() function.</p>
<p>Some further rules for Tag expressions:</p>
<blockquote>
<div><ul>
<li><p>If the field indexed is a date field, the index expression must be a                    character string of the form “YYYYMMDD”.</p></li>
<li><p>If the field indexed is any type of number, the index expression must                    be a character string containing a text representation of the value                    being searched for. For example, if the field is an integer and                    you are searching for 29502, the targmatch string should be “29502”. For                    number, double, and currency type fields, be sure to include the decimal                    point in your text string.</p></li>
<li><p>If the field indexed is a datetime value, the index expression                    required is not exactly what you would expect.                    The required text string should be in the form “YYYYMMDDHH:MM:SS:TTT”                    where YYYY is the year, MM the month, DD the calendar day, HH the time                    hour (24 hour clock time), MM minutes, SS seconds, and TTT thousandths                    of seconds. BUT NOTE: the colons ARE REQUIRED. Also, since DBF tables                    can’t store datetime values accurate to the one thousandth of a second,                    the TTT value should always be “000”.</p></li>
<li><p>The dt2seek() and dtt2seek() methods of this class are provided to translate                    Python date and datetime objects to the required string to get a match in                    a seek() call where the indexed value is either a DATE or DATETIME type field.</p></li>
<li><p>If the tag expression is a character string, the targmatch value may                    be equal to or less than the length of the tag expression. If it is less                    than the length of the tag expression it will “find” the first record                    which matches the characters of the tag expression. If the targmatch                    string length is larger than the actual tag expression length, the                    result will always be False.</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>alias</strong> – Allows you to specify the alias name of any currently open            table. If passed as an empty string or omitted the currently selected            table is assumed. Otherwise the table specified by the alias name is the            subject of the seek. The currently selected table is NOT changed.</p></li>
<li><p><strong>indextag</strong> – Optional specification of the index tag to use for the            seek. If not specified, then seeks using the tag specified in the latest            setorderto() method for the table. In that case, if no current order has            been set for the table, the method returns False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True for success (record is found).  False for any other condition.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.select">
<code class="sig-name descname">select</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcAlias</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.select" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that sets the currently selected table to the one with the alias passed as the
parameter. If the string value you pass is not associated with an open table, a False is
returned. If the string is associated with an open table, that table becomes the currently
selected table, and a True is returned. Note that alias names are NOT case sensitive in VFP
or in this module.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.selecttempindex">
<code class="sig-name descname">selecttempindex</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnCode</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.selecttempindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Once a temporary index has been created with maketempindex, if you have needed to change the index order
for any reason, you can restore the temporary ordering of a previously created temp index. Store the return
value from maketempindex() and use it as the lnCode parm value in this method.  Subsequent goto() and skip()
method calls will use the temp index.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.setcustomencoding">
<code class="sig-name descname">setcustomencoding</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lpcEncoding</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.setcustomencoding" title="Permalink to this definition">¶</a></dt>
<dd><p>If you want string data to be retrieved and saved in an encoding different from the three basic options
(ASCII, UTF-8, and Code Page 1252), you can specify one the many standard Python encodings (see the Python
documentation for the latest complete list.)  For this custom configuration to be applied, the conversion
code of ‘C’ must be specified and the target field must be a binary version (either of char or memo).
:param lpcEncoding: Python encoding name like “cp1252” or “cp1251”.
:return: True.  Note that there is no error checking on the value of the lpcEncoding parameter!  If
you specify a non-existent name, this module will generate a coding error when processing binary data
with the ‘C’ conversion option.</p>
<p>See the Class documentation (doc-string) for specifics on the available encoding values for string
and binary values.  Note that while these values may be set in Py 2.x applications, their primary
use is in Py 3.x applications where all strings are Unicode.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.setdatasession">
<code class="sig-name descname">setdatasession</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nSession</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.setdatasession" title="Permalink to this definition">¶</a></dt>
<dd><p>set the data session back to what it was earlier.  the session number MUST be one that came
from getdatasession() or the results will be undefined.
:param nSession:
:return: The session number switched to or -1 on error</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.setdateformat">
<code class="sig-name descname">setdateformat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lpcFormat</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.setdateformat" title="Permalink to this definition">¶</a></dt>
<dd><p>Codebase, like the USA versions of Visual FoxPro assumes U.S. standard date
expressions of the form MM/DD/YY or MM/DD/YYYY, in contrast to other parts of
the world that use DD/MM/YY or DD/MM/YYYY or other combinations.  This default
assumptions about date text strings can be changed.  This is especially useful
when importing text data via the appendfrom() function.  If non-numeric
characters are found in the text, and it is intended to be stored in a date or
datetime field, then an attempt will be made to parse the text based on the
standard date expression, either MM/DD/YYYY or an alternate set prior to the
append process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>lpcFormat</strong> – <p>This must be a character string with at minimum the characters            ‘YY’ or ‘YYYY’, and ‘MM’, and ‘DD’ in some combination with punctuation.            The empty string or None restores the MDY/AMERICAN default. Alternatively             it must be one of the Visual FoxPro standard SET DATE TO values such as:</p>
<ul class="simple">
<li><p>AMERICAN = MM/DD/YY</p></li>
<li><p>ANSI = YY.MM.DD</p></li>
<li><p>BRITISH = DD/MM/YY</p></li>
<li><p>FRENCH = DD/MM/YY</p></li>
<li><p>GERMAN = DD.MM.YY</p></li>
<li><p>ITALIAN = DD-MM-YY</p></li>
<li><p>JAPAN = YY/MM/DD</p></li>
<li><p>TAIWAN = YY/MM/DD</p></li>
<li><p>USA = MM-DD-YY</p></li>
<li><p>MDY = MM/DD/YY</p></li>
<li><p>DMY = DD/MM/YY</p></li>
<li><p>YMD = YY/MM/DD</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1 on OK, 0 on any kind of error, mainly unrecognized formats.</p>
</dd>
</dl>
<p>NOTE: The total length of the lcFormat string must be no greater than 16 bytes.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.setdeleted">
<code class="sig-name descname">setdeleted</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lbHow</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.setdeleted" title="Permalink to this definition">¶</a></dt>
<dd><p>This function sets the DELETED status for all table access.  If DELETED ON or TRUE is set by passing a
value of True to the method() then most table navigation methods will automatically skip over deleted
records.  When this module is initialized, the status is set to DELETED OFF in which case all records
are visible regardless of deleted status.  To turn DELETED OFF, pass a False to the method.  This may be done
at any time and will affect all future table navigation until changed.</p>
<p>Again, note that this follows the FoxPro convention where the DELETED ON status tells the data engine to
ignore deleted records (Delete testing is ON).  When DELETED OFF has been set in VFP, all records, including
those on which the deleted flag has been set to TRUE are visible.</p>
<p>For most normal operations, you will want to issue a setdeleted(True) command to ensure that you don’t
have to test constantly for the deleted() status of every record.</p>
<p>The DELETED status affects all skip() functions and goto() functions except for those where you goto()
a specific record number.  In that case you will still need to test the deleted() status.</p>
<p>Also, the copytoarray() method adheres to the DELETED status.</p>
<p>If you pass None as the parameter lbHow, then the function returns the current state of the DELETED flag:
True for DELETED is ON, False for DELETED is OFF.  Otherwise, always returns True.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.setorderto">
<code class="sig-name descname">setorderto</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tagname</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.setorderto" title="Permalink to this definition">¶</a></dt>
<dd><p>If the currently selected table has one or more index tags available, this method will set
the current ordering (which is recognized by the various modes of the goto() method) to the
tag specified by tagname. Returns True on success, False on failure for any reason. Inspect
the cErrorMessage or nErrorNumber for reasons.  Pass “” as tagname to set to native recno order.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.setstrictaliasmode">
<code class="sig-name descname">setstrictaliasmode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bMode</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.setstrictaliasmode" title="Permalink to this definition">¶</a></dt>
<dd><p>Obsolete, but here because some old code may make this call</p>
<p>Contact MPSS if you have issues with long alias names and are using older versions of
CodeBaseTools c4DLL.DLL.  The version of the DLL found on the Open Source area in GitHub has
a bug fix that eliminates the necessity of this work around.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.skip">
<code class="sig-name descname">skip</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gonum</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.skip" title="Permalink to this definition">¶</a></dt>
<dd><p>Identical to the goto() method with the “SKIP” gomode value, except it runs a stripped down
function for speed with only very basic error checking and reporting.</p>
<p>Returns True if OK, a valid record has been found, otherwise False.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.tagcount">
<code class="sig-name descname">tagcount</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.tagcount" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of index tags stored in the CDX index file for the
currently selected table. Returns 0 if there aren’t any.</p>
<p>Returns -1 on error, in which case see cErrorMessage and nErrorNumber.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.unlock">
<code class="sig-name descname">unlock</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.unlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Unlocks the current record of the currently selected table.  See rlock() for more information.  Returns True
on success, False on failure.  Also is used to remove the table lock applied by flock().</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.updatestructure">
<code class="sig-name descname">updatestructure</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cSourceTable</span></em>, <em class="sig-param"><span class="n">cTargetTable</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.updatestructure" title="Permalink to this definition">¶</a></dt>
<dd><p>This function examines the field structure and index tags of the source table referenced by cSourceTable
and forces the table named in cTargetTable (not currently open) to have the same structure and index tags.  The
current content of the target table is retained so long as all of its fields are retained.  Data in fields
which are not contained in the cSourceTable table will be lost.
:param cSourceTable: Full path name of the source table, the source of the structure/tags, not currently open.
:param cTargetTable: DBF table to be modified with the structure and index tags of the pattern (source) table.
:return: True on success, False on failure or any error.</p>
<p>NOTE: Do NOT, repeat DO NOT, use this method to modify the structure or indexes of a VFP table contained
in a VFP database container.  If you do, the table may become un-readable!</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.use">
<code class="sig-name descname">use</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tableName</span></em>, <em class="sig-param"><span class="n">alias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">readOnly</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">exclusive</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">noBuffering</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.use" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic method for starting work with a DBF table using the default declaratory mode.  See
the TableObj() method for the alternate object-oriented method and its limitations.</p>
<p>This method must be called before any work with
the table can be performed. After the table is opened with use(), it is the “Currently
Selected Table” and can be accessed by the other methods of this class that operate on the
currently selected table. If you call use() again for another table, that table becomes the
currently selected table. You can change the currently selected table later by calling the
select() method and passing to it the alias name assigned by the original use() method call.
When finished with the table, call <cite>closetable()</cite> and pass the alias name assigned when the table
was opened. The method <cite>closedatabases()</cite> will also close the table (and close all other open
tables too). (Changed the mechanism by which the alias is handled 02/19/2015. JSH.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tableName</strong> – path name to the dbf table you want to open.  Must have the .dbf extension             unless the table you wish to open has some other extension; but .DBF is not             enforced, in other words.  Up to you as to how much info you pass in the             path name, but if the file can’t be found the method reports an error.</p></li>
<li><p><strong>alias</strong> – <p>an optional character string with an alphanumeric string starting with a             letter or underscore which will be used as the alias for subsequent table and field            manipulations.  The presence of this value determines how tables are opened when            multiple tables might be opened with the same base file name but in different            directories.  Two cases:</p>
<dl>
<dt>1 - An alias is specified.</dt><dd><p>If a table with that alias is already open (either this same table or another one in                    a different directory but with the same base name), that table is closed, and then                    this table open happens and the alias you specified is assigned.  Otherwise the                    table is simply opened and this alias name is assigned.</p>
</dd>
<dt>2 - NO alias is specified.</dt><dd><p>A default alias is determined, which is equal to the base table name (other than                    path and extension) of the table with embedded spaces and punctuation removed, if any.                    If this same table is already open with that alias, it is closed and re-opened with your                    required properties.</p>
<p>If a different table is already open with that alias, it is left open, and a new                    unique alias is created as ‘TMP’ followed by a string of 12 random characters.  The                    table specified in this function call is then opened with that new alias.</p>
</dd>
</dl>
<p>If you do NOT specify an alias, the alias name is NOT guaranteed to be the table                base name.  If you will need to manipulate the tables and you don’t specify an alias                name, you MUST store the alias name value provided by the alias() method immediately                after the table is opened, and use that alias name for select() and similar functions                which take an alias name parameter.</p>
<p>The same table is allowed to be opened multiple times, each with its own alias.  Remember                in that case that closing one of the instances will NOT close the other(s).</p>
</p></li>
<li><p><strong>readOnly</strong> – boolean value which defaults to False.  If set to True, then the table is            opened in a mode which prevents any record updates or record appends.            Reads from tables opened readOnly are faster, and readOnly is preferred when            writing is not actually required.</p></li>
<li><p><strong>exclusive</strong> – boolean value which defaults to False.  If set to True, then the table is            opened in exclusive mode.  This means that while the table is open, no other            process may open or access it.  Exclusive mode is required for safely            applying indexes in situations where other processes may attempt access.  When            exclusive is True, the setting for readOnly is ignored and defaults to False.</p></li>
<li><p><strong>noBuffering</strong> – Boolean value defaults to False.  Set to True to force the CodeBase engine            to read/write directly from/to disk without any in-memory buffering of data.            This may be useful for tables with lots of multi-user access.  However you            may still need to call flush() if data corruption issues are encountered.  If            this flag is set True, some performance penalty may be experienced.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True on success, False on any error</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.used">
<code class="sig-name descname">used</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alias</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.used" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass a text string with an alias name.  If that table is open, the function will return True,
otherwise false.</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.xmltocursor">
<code class="sig-name descname">xmltocursor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cAlias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cXML</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cFileName</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.xmltocursor" title="Permalink to this definition">¶</a></dt>
<dd><p>In VFP the XMLTOCURSOR() function is the converse of the CURSORTOXML() function.  It makes possible the loading
of XML created by CURSORTOXML() back into a cursor.  This replicates a portion of the functionality of the
VFP function.  In this case, the xml data will be stored back into a table (appending the records) which
has some or all of the fields specified in the xml data.  It will be up to you to make sure that if the
table has primary keys, which must be set externally to unique values, that those will be handled somehow.
No capability is provided to create a table into which to load the XML (as is provided for in VFP), so you
must first create a table to receive the XML records, and have field names which correspond.</p>
<p>The primary tag name for the XML data is typically &lt;VFPData&gt; but may be something else.  Tag names for
individual records may be any value.  Tag names for fields must match the spelling (but not the case) of fields
in the target table, or the data element will be ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cAlias</strong> – Alias of an open table.  If blank, the currently selected table will be used.</p></li>
<li><p><strong>cXML</strong> – Text string with the XML content to be loaded.  Leave “” if loading from a file.</p></li>
<li><p><strong>cFileName</strong> – File name from which to load the XML.  Leave “” if cXML is passed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of records loaded.  0 indicates an error.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools._cbTools.zap">
<code class="sig-name descname">zap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools._cbTools.zap" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes all records from the currently selected table.  This is more drastic than deleting all records
because the table is actually reconstructed from scratch with no records.  All existing records will be
lost.  USE WITH CARE.  There is NO WARNING MESSAGE.</p>
<p>Use on a table that has not been opened in exclusive mode is extremely risky.</p>
<p>Returns True on success, False on failure.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="CodeBaseTools.TableObj">
<em class="property">class </em><code class="sig-prename descclassname">CodeBaseTools.</code><code class="sig-name descname">TableObj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vfp</span></em>, <em class="sig-param"><span class="n">tablename</span></em>, <em class="sig-param"><span class="n">alias</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">readOnly</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">exclusive</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">reset</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools.TableObj" title="Permalink to this definition">¶</a></dt>
<dd><p>Treat vfp table access as if separate objects for each table.
‘reset’ keyword will close/reopen file to flush file buffer  (still requires full path in tablename)
opens with ‘setdeleted’ True, so deleted records are ignored by default</p>
<p>NOTE: It is recommended that you do NOT instantiate this object yourself in your code.  Instead,
create an instance of cbTools() and then create table objects using the factory method of that class named
TableObj().</p>
<p>For details on how this component works, see the docstring for the TableObj() method in cbTools().</p>
<dl class="py method">
<dt id="CodeBaseTools.TableObj.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools.TableObj.close" title="Permalink to this definition">¶</a></dt>
<dd><p>closes table AND renders instance inert.
does not change current active file</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools.TableObj.newId">
<code class="sig-name descname">newId</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools.TableObj.newId" title="Permalink to this definition">¶</a></dt>
<dd><p>return next unique ID.
does not change current active file
NextKey file should be already opened</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools.TableObj.next">
<code class="sig-name descname">next</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools.TableObj.next" title="Permalink to this definition">¶</a></dt>
<dd><p>next record.
does not change current active file</p>
</dd></dl>

<dl class="py method">
<dt id="CodeBaseTools.TableObj.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeBaseTools.TableObj.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>close and re-open file.
does not change current active file</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="CodeBaseTools.VFPFIELD">
<em class="property">class </em><code class="sig-prename descclassname">CodeBaseTools.</code><code class="sig-name descname">VFPFIELD</code><a class="headerlink" href="#CodeBaseTools.VFPFIELD" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a simple quasi-structure class that contains attributes for all properties required for creating a field
in a CodeBaseTools .DBF table.  When interrogating a .DBF table to retrieve information about its field
structure, CodeBaseTools returns a list of object references to VFPFIELD objects for each field.</p>
<dl class="py attribute">
<dt id="CodeBaseTools.VFPFIELD.cName">
<code class="sig-name descname">cName</code><a class="headerlink" href="#CodeBaseTools.VFPFIELD.cName" title="Permalink to this definition">¶</a></dt>
<dd><p>The text string of the field name.  Typically upper case and a maximum of 10 characters in length        Must start with a letter or underscore and may contain only alphanumeric characters and underscores.</p>
</dd></dl>

<dl class="py attribute">
<dt id="CodeBaseTools.VFPFIELD.cType">
<code class="sig-name descname">cType</code><a class="headerlink" href="#CodeBaseTools.VFPFIELD.cType" title="Permalink to this definition">¶</a></dt>
<dd><p>The CodeBase letter code for the type of field.  See the topic FoxPro and Visual FoxPro Compatibility        and Field Type definitions used for a table of codes and types.</p>
</dd></dl>

<dl class="py attribute">
<dt id="CodeBaseTools.VFPFIELD.nWidth">
<code class="sig-name descname">nWidth</code><a class="headerlink" href="#CodeBaseTools.VFPFIELD.nWidth" title="Permalink to this definition">¶</a></dt>
<dd><p>The width of the field.  This is used for character fields (type ‘C’) and number fields (type ‘N’).        For character fields, this is the fixed width of the field in bytes.  If you’ll be storing Unicode data        which may have multi-byte values, be sure to allow enough room.  For number fields, this specifies the        total number of digits to make room for.  For example if the largest value you expect to store in the field        is 999.99, then you should set the width to 6 to provide room for digits on both sides of the decimal point        AND for the decimal point itself.</p>
</dd></dl>

<dl class="py attribute">
<dt id="CodeBaseTools.VFPFIELD.nDecimals">
<code class="sig-name descname">nDecimals</code><a class="headerlink" href="#CodeBaseTools.VFPFIELD.nDecimals" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for number fields (type ‘N’), this specifies how many digits to the right of the decimal        point to allow for.  May be 0.  Not required for integer type fields.  Where not relevant, defaults        to 0.</p>
</dd></dl>

<dl class="py attribute">
<dt id="CodeBaseTools.VFPFIELD.bNulls">
<code class="sig-name descname">bNulls</code><a class="headerlink" href="#CodeBaseTools.VFPFIELD.bNulls" title="Permalink to this definition">¶</a></dt>
<dd><p>By default, .DBF table fields may not take on a value of NULL (‘None’ in Python code).  NULL in        .DBF terminology is truly “unknown”.  However, if a data field must be able to store a value of NULL,        then set this value to True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="CodeBaseTools.VFPINDEXTAG">
<em class="property">class </em><code class="sig-prename descclassname">CodeBaseTools.</code><code class="sig-name descname">VFPINDEXTAG</code><a class="headerlink" href="#CodeBaseTools.VFPINDEXTAG" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a simple quasi-structure class that contains attributes for all properties required to create an index tag
for a .DBF table in CodeBaseTools.  By default CodeBaseTools follows Visual FoxPro practice and stores all
active index information in a single .CDX file associated with the main .DBF file.  The .CDX file is opened
automatically when the table is opened, and changes to the table are automatically propagated to all the
indexes contained in the .CDX file.</p>
<p>Each index in the .CDX file has a “TAG name” which uniquely identifies it and allows CodeBaseTools functions
to manage and use them.</p>
<dl class="py attribute">
<dt id="CodeBaseTools.VFPINDEXTAG.cTagName">
<code class="sig-name descname">cTagName</code><a class="headerlink" href="#CodeBaseTools.VFPINDEXTAG.cTagName" title="Permalink to this definition">¶</a></dt>
<dd><p>The text string containing the uppercase name of the index tag.  Must be unique for the table        and be no more than 10 characters in length</p>
</dd></dl>

<dl class="py attribute">
<dt id="CodeBaseTools.VFPINDEXTAG.cTagExpr">
<code class="sig-name descname">cTagExpr</code><a class="headerlink" href="#CodeBaseTools.VFPINDEXTAG.cTagExpr" title="Permalink to this definition">¶</a></dt>
<dd><p>The text string containing the expression being used to define the index order.  This may be        an arbitrarily complex expression involving both fields and internal CodeBase (VFP) functions.  See the        indexon() method of the _cbTools class for more details.  Maximum size is 240 bytes.</p>
</dd></dl>

<dl class="py attribute">
<dt id="CodeBaseTools.VFPINDEXTAG.cTagFilt">
<code class="sig-name descname">cTagFilt</code><a class="headerlink" href="#CodeBaseTools.VFPINDEXTAG.cTagFilt" title="Permalink to this definition">¶</a></dt>
<dd><p>A string containing a logical expression which will limit the records which will be considered        by this index tag.  For more details, see the indexon() method of the _cbTools class.</p>
</dd></dl>

<dl class="py attribute">
<dt id="CodeBaseTools.VFPINDEXTAG.nDirection">
<code class="sig-name descname">nDirection</code><a class="headerlink" href="#CodeBaseTools.VFPINDEXTAG.nDirection" title="Permalink to this definition">¶</a></dt>
<dd><p>0 indicates ascending, 1 specifies descending.</p>
</dd></dl>

<dl class="py attribute">
<dt id="CodeBaseTools.VFPINDEXTAG.nUnique">
<code class="sig-name descname">nUnique</code><a class="headerlink" href="#CodeBaseTools.VFPINDEXTAG.nUnique" title="Permalink to this definition">¶</a></dt>
<dd><p>One of several possible values which define handling of cases where the value in the cTagExpr        may appear in multiple records.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-DBFXLStools2"></span><div class="section" id="dbfxlstools2-module-convert-dbf-to-excel-and-excel-to-dbf-tables">
<h2>DBFXLStools2 Module - Convert .DBF to Excel and Excel to .DBF tables<a class="headerlink" href="#dbfxlstools2-module-convert-dbf-to-excel-and-excel-to-dbf-tables" title="Permalink to this headline">¶</a></h2>
<p>The power and convenience of accessing, manipulating and assembling data using CodeBaseTools is combined here
with the convenience and universal acceptance of the .XLSX Excel spreadsheet format for sharing and displaying data.</p>
</div>
<dl class="py class">
<dt id="DBFXLStools2.DbfXlsEngine">
<em class="property">class </em><code class="sig-prename descclassname">DBFXLStools2.</code><code class="sig-name descname">DbfXlsEngine</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">oVFP</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBFXLStools2.DbfXlsEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>DbfXlsEngine provides a suite of methods to copy data from DBF tables to Excel files and the reverse.  It requires
the installation of the ExcelTools module and the CodeBaseTools module.  Note that the ExcelTools module requires
a licensed version of LibXL and the LibXLWrapper.dll.  LibXLWrapper.dll is an open source module that is part
of the ExcelTools distribution, but LibXL is a commercial product requiring a user name and license code to
be stored in a libXLLicenseInfo.txt file.  See the documentation for ExcelTools for more details.</p>
<p>The normal usage for this object is to pass it an object reference to an instance of cbTools() from the
CodeBaseTools module:</p>
<blockquote>
<div><p>oEngine = DbfXlsEngine(cbTools())</p>
</div></blockquote>
<p>But, if no cbTools instance is supplied, one will be created if possible, providing this is invoked via the
“with” mechanism.  See the dtTest() function for an example of this usage.</p>
<dl class="py method">
<dt id="DBFXLStools2.DbfXlsEngine.bizobj2excel">
<code class="sig-name descname">bizobj2excel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">oBiz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cExcelName</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">xHeaderList</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cTitleOne</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cTitleTwo</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">bHiddenNames</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">bNoClose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">cFieldList</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cForExpr</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">cSortOrder</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBFXLStools2.DbfXlsEngine.bizobj2excel" title="Permalink to this definition">¶</a></dt>
<dd><p>NOTE: This method is intended to work with MPSS, Inc., standard business object class wrapper for data
tables (either .DBF or MongoDB).  The MPSS business object class is NOT provided as part of the CodeBaseTools
module.  Contact MPSS, Inc., for more information.</p>
<p>Similar to dbf2excel except that takes as input a fully configured biz object with a table attached.  This
can be a Biz Object for either a DBF or a MongoDB table.  This pulls all the data out with a copytoarray()
call, then stringifies the data for storing into the cells and outputs the specified Excel.  Outputs ONLY
.XLSX files, although that may be slower than .XLS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>oBiz</strong> – Object reference to the MPSS BizObject which will be the source of the records</p></li>
<li><p><strong>cExcelName</strong> – Fully qualified path name for the Excel output file.  Will be forced to ext of .XLSX</p></li>
<li><p><strong>xHeaderList</strong> – List() object with one text string for each column of output</p></li>
<li><p><strong>cTitleOne</strong> – Optional title for first row</p></li>
<li><p><strong>cTitleTwo</strong> – Optional title for second row</p></li>
<li><p><strong>bHiddenNames</strong> – If True, then we’ll output a hidden row with the field names directly after the title row.</p></li>
<li><p><strong>bNoClose</strong> – Ignored</p></li>
<li><p><strong>cFieldList</strong> – Comma separated list of field names that will be output and in the order listed.</p></li>
<li><p><strong>cForExpr</strong> – If not all records are to be output, specify a legal “for” expression here.  This will be            passed to the Biz Object to restrict the list of records in the copytoarray() call</p></li>
<li><p><strong>cSortOrder</strong> – Pass the name of a DBF index TAG or the name of a MongoDB field to control the sort order.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True on Success, otherwise False, and set the error message.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="DBFXLStools2.DbfXlsEngine.dbf2excel">
<code class="sig-name descname">dbf2excel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcDbfName</span></em>, <em class="sig-param"><span class="n">lcExcelName</span></em>, <em class="sig-param"><span class="n">headerlist</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">titleone</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">titletwo</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">rawcopy</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">hiddenNames</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">noclose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fieldList</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBFXLStools2.DbfXlsEngine.dbf2excel" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies the contents of the specific DBF file into the spreadsheet named lcExcelName.
If the spreadsheet already exists, it is overwritten.  Otherwise it is created.  There
will be a header row containing field names and one row following that for each table
record (row).</p>
<p>If headerlist is of type list(), it should contain one text value for each column in the table/sheet.
These text values will replace the field names in the top row. (In that case, the output can’t be used
for import back into dbf via excel2dbf().</p>
<p>If titleone and/or titletwo are non-empty strings, they will be placed in A1 and A2 respectively
in 12 point Bold, and all content will be moved down accordingly.</p>
<p>Data table fields will be properly converted to Excel value types.</p>
<p>Fields such as General will not be converted.  Memo will be included.</p>
<p>If you are confident you know that all fields in the table are convertable to Excel types (for example
that there are no “General” or “Memo-Binary” fields in the table), then you can use the rawcopy option
which does no type or content checking other than the standard conversions from VFP to Excel formats
for dates, etc.  Pass the optional parameter rawcopy=True in that case.</p>
<p>Table ordering is by record.</p>
<p>If hiddenNames == True, then inserts a row directly below the title row (either containing the
field names or the values in headerlist) which will be filled with the field names AND be set to
hidden.</p>
<p>Returns True on success.  False on Failure.</p>
</dd></dl>

<dl class="py method">
<dt id="DBFXLStools2.DbfXlsEngine.excel2dbf">
<code class="sig-name descname">excel2dbf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcExcelName</span></em>, <em class="sig-param"><span class="n">lcDbfName</span></em>, <em class="sig-param"><span class="n">sheetname</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">appendflag</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">templatedbf</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">fieldlist</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">columnsonly</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">showErrors</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBFXLStools2.DbfXlsEngine.excel2dbf" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the contents of the specified Excel file (xls or xlsx) into the target DBF type table.  The existence of the
lcDbfName table and the appendflag value determine the action taken:</p>
<dl class="simple">
<dt>lcDbfName exists, appendflag = False:</dt><dd><ul class="simple">
<li><p>lcDbfName records are removed (zapped), all records are replaced with newly imported records.  Any value in templatedbf
is ingnored.</p></li>
</ul>
</dd>
<dt>lcDbfName exists, appendflag = True:</dt><dd><ul class="simple">
<li><p>Records from the spreadsheet are appended into the table after the existing records.  Any value in templatedbf
is ignored.</p></li>
</ul>
</dd>
<dt>lcDbfName doesn’t exist – appendflag has no meaning:</dt><dd><p>If templatedbf contains the name of a valid DBF table, then uses the structure of that table to create a new table
and imports data into it.
If templatedbf == “” or None, then inspects the contents of the spreadsheet and creates a table the best way it can
from the cell information.</p>
</dd>
</dl>
<p>Takes the data from the first worksheet in the workbook.  You can pass a worksheet name to use instead in the
sheetname optional parameter.  Note that in Excel, worksheet names are case sensitive.</p>
<p>If the templatedbf parameter contains the name of an existing DBF type table, then appendflag is ignored and
a new table is created (overwriting any existing one by that name) using the identical structure of the template
DBF table.</p>
<p>You can supply a list() of field names to include in the output DBF table.  In that case, the fields in the output
table consist of those that are BOTH in the spreadsheet AND in the fieldlist.  If appendflag == True, the fieldlist
will be respected – records will be appended to the lcDbfName table, but only the fields specified will be populated.</p>
<p>The first row of the spreadsheet must contain text values that are valid field names.  No more than 255 are permitted.
Field names may be upper or lower case but MUST start with a letter or underscore.  They may be no longer than 10 characters
and may NOT include blanks.  No two field names may be the same.  Any violation of these rules will result in an error flag
being returned.</p>
<p>Returns the number of records stored or appended.  Returns -1 on error, however if 0 is returned, you likely should investigate
the source of the problem.</p>
<p>NOTE: The CodeBase utilities are fairly slow in creating new DBF tables.  Not sure why.  At least the first one they create
seems to take around 0.45 seconds on a very fast machine.  The second and third are faster, however.  So… for simple things
just let this method write into an existing table, for much better performance.</p>
</dd></dl>

<dl class="py method">
<dt id="DBFXLStools2.DbfXlsEngine.makeBodyDecimalFormat">
<code class="sig-name descname">makeBodyDecimalFormat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DBFXLStools2.DbfXlsEngine.makeBodyDecimalFormat" title="Permalink to this definition">¶</a></dt>
<dd><p>Format creator for the standard body cells containing data in numeric format.  Defaults to 2 decimal places
and the standard thousands separator character.
:return: Format Object</p>
</dd></dl>

<dl class="py method">
<dt id="DBFXLStools2.DbfXlsEngine.makeBodyDecimalFormatXLSX">
<code class="sig-name descname">makeBodyDecimalFormatXLSX</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DBFXLStools2.DbfXlsEngine.makeBodyDecimalFormatXLSX" title="Permalink to this definition">¶</a></dt>
<dd><p>Format creator for the standard body cells containing data in numeric format.  Defaults to 2 decimal places
and the standard thousands separator character.  This version uses font types standard for XLSX files.
:return: Format Object</p>
</dd></dl>

<dl class="py method">
<dt id="DBFXLStools2.DbfXlsEngine.makeBodyFormat">
<code class="sig-name descname">makeBodyFormat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DBFXLStools2.DbfXlsEngine.makeBodyFormat" title="Permalink to this definition">¶</a></dt>
<dd><p>Format creator for the standard body cells containing data displayed in text format (including dates)
:return: Format Object</p>
</dd></dl>

<dl class="py method">
<dt id="DBFXLStools2.DbfXlsEngine.makeBodyFormatXLSX">
<code class="sig-name descname">makeBodyFormatXLSX</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DBFXLStools2.DbfXlsEngine.makeBodyFormatXLSX" title="Permalink to this definition">¶</a></dt>
<dd><p>Format creator for the standard body cells containing data displayed in text format (including dates).
This version uses font types standard for XLSX files.
:return: Format Object</p>
</dd></dl>

<dl class="py method">
<dt id="DBFXLStools2.DbfXlsEngine.makeBodyHiddenFormat">
<code class="sig-name descname">makeBodyHiddenFormat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DBFXLStools2.DbfXlsEngine.makeBodyHiddenFormat" title="Permalink to this definition">¶</a></dt>
<dd><p>Format creator for the cells in a hidden row.  The hidden row option allows the raw DBF field names to
be included in the XLS file without actually displaying them – the column headings can then display
human readable names.
:return: Format Object</p>
</dd></dl>

<dl class="py method">
<dt id="DBFXLStools2.DbfXlsEngine.makeHeaderFormat">
<code class="sig-name descname">makeHeaderFormat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DBFXLStools2.DbfXlsEngine.makeHeaderFormat" title="Permalink to this definition">¶</a></dt>
<dd><p>Format creator for the column header cells containing the field names.
:return: Format Object</p>
</dd></dl>

<dl class="py method">
<dt id="DBFXLStools2.DbfXlsEngine.makeHeaderFormatXLSX">
<code class="sig-name descname">makeHeaderFormatXLSX</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DBFXLStools2.DbfXlsEngine.makeHeaderFormatXLSX" title="Permalink to this definition">¶</a></dt>
<dd><p>Format creator for the column header cells containing the field names.  Uses default fonts from
XLSX type files.
:return: Format Object</p>
</dd></dl>

<dl class="py method">
<dt id="DBFXLStools2.DbfXlsEngine.makeTitleFormat">
<code class="sig-name descname">makeTitleFormat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DBFXLStools2.DbfXlsEngine.makeTitleFormat" title="Permalink to this definition">¶</a></dt>
<dd><p>Format creator for the top-of-the-page title if one is to be displayed.
:return: Format Object</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-ExcelTools"></span><div class="section" id="exceltools-module-high-performance-access-to-xls-and-xlsx-spreadsheets">
<h2>ExcelTools Module - High Performance Access to XLS and XLSX Spreadsheets<a class="headerlink" href="#exceltools-module-high-performance-access-to-xls-and-xlsx-spreadsheets" title="Permalink to this headline">¶</a></h2>
<p>This Module, ExcelTools.py, provides a Python wrapper around the MPSS, Inc., developed LibXLWrapper.DLL, which in turn
is a wrapper around the LIBXL.DLL ‘C’ Library from XLWare at www.LibXL.com.  LIBXL is a powerful alternative to using
MS Excel and controlling it with COM.  COM provides full access to all Excel features but at a significant cost in
time and licensing.</p>
<p>LIBXL is a commercial product, but has no run-time distribution fees and is considerably faster for common tasks
than Excel 2007 and higher.  It is available for non-Microsoft OS platforms as well.</p>
<p>Unfortunately for programming convenience LIBXL is highly granular and structured around the internal constructs of
the Excel file model.  These wrappers are designed to simplify the access and to allow Python modules to access it
without explicit use of ctypes – although ctypes is the foundation on which this is built.</p>
<p>A copy of the LIBXL product, libxl.dll is included here.  It is a recent version of the freely downloadable module
found at <a class="reference external" href="https://www.libxl.com/">https://www.libxl.com/</a>
This will allow you to run the application, however, without a license key the capability is dramatically reduced.</p>
<p>Once you have a license key, you’ll need to edit the file LibXLLicenseInfo.TXT which is part of this package to
replace the dummy information with your actual licensed user name and license key.  That is where this module
finds the license information which it hands to the libxl.dll module.</p>
<p>Why use this wrapper:
1 - First, the job of setting up ctypes for a large subset of the libxl functions is already done for you.  This has
been done in a way that is x-version compatible between Py 2.x and Py 3.x.
2 - As with many ‘c’ DLL modules libxl.dll is very granular, and a large number of function calls may be required
to accomplish simple things.  To simplify things, and to make sure that ctypes requirements are fully met, a .DLL
wrapper called LibXLWrapper.dll has been developed to cushion the complexities.  The source for LibXLWrapper.c is
found on GitHub in the CodeBaseTools repository and is free for download.</p>
<p>The work is performed by the object class xlWrap which uses ctypes to access the higher level methods in
LibXLWrapper.dll.  The methods in this module are documented fully in the docstrings
contained in it.  Also the test function at the bottom provides many examples of how to call the methods.</p>
<dl class="simple">
<dt>General Concepts:</dt><dd><ul class="simple">
<li><p>This module only allows one XLS or XLSX to be worked on at one time.  If you need to access multiple spreadsheets
simultaneously, you’ll need to access LIBXL directly as it can handle multiple instances.  HOWEVER, it does
allow you to import worksheets from one spreadsheet to another, so this may not be a significan issue for you.</p></li>
<li><p>Spreadsheet contents is accessed by addressing the individual worksheets within the workbook.  Every workbook has at
minimum one worksheet.  Worksheets are referenced by an integer index.  There is a method that returns the index
if you pass the worksheet name.</p></li>
<li><p>Cells are accessed within a worksheet by referencing their row and column (0 based) offsets.</p></li>
<li><p>Each cell has three components which can be managed separately: Value, Format (including Font), and Formula.</p></li>
<li><p>Each cell has three components which can be managed separately: Value, Format (including Font), and Formula.</p></li>
<li><p>Formats are applied by first defining the format and adding it to the workbook and saving the format index
value returned.  Then formats can be applied to individual cells and/or rows by referring to the worksheet,
the rows and columns and the format index value.</p></li>
<li><p>The complexities of libxl.dll format management have been wrapped into the XLFORMAT object.  You create
instances of this object to control cell formats.  Note that many common formats have already been defined
to simplify basic output, but you can customize formats and make them arbitrarily complex.</p></li>
<li><p>Either XLS or XLSX formats can be read and written, but this module doesn’t allow for conversions since
it doesn’t permit two or more workbooks to be open at the same time.  You could, however read the contents
of one workbook (returned as plain ASCII character strings) save them, then close the first workbook and open
the target workbook.  Note that the internal representation of the data (and some of the format defaults)
are dependent on XLS versus XLSX, and the file name extension determines how the data is stored internally.</p></li>
</ul>
</dd>
</dl>
<p>2012 Jan 13 - Corrected documentation for GetRowValues(). JSH.
2012 May 30 JMc more accurate location method to find .dll
2013 Jan 04 JSH added ascii value protection with encoding to writecell() and writerow().
2018 Sep 28 JSH added xlwSetLicense function to store license for LibXL externally.
2018 Sep 29 JSH Implemented cross version features for Python 2.x and 3.x
2020 June 23 JSH Removed all dependencies on MPSS modules.  Now part of the CodeBaseTools services.</p>
</div>
<dl class="py class">
<dt id="ExcelTools.xlWrap">
<em class="property">class </em><code class="sig-prename descclassname">ExcelTools.</code><code class="sig-name descname">xlWrap</code><a class="headerlink" href="#ExcelTools.xlWrap" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="ExcelTools.xlWrap.AddFormat">
<code class="sig-name descname">AddFormat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lxFmat</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.AddFormat" title="Permalink to this definition">¶</a></dt>
<dd><p>You define a format by creating an instance of the Format structure like:
someFormat = XLFORMAT()
Then set the properties (members) of the structure that you need to define for one or more cells.
This method returns a Format index value that you’ll use to refer to this Format.  If it returns
-1, something went wrong.</p>
<p>The first format you define with AddFormat is saved and becomes the Default Format.  This Format
is automatically applied to any cells filled with WriteCellValue() or WriteRowValues() after it has
been defined.  Defining a Default Format for the workbook prior to extensive writing can save
considerable processing time when there are large numbers of identically formatted body cells
to be loaded – in comparison to writing the cell contents and adding the formatting in a second pass.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.AddSheet">
<code class="sig-name descname">AddSheet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcSheetName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.AddSheet" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new worksheet at the end of the set of worksheets.  The name lcSheetName is required.</p>
<p>Returns the worksheet index value of the sheet you added.  This index will be required for all
manipulation of that sheet.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.CloseWorkbook">
<code class="sig-name descname">CloseWorkbook</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lbSave</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.CloseWorkbook" title="Permalink to this definition">¶</a></dt>
<dd><p>Terminates work with the currently active spreadsheet.  If the spreadsheet has been changed during processing
and you pass 1 for lbSave, then the workbook will be saved prior to the shutdown.  Once this method
has executed, you can open or create another workbook (spreadsheet).</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.CreateWorkbook">
<code class="sig-name descname">CreateWorkbook</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcFileName</span></em>, <em class="sig-param"><span class="n">lcFirstSheetName</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">bNoSheet</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.CreateWorkbook" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a new spreadsheet – creating a new, empty one in memory.  The lcFileName parameter MUST
be passed.  It must have an extension of XLS or XLSX, which tells the module what version of Excel to
use.</p>
<p>A Worksheet is immediately added to the workbook.  This worksheet will have the name as given in the
second parameter lcFirstSheetName.  If you don’t supply lcFirstSheetName, the sheet will be named
“Sheet1”.  Returns the sheet index value for that newly created sheet.</p>
<p>01/19/2013 - Added bNoSheet parm.  If you set this to True, then no initial sheet will be added
to the workbook, so you will need to start off by creating sheets with the AddSheet() or the
ImportSheetFrom() methods.  Trying to save the Workbook without adding sheets will likely trigger
an error.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.DeleteCols">
<code class="sig-name descname">DeleteCols</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnFromCol</span></em>, <em class="sig-param"><span class="n">lnToCol</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.DeleteCols" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the specified columns from the specified worksheet.  Specify the from col and the to col (0-based
column counts).  Returns 1 on success, 0 on failure.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.DeleteRows">
<code class="sig-name descname">DeleteRows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnFromRow</span></em>, <em class="sig-param"><span class="n">lnToRow</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.DeleteRows" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the rows from the lnFromRow row to the lnToRow row.  Row numbers are 0-based.  Returns 1 on
success, 0 on failure.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.FormatCells">
<code class="sig-name descname">FormatCells</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnFromRow</span></em>, <em class="sig-param"><span class="n">lnToRow</span></em>, <em class="sig-param"><span class="n">lnFromCol</span></em>, <em class="sig-param"><span class="n">lnToCol</span></em>, <em class="sig-param"><span class="n">lnFmatIndex</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.FormatCells" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows you to apply a previously defined Format to a rectangular collection of cells.  Returns 1
on success, 0 on failure.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.GetCellValue">
<code class="sig-name descname">GetCellValue</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnRow</span></em>, <em class="sig-param"><span class="n">lnCol</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.GetCellValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass this method a sheet index number and a row/column pair.  It will return the cell value as a tuple:
The first element of the tuple will be a string representation of the value.  The second element of
the tuple will be a string value indicating the type of the cell value.  Cell value types are:
- “S” - character string
- “N” - number (always a double)
- “D” - date (including date, datetime, and time)
- “L” - boolean or logical
- “B” - Blank
- “E” - Empty
- “X” - Error
Date values are returned in the form YYYYMMDDHHMMSSnnn where the year is YYYY, month MM, day DD, hour HH,
minute MM, seconds SS, and milliseconds nnn.  Time values will have all 0 (zeros) in the date portion of the
string.  Date values will have all 0 (zeros) in the time portion of the string.</p>
<p>Boolean values are returned as “TRUE” or “FALSE”.</p>
<p>Returns None if there is no current spreadsheet.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.GetErrorMessage">
<code class="sig-name descname">GetErrorMessage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.GetErrorMessage" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the text string explaining the most recent error condition.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.GetErrorNumber">
<code class="sig-name descname">GetErrorNumber</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.GetErrorNumber" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the last error number.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.GetRowValues">
<code class="sig-name descname">GetRowValues</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnRow</span></em>, <em class="sig-param"><span class="n">lnColFrom</span></em>, <em class="sig-param"><span class="n">lnColTo</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.GetRowValues" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the values from a portion of a row from lnColFrom to lnColTo.  Exactly like GetCellValue()
except that the tuple contains a TAB-delimited string of values and a value type string
with one character per cell indicating the type found in the cell.</p>
<p>On error returns an empty string as the first element of the tuple.
CORRECTION: On error returns None as the first element of the tuple. Jan 13, 2012. JSH.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.GetSheetFromName">
<code class="sig-name descname">GetSheetFromName</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.GetSheetFromName" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the worksheet index value for the worksheet with the name passed to the function.  Returns
-1 on error (no such sheet or no active workbook).</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.GetSheetStats">
<code class="sig-name descname">GetSheetStats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.GetSheetStats" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple with 5 pieces of information about the worksheet specified in the lnSheet parameter:
- Sheet Name
- Topmost row with contents
- Bottommost row with contents
- Leftmost column with contents
- Rightmost column with contents</p>
<p>Returns an empty string for the Sheet Name if the Sheet Index is invalid or if there is no active workbook.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.GroupCols">
<code class="sig-name descname">GroupCols</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nSheet</span></em>, <em class="sig-param"><span class="n">nFromCol</span></em>, <em class="sig-param"><span class="n">nToCol</span></em>, <em class="sig-param"><span class="n">bCollapse</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.GroupCols" title="Permalink to this definition">¶</a></dt>
<dd><p>Like Group Rows, but does it for Columns.  Once set, there is an expand/collapse button at the top of the
spreadsheet for this Group.  Pass bCollapse as True to collapse the group prior to opening it.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.GroupRows">
<code class="sig-name descname">GroupRows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nSheet</span></em>, <em class="sig-param"><span class="n">nFromRow</span></em>, <em class="sig-param"><span class="n">nToRow</span></em>, <em class="sig-param"><span class="n">bCollapse</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.GroupRows" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets up a group of rows to allow them to be opened and closed above or below a summary row.  Pass
bCollapse as True to ensure that the Grouped rows are collapsed when the sheet is opened.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.ImportSheetFrom">
<code class="sig-name descname">ImportSheetFrom</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cFile</span></em>, <em class="sig-param"><span class="n">cSheet</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.ImportSheetFrom" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a copy of the sheet cSheet in XLS/XLSX file cFile as the next sheet in the current worksheet.
You can create a workbook without sheets using CreateWorkbook() and specifying bNoSheet=True.
Added 01/19/2013. JSH.
Returns the index of the new sheet or -1 on failure.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.InsertCols">
<code class="sig-name descname">InsertCols</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnFromCol</span></em>, <em class="sig-param"><span class="n">lnToCol</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.InsertCols" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts columns into the specified worksheet.  Indicate the starting column (0 based count) where the
insertion begins and the last column to the right of that.  Returns 1 on success, 0 on failure.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.InsertRows">
<code class="sig-name descname">InsertRows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnFromRow</span></em>, <em class="sig-param"><span class="n">lnToRow</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.InsertRows" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts rows into the specified worksheet.  Indicate the starting row where the insertion begins and
the last row to be inserted below that.  Returns 1 on success, 0 on failure.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.IsColHidden">
<code class="sig-name descname">IsColHidden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnCol</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.IsColHidden" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests to see if the specified column in the specified sheet is hidden.
Returns True if hidden, False otherwise.  Note that a False may also be returned
if an error was encountered.  If you get False and were expecting True, then
call the GetErrorMessage() method or GetErrorNumber() method to see if an
error was reported.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.IsRowHidden">
<code class="sig-name descname">IsRowHidden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnRow</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.IsRowHidden" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests to see if the specified row in the specified sheet is hidden.
Returns True if hidden, False otherwise.  Note that a False may also be returned
if an error was encountered.  If you get False and were expecting True, then
call the GetErrorMessage() method or GetErrorNumber() method to see if an
error was reported.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.MergeCells">
<code class="sig-name descname">MergeCells</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnFromRow</span></em>, <em class="sig-param"><span class="n">lnToRow</span></em>, <em class="sig-param"><span class="n">lnFromCol</span></em>, <em class="sig-param"><span class="n">lnToCol</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.MergeCells" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the Excel ‘Cell Merge’ feature to the specified cells.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.OpenWorkbook">
<code class="sig-name descname">OpenWorkbook</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcFileName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.OpenWorkbook" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a new spreadsheet, starting with an existing spreadsheet file on the disk.  The worksheet
is immediately read into memory and information is captured on the number of worksheets it contains.
This number is the return value.  If the return value is &lt; 1, something is wrong.</p>
<p>The Excel version assumed is determined by the file name extension: XLS or XLSX.</p>
<p>You can access the existing worksheets by using sheet index values from 0 (the first sheet) to
one less than the number of worksheets returned by this method.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.ReadRowValues">
<code class="sig-name descname">ReadRowValues</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnRow</span></em>, <em class="sig-param"><span class="n">lnColFrom</span></em>, <em class="sig-param"><span class="n">lnColTo</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.ReadRowValues" title="Permalink to this definition">¶</a></dt>
<dd><p>Like GetRowValues except returns a simple list of values (or None on error) containing
the values of each cell specified in native Python format.  Not for use in high performance situations.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.SetCellColor">
<code class="sig-name descname">SetCellColor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnFromRow</span></em>, <em class="sig-param"><span class="n">lnToRow</span></em>, <em class="sig-param"><span class="n">lnFromCol</span></em>, <em class="sig-param"><span class="n">lnToCol</span></em>, <em class="sig-param"><span class="n">lnColor</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.SetCellColor" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the specified cell background color to the indicated range of cells.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.SetCellDelimiter">
<code class="sig-name descname">SetCellDelimiter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lcDelim</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.SetCellDelimiter" title="Permalink to this definition">¶</a></dt>
<dd><p>Overrides the default value of the delimiter used to separate cell values both in the get and the
write of multiple cells.  Should be a string value of up to 10 characters unlikely to be found in
any text string cell value.  The default value, if this is not called is tab: ‘ ‘.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.SetColGroupRight">
<code class="sig-name descname">SetColGroupRight</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nSheet</span></em>, <em class="sig-param"><span class="n">bRight</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.SetColGroupRight" title="Permalink to this definition">¶</a></dt>
<dd><p>When Cols are Grouped, typically the extra “Summary” column is assumed to be the one immediately to the right
of the specified group of Columns.  Call this function with bRight = True to ensure that.  Call it with False
to force the “Summary” column to be the one immediately to the left of the Group of Rows.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.SetColHidden">
<code class="sig-name descname">SetColHidden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnCol</span></em>, <em class="sig-param"><span class="n">lbHide</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.SetColHidden" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the specified column in the specified sheet to hidden or NOT hidden,
based on the True/False status of lbHide.  Returns 1 on success, 0 on failure.
If 0 is returned, call GetErrorMessage() or GetErrorNumber() to determine the
reason for the problem.  Does not report an error if the specified column’s
hidden status is already set to the value of lbHide.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.SetColWidths">
<code class="sig-name descname">SetColWidths</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnFromCol</span></em>, <em class="sig-param"><span class="n">lnToCol</span></em>, <em class="sig-param"><span class="n">ldWidth</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.SetColWidths" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the width (in Excel column width units passed as a double) of one or more adjacent columns.
Returns 1 on success, 0 on failure.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.SetColorByName">
<code class="sig-name descname">SetColorByName</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnFromRow</span></em>, <em class="sig-param"><span class="n">lnToRow</span></em>, <em class="sig-param"><span class="n">lnFromCol</span></em>, <em class="sig-param"><span class="n">lnToCol</span></em>, <em class="sig-param"><span class="n">lcColor</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.SetColorByName" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass the name in the xlColor dict() rather than the number.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.SetPageMargins">
<code class="sig-name descname">SetPageMargins</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lcWhich</span></em>, <em class="sig-param"><span class="n">lnWidth</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.SetPageMargins" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the printed output page margins for the specified worksheet.  The values to pass in lcWhich
are TOP, BOTTOM, LEFT, RIGHT, or ALL.  Width of the margins is affected based on that selection and should
be specified in inches as a decimal fraction.  Returns 1 if the lnSheet value is recognized as a valid
work sheet index, otherwise returns 0.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.SetPaperSize">
<code class="sig-name descname">SetPaperSize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lpcType</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.SetPaperSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the paper size for any printed output.  This overrides the printer setting based on Excel
typical operation.  The lpcType value may be one of three text values: LETTER, LEGAL, and A3.  If the text
string is unrecognized, the default will be set to LETTER.  Returns 1 if the lnSheet value is recognized as a
valid work sheet index, otherwise returns 0.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.SetPrintArea">
<code class="sig-name descname">SetPrintArea</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnFromRow</span></em>, <em class="sig-param"><span class="n">lnToRow</span></em>, <em class="sig-param"><span class="n">lnFromCol</span></em>, <em class="sig-param"><span class="n">lnToCol</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.SetPrintArea" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the Excel “print area” or portion of the worksheet that is “printable”.  Returns 1 if the lnSheet
value is recognized as a valid work sheet index, otherwise returns 0. Note that row and column counters
are 0 (zero) based.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.SetPrintAspect">
<code class="sig-name descname">SetPrintAspect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lpcHow</span><span class="o">=</span><span class="default_value">'PORTRAIT'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.SetPrintAspect" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the output printing format to either “PORTRAIT” or “LANDSCAPE”.  Pass the string as the second
parameter.  If unrecognized value is passed, defaults to PORTRAIT.  Returns 1 if the lnSheet value is
recognized as a valid work sheet index, otherwise returns 0.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.SetPrintPageCountFit">
<code class="sig-name descname">SetPrintPageCountFit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnPageWidth</span></em>, <em class="sig-param"><span class="n">lnPageHeight</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.SetPrintPageCountFit" title="Permalink to this definition">¶</a></dt>
<dd><p>In the Excel print preview it is possible to specify that the print area to be output must fit in a
specified number of pages wide and pages high.  This function provides that functionality.  Specify the
work sheet index number and the number of pages of width for the output followed by the pages of height.
The governing dimension is the width, typically set a one page (a value of 1 in the lnPageWidth
parameter.  Height may be set to any non-zero value, but may be set to a value greater than the likely
actual output height in pages so as to avoid unnecessary compression.  Again, note these values are set
in numbers of pages.  Returns 1 if the lnSheet value is recognized as a valid work sheet index, otherwise
returns 0.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.SetRowFormats">
<code class="sig-name descname">SetRowFormats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnFromRow</span></em>, <em class="sig-param"><span class="n">lnToRow</span></em>, <em class="sig-param"><span class="n">lnFmatIndex</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.SetRowFormats" title="Permalink to this definition">¶</a></dt>
<dd><p>An alternative way to apply formats to all cells in one or more rows.  You’ll need to test to see if the
format characteristics you need are allowed to be set at the Row level.  If not, no error is raised.
Returns 1 on success, 0 on failure.  Failure could be caused by not having any open spreadsheet workbooks.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.SetRowGroupBottom">
<code class="sig-name descname">SetRowGroupBottom</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nSheet</span></em>, <em class="sig-param"><span class="n">bBottom</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.SetRowGroupBottom" title="Permalink to this definition">¶</a></dt>
<dd><p>When Rows are Grouped, typically the extra “Summary” row is assumed to be the one directly below the range
of grouped rows.  Call this function with bBottom = True to ensure that.  Call it with False to force
the “Summary” row to be the one immediately above the defined Group of Rows.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.SetRowHeight">
<code class="sig-name descname">SetRowHeight</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnRow</span></em>, <em class="sig-param"><span class="n">ldHeight</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.SetRowHeight" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the height of one row in pixels.  Returns 1 on success, 0 on failure.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.SetRowHidden">
<code class="sig-name descname">SetRowHidden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnRow</span></em>, <em class="sig-param"><span class="n">lbHide</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.SetRowHidden" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the specified row in the specified sheet to hidden or NOT hidden,
based on the True/False status of lbHide.  Returns 1 on success, 0 on failure.
If 0 is returned, call GetErrorMessage() or GetErrorNumber() to determine the
reason for the problem.  Does not report an error if the specified row’s
hidden status is already set to the value of lbHide.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.SplitSheet">
<code class="sig-name descname">SplitSheet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnRow</span></em>, <em class="sig-param"><span class="n">lnCol</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.SplitSheet" title="Permalink to this definition">¶</a></dt>
<dd><p>The LibXL docs aren’t very clear on what “Split” does, but it actually locks header rows and or left side
label columns into position while the body scrolls.  In Excel-speak, this is “Freeze Panes”, not “Split”, which
is something different.  To lock in place the first 4 rows, pass lnRow as 4 (the 5th physical row) and
lnCol as 0.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.TransformExcelValue">
<code class="sig-name descname">TransformExcelValue</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lpxVal</span></em>, <em class="sig-param"><span class="n">lpcType</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.TransformExcelValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the raw value from a cell plus the type lpcType and returns the native Python value which
these represent. Allowed lpcType values:</p>
<blockquote>
<div><ul class="simple">
<li><p>“S” = character string - returns a string</p></li>
<li><p>“N” = number (always a double) - returns a double</p></li>
<li><p>“D” = date (including date, datetime, and time) - returns a datetime.            If the date value in Excel is empty or invalid, (year 0), returns None.</p></li>
<li><p>“L” = boolean or logical - returns a logical</p></li>
<li><p>“B” = Blank returns “”</p></li>
<li><p>“E” = Empty returns “”</p></li>
<li><p>“X” = Error returns “ERROR”</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.WriteCellValue">
<code class="sig-name descname">WriteCellValue</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnRow</span></em>, <em class="sig-param"><span class="n">lnCol</span></em>, <em class="sig-param"><span class="n">lcStrValue</span></em>, <em class="sig-param"><span class="n">lcCellType</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.WriteCellValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Places a value or a formula into a specified cell.  There are five required parameters:
- Worksheet index
- Row number (0 based)
- Column number (0 based)
- Value represented as a text string.  See GetCellValue() for formatting date and logical values.
- Desired cell type: “S”, “N”, “D”, “L”, “B”, or “F”.</p>
<p>In the case of cell type “B” pass an empty string as the value (blank).</p>
<p>In the case of “F” the string should contain a formula in the “letter number” type notation of cell
reference.  In other words you might pass “=A1+B1” as the formula.</p>
<p>Returns 1 on success, 0 on failure.
Changed handling of unicode conversions to ascii for greater reliability.  Also added code to convert
right and left quote signs to simple ascii quotes. jsh. 03/07/2013.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.WriteRowValues">
<code class="sig-name descname">WriteRowValues</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lnSheet</span></em>, <em class="sig-param"><span class="n">lnRow</span></em>, <em class="sig-param"><span class="n">lnColFrom</span></em>, <em class="sig-param"><span class="n">lnColTo</span></em>, <em class="sig-param"><span class="n">lcStrValues</span></em>, <em class="sig-param"><span class="n">lcCellTypes</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.WriteRowValues" title="Permalink to this definition">¶</a></dt>
<dd><p>Exactly like WriteCellValue() except that the lcStrValues parameter must be a TAB
delimited string containing one value for each cell you specify to be filled.  The
parameter lcCellTypes is a string with one character for each cell to be filled, containing
the corresponding data type to be stored.  See WriteCellValue() for valid types.
Changed handling of unicode conversions to ascii for greater reliability. JSH. 03/07/2013.</p>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.makeStringPointer">
<code class="sig-name descname">makeStringPointer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cText</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.makeStringPointer" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides conversion from unicode string to byte string if this is running under Python 3.x.  This is
required because we cannot pass Python 3.x strings to the C DLL functions.  They first must be converted
to a string of simple bytes.  This function uses an encoding of “cp1252” to make the conversion in Py 3.x,
as that is the Windows standard for Western European languages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cText</strong> – The unicode string to prepare to pass to the DLL.  The assumption will be that            the string can be converted to CodePage 1252 from Unicode.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pointer for use by the DLL</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ExcelTools.xlWrap.procStringResult">
<code class="sig-name descname">procStringResult</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cBytes</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ExcelTools.xlWrap.procStringResult" title="Permalink to this definition">¶</a></dt>
<dd><p>When the DLL returns a string it is in the form of a sequence of bytes.  Python 2.x is OK with that
but Python 3.x wants it converted to a representation of text, not bytes.  This function does
nothing at all but pass through the value for Python 2.x, but for Python 3.x, it tries a series of
decode steps with “strict” turned on.  For each failure it tries another decoding until in desperation
it creates the string as ASCII with the “replace” feature turned on.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cBytes</strong> – The bytes returned by the DLL which are to be converted to an appropriate string format.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A Python string with the appropriate encoding.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="ExcelTools.XLFORMAT">
<em class="property">class </em><code class="sig-prename descclassname">ExcelTools.</code><code class="sig-name descname">XLFORMAT</code><a class="headerlink" href="#ExcelTools.XLFORMAT" title="Permalink to this definition">¶</a></dt>
<dd><p>A Data structure using the ctypes Structure construct.  This allows a single function call to pass all format
information for one or more cells rather than a separate one for each characteristic.  The default values of -1
or “” are ignored when xlWrap sets cell formats.  Only members with other values are considered in format setting,
so need only set the member properties that you need.</p>
</dd></dl>

<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright M-P Systems Services, Inc..

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>